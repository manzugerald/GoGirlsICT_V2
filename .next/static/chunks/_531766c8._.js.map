{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/downloadColumnsModal.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { DndContext, closestCenter, PointerSensor, useSensor, useSensors } from '@dnd-kit/core';\r\nimport {\r\n  SortableContext,\r\n  useSortable,\r\n  verticalListSortingStrategy,\r\n  arrayMove,\r\n} from '@dnd-kit/sortable';\r\nimport { CSS } from '@dnd-kit/utilities';\r\n\r\nexport interface ColumnOption {\r\n  id: string;\r\n  label: string;\r\n}\r\n\r\ninterface DownloadColumnsModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  columns: ColumnOption[];\r\n  onDownload: (selectedColumns: ColumnOption[]) => void;\r\n  defaultSelected?: string[];\r\n}\r\n\r\nexport default function DownloadColumnsModal({\r\n  isOpen,\r\n  onClose,\r\n  columns,\r\n  onDownload,\r\n  defaultSelected = [],\r\n}: DownloadColumnsModalProps) {\r\n  const [available, setAvailable] = useState<ColumnOption[]>([]);\r\n  const [selected, setSelected] = useState<ColumnOption[]>([]);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      setAvailable(columns.filter((c) => !defaultSelected.includes(c.id)));\r\n      setSelected(columns.filter((c) => defaultSelected.includes(c.id)));\r\n    }\r\n  }, [isOpen]); // Only reset when modal opens\r\n\r\n  const sensors = useSensors(\r\n    useSensor(PointerSensor, {\r\n      activationConstraint: { distance: 5 },\r\n    })\r\n  );\r\n\r\n  function handleDragEnd(event: any) {\r\n    const { active, over } = event;\r\n\r\n    // Reordering in selected\r\n    if (\r\n      active &&\r\n      over &&\r\n      selected.find((c) => c.id === active.id) &&\r\n      selected.find((c) => c.id === over.id) &&\r\n      active.id !== over.id\r\n    ) {\r\n      setSelected((items) => {\r\n        const oldIndex = items.findIndex((i) => i.id === active.id);\r\n        const newIndex = items.findIndex((i) => i.id === over.id);\r\n        return arrayMove(items, oldIndex, newIndex);\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Drag from available to selected area\r\n    if (\r\n      active &&\r\n      over &&\r\n      available.find((c) => c.id === active.id) &&\r\n      over.id === 'selected-drop-area'\r\n    ) {\r\n      const col = available.find((c) => c.id === active.id)!;\r\n      setAvailable((prev) => prev.filter((c) => c.id !== col.id));\r\n      setSelected((prev) => [...prev, col]);\r\n    }\r\n  }\r\n\r\n  function handleAdd(col: ColumnOption) {\r\n    setAvailable((prev) => prev.filter((c) => c.id !== col.id));\r\n    setSelected((prev) => [...prev, col]);\r\n  }\r\n\r\n  function handleRemove(col: ColumnOption) {\r\n    setSelected((prev) => prev.filter((c) => c.id !== col.id));\r\n    setAvailable((prev) => [...prev, col]);\r\n  }\r\n\r\n  // PDF Export Helper: handles serial number and date formatting\r\n  function handleDownload() {\r\n    onDownload(selected);\r\n    onClose();\r\n  }\r\n\r\n  return (\r\n    <Dialog\r\n      open={isOpen}\r\n      onClose={onClose}\r\n      className=\"fixed inset-0 z-50 flex items-center justify-center\"\r\n    >\r\n      <div className=\"fixed inset-0 bg-black/30 dark:bg-black/70\" aria-hidden=\"true\" />\r\n      <div className=\"relative bg-white dark:bg-gray-900 rounded-lg shadow-lg w-full max-w-2xl mx-auto p-6 z-10\">\r\n        <Dialog.Title className=\"text-lg font-bold mb-2 dark:text-white\">\r\n          Select & Order Columns\r\n        </Dialog.Title>\r\n        <div className=\"flex gap-6\">\r\n          {/* Available Columns */}\r\n          <div className=\"w-1/2\">\r\n            <div className=\"font-semibold mb-2 dark:text-gray-200\">All Columns</div>\r\n            <DndContext\r\n              sensors={sensors}\r\n              collisionDetection={closestCenter}\r\n              onDragEnd={handleDragEnd}\r\n            >\r\n              <ul className=\"border rounded p-2 min-h-[200px] bg-gray-50 dark:bg-gray-800\">\r\n                {available.map((col) => (\r\n                  <DraggableColumnItem\r\n                    key={col.id}\r\n                    id={col.id}\r\n                    label={col.label}\r\n                    onAdd={() => handleAdd(col)}\r\n                  />\r\n                ))}\r\n                {available.length === 0 && (\r\n                  <li className=\"text-gray-400 dark:text-gray-500 text-sm\">All columns selected</li>\r\n                )}\r\n              </ul>\r\n            </DndContext>\r\n          </div>\r\n          {/* Selected Columns (drag to reorder, droppable area) */}\r\n          <div className=\"w-1/2\">\r\n            <div className=\"font-semibold mb-2 dark:text-gray-200\">\r\n              To Download (drag to reorder)\r\n            </div>\r\n            <DndContext\r\n              sensors={sensors}\r\n              collisionDetection={closestCenter}\r\n              onDragEnd={handleDragEnd}\r\n            >\r\n              <SortableContext\r\n                items={selected.map((c) => c.id)}\r\n                strategy={verticalListSortingStrategy}\r\n              >\r\n                <ul\r\n                  id=\"selected-drop-area\"\r\n                  className=\"border rounded p-2 min-h-[200px] bg-gray-50 dark:bg-gray-800\"\r\n                >\r\n                  {selected.map((col) => (\r\n                    <SortableColumnItem\r\n                      key={col.id}\r\n                      id={col.id}\r\n                      label={col.label}\r\n                      onRemove={() => handleRemove(col)}\r\n                    />\r\n                  ))}\r\n                  {selected.length === 0 && (\r\n                    <li className=\"text-gray-400 dark:text-gray-500 text-sm\">\r\n                      No columns selected\r\n                    </li>\r\n                  )}\r\n                </ul>\r\n              </SortableContext>\r\n            </DndContext>\r\n          </div>\r\n        </div>\r\n        <div className=\"flex justify-end mt-6 gap-2\">\r\n          <button\r\n            className=\"px-4 py-2 bg-gray-200 dark:bg-gray-700 dark:text-gray-100 rounded\"\r\n            onClick={onClose}\r\n          >\r\n            Cancel\r\n          </button>\r\n          <button\r\n            className=\"px-4 py-2 bg-blue-600 dark:bg-blue-700 text-white rounded disabled:opacity-50\"\r\n            disabled={selected.length === 0}\r\n            onClick={handleDownload}\r\n          >\r\n            Download PDF\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\n// Draggable item for available columns (left)\r\nfunction DraggableColumnItem({\r\n  id,\r\n  label,\r\n  onAdd,\r\n}: {\r\n  id: string;\r\n  label: string;\r\n  onAdd: () => void;\r\n}) {\r\n  const { attributes, listeners, setNodeRef, transform, transition, isDragging } = useSortable({\r\n    id,\r\n  });\r\n  return (\r\n    <li\r\n      ref={setNodeRef}\r\n      style={{\r\n        transform: CSS.Transform.toString(transform),\r\n        transition,\r\n        opacity: isDragging ? 0.5 : 1,\r\n      }}\r\n      className=\"flex items-center gap-2 bg-white dark:bg-gray-900 border-b last:border-b-0 border-gray-100 dark:border-gray-800 py-1 px-2 rounded cursor-pointer group\"\r\n      {...attributes}\r\n      {...listeners}\r\n      tabIndex={0}\r\n      onClick={onAdd}\r\n      title=\"Add to Download\"\r\n    >\r\n      <span\r\n        className=\"cursor-move text-gray-400 dark:text-gray-500 select-none\"\r\n        aria-label=\"Drag to select column\"\r\n        title=\"Drag to select column\"\r\n      >\r\n        ☰\r\n      </span>\r\n      <span className=\"flex-1 dark:text-gray-100\">{label}</span>\r\n    </li>\r\n  );\r\n}\r\n\r\n// Draggable/sortable item for selected columns (right)\r\nfunction SortableColumnItem({\r\n  id,\r\n  label,\r\n  onRemove,\r\n}: {\r\n  id: string;\r\n  label: string;\r\n  onRemove: () => void;\r\n}) {\r\n  const { attributes, listeners, setNodeRef, transform, transition, isDragging } = useSortable({\r\n    id,\r\n  });\r\n  return (\r\n    <li\r\n      ref={setNodeRef}\r\n      style={{\r\n        transform: CSS.Transform.toString(transform),\r\n        transition,\r\n        opacity: isDragging ? 0.5 : 1,\r\n      }}\r\n      className=\"flex items-center gap-2 bg-white dark:bg-gray-900 border-b last:border-b-0 border-gray-100 dark:border-gray-800 py-1 px-2 rounded cursor-move group\"\r\n      {...attributes}\r\n      {...listeners}\r\n    >\r\n      <span\r\n        className=\"cursor-move text-gray-400 dark:text-gray-500 select-none\"\r\n        aria-label=\"Drag to reorder\"\r\n        title=\"Drag to reorder\"\r\n      >\r\n        ☰\r\n      </span>\r\n      <span className=\"flex-1 dark:text-gray-100\">{label}</span>\r\n      <button\r\n        onClick={onRemove}\r\n        className=\"ml-auto text-gray-400 hover:text-red-500 dark:hover:text-red-400\"\r\n        title=\"Remove\"\r\n        type=\"button\"\r\n      >\r\n        ✕\r\n      </button>\r\n    </li>\r\n  );\r\n}\r\n// This code defines a modal component for selecting and ordering columns to download as a PDF.\r\n// It uses DnD Kit for drag-and-drop functionality, allowing users to reorder selected columns"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 403, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/handleDownloadPDF.ts"],"sourcesContent":["import jsPDF from 'jspdf';\r\nimport autoTable from 'jspdf-autotable';\r\nimport { ColumnOption } from './downloadColumnsModal';\r\n\r\n// Update with your correct logo path\r\nconst LOGO_URL = '/assets/images/system/goGirlsLogoV2.png';\r\nconst HEADER_BG_COLOR = '#9f004d';\r\nconst FOOTER_BG_COLOR = '#9f004d';\r\nconst HEADER_HEIGHT = 28; // in jsPDF units (about 7mm)\r\nconst FOOTER_HEIGHT = 20;\r\n\r\nconst dateFields = ['createdAt', 'updatedAt', 'date', 'dateOfBirth'];\r\n\r\n// Helper for Day.Month.Year format (e.g. 12.07.2025)\r\nfunction getCurrentDayMonthYear() {\r\n  const now = new Date();\r\n  const day = String(now.getDate()).padStart(2, '0');\r\n  const month = String(now.getMonth() + 1).padStart(2, '0');\r\n  const year = now.getFullYear();\r\n  return `${day}.${month}.${year}`;\r\n}\r\n\r\nexport async function handleDownloadPDF(data: any[], columns: ColumnOption[], cardName: string) {\r\n  const doc = new jsPDF({ orientation: 'landscape' });\r\n  const pageWidth = doc.internal.pageSize.getWidth();\r\n  const pageHeight = doc.internal.pageSize.getHeight();\r\n\r\n  // Load logo as base64\r\n  const logoImg = await fetch(LOGO_URL)\r\n    .then((r) => r.blob())\r\n    .then(\r\n      (blob) =>\r\n        new Promise<string>((resolve) => {\r\n          const reader = new FileReader();\r\n          reader.onloadend = () => resolve(reader.result as string);\r\n          reader.readAsDataURL(blob);\r\n        })\r\n    );\r\n\r\n  // ----- HEADER -----\r\n  // Draw header background\r\n  doc.setFillColor(HEADER_BG_COLOR);\r\n  doc.rect(0, 0, pageWidth, HEADER_HEIGHT, 'F');\r\n\r\n  // Vertically center everything in the header\r\n  const centerY = HEADER_HEIGHT / 2 + 1; // small correction for optical centering\r\n\r\n  // Logo (vertically centered)\r\n  const logoHeight = 18;\r\n  const logoWidth = 18;\r\n  const logoY = centerY - logoHeight / 2;\r\n  doc.addImage(logoImg, 'PNG', 10, logoY, logoWidth, logoHeight);\r\n\r\n  // \"GoGirls ICT Initiative\" (white, bold, large)\r\n  doc.setFontSize(22);\r\n  doc.setTextColor('#FFFFFF');\r\n  doc.setFont('helvetica', 'bold');\r\n  const orgName = 'GoGirls ICT Initiative';\r\n  const orgNameX = 10 + logoWidth + 10; // logo + spacing\r\n  doc.text(orgName, orgNameX, centerY, { baseline: 'middle' });\r\n\r\n  // Card Name (black, bold, large, right-aligned, same line)\r\n  doc.setFontSize(22);\r\n  doc.setTextColor('#000000');\r\n  doc.setFont('helvetica', 'bold');\r\n  const cardTextWidth = doc.getTextWidth(cardName);\r\n  doc.text(cardName, pageWidth - 10 - cardTextWidth, centerY, { baseline: 'middle' });\r\n\r\n  // ----- TABLE -----\r\n  const headers = columns.map((col) => col.label);\r\n  const rows = data.map((row, idx) =>\r\n    columns.map((col) => {\r\n      if (col.id === 'number') return idx + 1;\r\n      if (dateFields.includes(col.id) && row[col.id]) {\r\n        // Format all dates as Day.Month.Year\r\n        const d = new Date(row[col.id]);\r\n        return `${String(d.getDate()).padStart(2, '0')}.${String(d.getMonth() + 1).padStart(\r\n          2,\r\n          '0'\r\n        )}.${d.getFullYear()}`;\r\n      }\r\n      return row[col.id] ?? '';\r\n    })\r\n  );\r\n\r\n  autoTable(doc, {\r\n    head: [headers],\r\n    body: rows,\r\n    startY: HEADER_HEIGHT + 6,\r\n    margin: { left: 10, right: 10 },\r\n    didDrawPage: function (data) {\r\n      // ----- FOOTER -----\r\n      // Draw footer background\r\n      doc.setFillColor(FOOTER_BG_COLOR);\r\n      doc.rect(0, pageHeight - FOOTER_HEIGHT, pageWidth, FOOTER_HEIGHT, 'F');\r\n\r\n      // Footer content: copyright, day.month.year, org name, centered\r\n      doc.setFontSize(13);\r\n      doc.setTextColor('#FFFFFF');\r\n      doc.setFont('helvetica', 'bold');\r\n      const dayMonthYear = getCurrentDayMonthYear();\r\n      const footerText = `System-Generated on ${dayMonthYear} ©GoGirls ICT Initiative`;\r\n      const textWidth = doc.getTextWidth(footerText);\r\n      const centerX = pageWidth / 2;\r\n      const footerY = pageHeight - FOOTER_HEIGHT / 2 + 1; // optical center\r\n      doc.text(footerText, centerX - textWidth / 2, footerY, { baseline: 'middle' });\r\n    },\r\n  });\r\n\r\n  doc.save('table.pdf');\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 521, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/components/ui/table.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Table({ className, ...props }: React.ComponentProps<\"table\">) {\n  return (\n    <div\n      data-slot=\"table-container\"\n      className=\"relative w-full overflow-x-auto\"\n    >\n      <table\n        data-slot=\"table\"\n        className={cn(\"w-full caption-bottom text-sm\", className)}\n        {...props}\n      />\n    </div>\n  )\n}\n\nfunction TableHeader({ className, ...props }: React.ComponentProps<\"thead\">) {\n  return (\n    <thead\n      data-slot=\"table-header\"\n      className={cn(\"[&_tr]:border-b\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction TableBody({ className, ...props }: React.ComponentProps<\"tbody\">) {\n  return (\n    <tbody\n      data-slot=\"table-body\"\n      className={cn(\"[&_tr:last-child]:border-0\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction TableFooter({ className, ...props }: React.ComponentProps<\"tfoot\">) {\n  return (\n    <tfoot\n      data-slot=\"table-footer\"\n      className={cn(\n        \"bg-muted/50 border-t font-medium [&>tr]:last:border-b-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableRow({ className, ...props }: React.ComponentProps<\"tr\">) {\n  return (\n    <tr\n      data-slot=\"table-row\"\n      className={cn(\n        \"hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableHead({ className, ...props }: React.ComponentProps<\"th\">) {\n  return (\n    <th\n      data-slot=\"table-head\"\n      className={cn(\n        \"text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableCell({ className, ...props }: React.ComponentProps<\"td\">) {\n  return (\n    <td\n      data-slot=\"table-cell\"\n      className={cn(\n        \"p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableCaption({\n  className,\n  ...props\n}: React.ComponentProps<\"caption\">) {\n  return (\n    <caption\n      data-slot=\"table-caption\"\n      className={cn(\"text-muted-foreground mt-4 text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n"],"names":[],"mappings":";;;;;;;;;;;AAIA;AAJA;;;AAMA,SAAS,MAAM,EAAE,SAAS,EAAE,GAAG,OAAsC;IACnE,qBACE,6LAAC;QACC,aAAU;QACV,WAAU;kBAEV,cAAA,6LAAC;YACC,aAAU;YACV,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;YAC9C,GAAG,KAAK;;;;;;;;;;;AAIjB;KAbS;AAeT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAsC;IACzE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EAAE,mBAAmB;QAChC,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAsC;IACvE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EAAE,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAsC;IACzE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EACV,2DACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,SAAS,EAAE,SAAS,EAAE,GAAG,OAAmC;IACnE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EACV,+EACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAmC;IACpE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EACV,sJACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAmC;IACpE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EACV,0GACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,aAAa,EACpB,SAAS,EACT,GAAG,OAC6B;IAChC,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EAAE,sCAAsC;QACnD,GAAG,KAAK;;;;;;AAGf;MAXS","debugId":null}},
    {"offset": {"line": 659, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/data-table/data-table/data-table.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { ColumnDef, flexRender, getCoreRowModel, useReactTable } from '@tanstack/react-table';\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from '@/components/ui/table';\r\nimport React from 'react';\r\nimport '@/assets/styles/resizer.css'; // Import the CSS file for the resizer\r\n\r\ninterface DataTableProps<TData, TValue> {\r\n  columns: ColumnDef<TData, TValue>[];\r\n  data: TData[];\r\n}\r\n\r\nexport function DataTable<TData, TValue>({ columns, data }: DataTableProps<TData, TValue>) {\r\n  const table = useReactTable({\r\n    data,\r\n    columns,\r\n    getCoreRowModel: getCoreRowModel(),\r\n    enableColumnResizing: true,\r\n    columnResizeMode: 'onChange', // or \"onEnd\"\r\n  });\r\n\r\n  return (\r\n    <div className=\"rounded-md border mt-6 overflow-x-auto\">\r\n      <Table>\r\n        <TableHeader>\r\n          {table.getHeaderGroups().map((headerGroup) => (\r\n            <TableRow key={headerGroup.id}>\r\n              {headerGroup.headers.map((header) => (\r\n                <TableHead\r\n                  key={header.id}\r\n                  style={{\r\n                    position: 'relative',\r\n                    width: header.getSize(),\r\n                    minWidth: header.column.columnDef.minSize ?? 40,\r\n                    maxWidth: header.column.columnDef.maxSize ?? 1000,\r\n                  }}\r\n                >\r\n                  {flexRender(header.column.columnDef.header, header.getContext())}\r\n                  {header.column.getCanResize() && (\r\n                    <div\r\n                      onMouseDown={header.getResizeHandler()}\r\n                      onTouchStart={header.getResizeHandler()}\r\n                      className=\"resizer\"\r\n                    />\r\n                  )}\r\n                </TableHead>\r\n              ))}\r\n            </TableRow>\r\n          ))}\r\n        </TableHeader>\r\n        <TableBody>\r\n          {table.getRowModel().rows.map((row) => (\r\n            <TableRow\r\n              key={row.id}\r\n              className=\"hover:bg-gray-100 dark:hover:bg-neutral-800 transition-colors\"\r\n            >\r\n              {row.getVisibleCells().map((cell) => (\r\n                <TableCell\r\n                  key={cell.id}\r\n                  style={{\r\n                    width: cell.column.getSize(),\r\n                    minWidth: cell.column.columnDef.minSize ?? 40,\r\n                    maxWidth: cell.column.columnDef.maxSize ?? 1000,\r\n                  }}\r\n                >\r\n                  {flexRender(cell.column.columnDef.cell, cell.getContext())}\r\n                </TableCell>\r\n              ))}\r\n            </TableRow>\r\n          ))}\r\n        </TableBody>\r\n      </Table>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AAAA;AACA;;;AAHA;;;;AAmBO,SAAS,UAAyB,EAAE,OAAO,EAAE,IAAI,EAAiC;;IACvF,MAAM,QAAQ,CAAA,GAAA,yLAAA,CAAA,gBAAa,AAAD,EAAE;QAC1B;QACA;QACA,iBAAiB,CAAA,GAAA,wKAAA,CAAA,kBAAe,AAAD;QAC/B,sBAAsB;QACtB,kBAAkB;IACpB;IAEA,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC,6HAAA,CAAA,QAAK;;8BACJ,6LAAC,6HAAA,CAAA,cAAW;8BACT,MAAM,eAAe,GAAG,GAAG,CAAC,CAAC,4BAC5B,6LAAC,6HAAA,CAAA,WAAQ;sCACN,YAAY,OAAO,CAAC,GAAG,CAAC,CAAC,uBACxB,6LAAC,6HAAA,CAAA,YAAS;oCAER,OAAO;wCACL,UAAU;wCACV,OAAO,OAAO,OAAO;wCACrB,UAAU,OAAO,MAAM,CAAC,SAAS,CAAC,OAAO,IAAI;wCAC7C,UAAU,OAAO,MAAM,CAAC,SAAS,CAAC,OAAO,IAAI;oCAC/C;;wCAEC,CAAA,GAAA,yLAAA,CAAA,aAAU,AAAD,EAAE,OAAO,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE,OAAO,UAAU;wCAC5D,OAAO,MAAM,CAAC,YAAY,oBACzB,6LAAC;4CACC,aAAa,OAAO,gBAAgB;4CACpC,cAAc,OAAO,gBAAgB;4CACrC,WAAU;;;;;;;mCAbT,OAAO,EAAE;;;;;2BAHL,YAAY,EAAE;;;;;;;;;;8BAwBjC,6LAAC,6HAAA,CAAA,YAAS;8BACP,MAAM,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,oBAC7B,6LAAC,6HAAA,CAAA,WAAQ;4BAEP,WAAU;sCAET,IAAI,eAAe,GAAG,GAAG,CAAC,CAAC,qBAC1B,6LAAC,6HAAA,CAAA,YAAS;oCAER,OAAO;wCACL,OAAO,KAAK,MAAM,CAAC,OAAO;wCAC1B,UAAU,KAAK,MAAM,CAAC,SAAS,CAAC,OAAO,IAAI;wCAC3C,UAAU,KAAK,MAAM,CAAC,SAAS,CAAC,OAAO,IAAI;oCAC7C;8CAEC,CAAA,GAAA,yLAAA,CAAA,aAAU,AAAD,EAAE,KAAK,MAAM,CAAC,SAAS,CAAC,IAAI,EAAE,KAAK,UAAU;mCAPlD,KAAK,EAAE;;;;;2BALX,IAAI,EAAE;;;;;;;;;;;;;;;;;;;;;AAqBzB;GA9DgB;;QACA,yLAAA,CAAA,gBAAa;;;KADb","debugId":null}},
    {"offset": {"line": 775, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/data-table/columns/beneficiaries.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { ColumnDef } from '@tanstack/react-table';\r\nimport { Beneficiary } from '@/lib/generated/prisma';\r\nimport { Button } from '@/components/ui/button';\r\n\r\ntype BeneficiaryWithRelations = Beneficiary & {\r\n  createdBy?: {\r\n    firstName: string;\r\n    lastName: string;\r\n  };\r\n  institution?: {\r\n    id: string;\r\n    name: string;\r\n  };\r\n  beneficiaryMessages?: { id: string; title?: string }[];\r\n  messagesCount?: number; // server-provided\r\n  messageCount?: number; // sometimes named this way\r\n  responsesCount?: number; // server-provided\r\n  responseCount?: number;\r\n};\r\n\r\ntype Opts = {\r\n  onEdit: (beneficiary: BeneficiaryWithRelations) => void;\r\n  onView: (beneficiary: BeneficiaryWithRelations) => void;\r\n  onDelete?: (beneficiaryId: string) => void;\r\n  onAddMessage?: (beneficiaryId: string) => void;\r\n  onMessageIdClick?: (msgId: string) => void;\r\n  messagesCountMap?: Record<string, number>;\r\n  responsesCountMap?: Record<string, number>;\r\n  currentUserRole?: string;\r\n};\r\n\r\nexport function beneficiaryColumns({\r\n  onEdit,\r\n  onView,\r\n  onDelete,\r\n  onAddMessage,\r\n  onMessageIdClick,\r\n  messagesCountMap,\r\n  responsesCountMap,\r\n  currentUserRole,\r\n}: Opts): ColumnDef<BeneficiaryWithRelations>[] {\r\n  const cols: ColumnDef<BeneficiaryWithRelations>[] = [\r\n    {\r\n      accessorKey: 'firstName',\r\n      header: 'First Name',\r\n      cell: ({ row }) => (\r\n        <div className=\"whitespace-normal break-words max-w-xs\">{row.getValue('firstName')}</div>\r\n      ),\r\n    },\r\n    {\r\n      accessorKey: 'lastName',\r\n      header: 'Last Name',\r\n      cell: ({ row }) => (\r\n        <div className=\"whitespace-normal break-words max-w-xs\">{row.getValue('lastName')}</div>\r\n      ),\r\n    },\r\n\r\n    {\r\n      id: 'messagesCount',\r\n      header: 'Messages',\r\n      cell: ({ row }) => {\r\n        const id = row.original.id as string | undefined;\r\n        // Prefer server-provided count on the row, then fallback to the provided map\r\n        const serverCount = (row.original.messageCount ?? row.original.messagesCount) as\r\n          | number\r\n          | undefined;\r\n        if (typeof serverCount === 'number') return serverCount;\r\n        if (messagesCountMap && id) return messagesCountMap[id] ?? 0;\r\n        return 0;\r\n      },\r\n    },\r\n    {\r\n      id: 'addMessage',\r\n      header: '',\r\n      cell: ({ row }) =>\r\n        onAddMessage ? (\r\n          <Button\r\n            type=\"button\"\r\n            size=\"sm\"\r\n            className=\"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 dark:hover:bg-green-800 text-xs\"\r\n            onClick={() => onAddMessage(row.original.id)}\r\n          >\r\n            Add Message\r\n          </Button>\r\n        ) : null,\r\n    },\r\n\r\n    {\r\n      id: 'responsesCount',\r\n      header: 'Responses',\r\n      cell: ({ row }) => {\r\n        const id = row.original.id as string | undefined;\r\n        const serverCount = (row.original.responseCount ?? row.original.responsesCount) as\r\n          | number\r\n          | undefined;\r\n        if (typeof serverCount === 'number') return serverCount;\r\n        if (responsesCountMap && id) return responsesCountMap[id] ?? 0;\r\n        return 0;\r\n      },\r\n    },\r\n\r\n    {\r\n      accessorKey: 'createdAt',\r\n      header: 'Created At',\r\n      cell: ({ row }) =>\r\n        row.getValue('createdAt')\r\n          ? new Date(row.getValue('createdAt') as string).toLocaleDateString()\r\n          : '',\r\n    },\r\n    {\r\n      accessorKey: 'updatedAt',\r\n      header: 'Updated At',\r\n      cell: ({ row }) =>\r\n        row.getValue('updatedAt')\r\n          ? new Date(row.getValue('updatedAt') as string).toLocaleDateString()\r\n          : '',\r\n    },\r\n\r\n    {\r\n      id: 'edit',\r\n      header: 'Edit',\r\n      cell: ({ row }) => (\r\n        <Button\r\n          type=\"button\"\r\n          size=\"sm\"\r\n          variant=\"outline\"\r\n          className=\"transition-colors duration-150 hover:bg-yellow-100 dark:hover:bg-yellow-800 hover:text-yellow-900 dark:hover:text-yellow-100\"\r\n          onClick={() => onEdit(row.original)}\r\n        >\r\n          Edit\r\n        </Button>\r\n      ),\r\n    },\r\n    {\r\n      id: 'view',\r\n      header: 'View',\r\n      cell: ({ row }) =>\r\n        onView ? (\r\n          <Button\r\n            type=\"button\"\r\n            size=\"sm\"\r\n            variant=\"outline\"\r\n            className=\"transition-colors duration-150 hover:bg-blue-100 dark:hover:bg-blue-800 hover:text-blue-900 dark:hover:text-blue-100\"\r\n            onClick={() => onView(row.original)}\r\n          >\r\n            View\r\n          </Button>\r\n        ) : null,\r\n    },\r\n  ];\r\n\r\n  if (onDelete && currentUserRole !== 'beneficiary') {\r\n    cols.push({\r\n      id: 'delete',\r\n      header: 'Delete',\r\n      cell: ({ row }) => (\r\n        <Button\r\n          type=\"button\"\r\n          size=\"sm\"\r\n          variant=\"destructive\"\r\n          className=\"transition-colors duration-150 hover:bg-red-600 dark:hover:bg-red-800 hover:text-white dark:hover:text-white\"\r\n          onClick={() => onDelete(row.original.id)}\r\n        >\r\n          Delete\r\n        </Button>\r\n      ),\r\n    });\r\n  }\r\n\r\n  return cols;\r\n}\r\n"],"names":[],"mappings":";;;;AAIA;AAJA;;;AAiCO,SAAS,mBAAmB,EACjC,MAAM,EACN,MAAM,EACN,QAAQ,EACR,YAAY,EACZ,gBAAgB,EAChB,gBAAgB,EAChB,iBAAiB,EACjB,eAAe,EACV;IACL,MAAM,OAA8C;QAClD;YACE,aAAa;YACb,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,iBACZ,6LAAC;oBAAI,WAAU;8BAA0C,IAAI,QAAQ,CAAC;;;;;;QAE1E;QACA;YACE,aAAa;YACb,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,iBACZ,6LAAC;oBAAI,WAAU;8BAA0C,IAAI,QAAQ,CAAC;;;;;;QAE1E;QAEA;YACE,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE;gBACZ,MAAM,KAAK,IAAI,QAAQ,CAAC,EAAE;gBAC1B,6EAA6E;gBAC7E,MAAM,cAAe,IAAI,QAAQ,CAAC,YAAY,IAAI,IAAI,QAAQ,CAAC,aAAa;gBAG5E,IAAI,OAAO,gBAAgB,UAAU,OAAO;gBAC5C,IAAI,oBAAoB,IAAI,OAAO,gBAAgB,CAAC,GAAG,IAAI;gBAC3D,OAAO;YACT;QACF;QACA;YACE,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,GACZ,6BACE,6LAAC,8HAAA,CAAA,SAAM;oBACL,MAAK;oBACL,MAAK;oBACL,WAAU;oBACV,SAAS,IAAM,aAAa,IAAI,QAAQ,CAAC,EAAE;8BAC5C;;;;;2BAGC;QACR;QAEA;YACE,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE;gBACZ,MAAM,KAAK,IAAI,QAAQ,CAAC,EAAE;gBAC1B,MAAM,cAAe,IAAI,QAAQ,CAAC,aAAa,IAAI,IAAI,QAAQ,CAAC,cAAc;gBAG9E,IAAI,OAAO,gBAAgB,UAAU,OAAO;gBAC5C,IAAI,qBAAqB,IAAI,OAAO,iBAAiB,CAAC,GAAG,IAAI;gBAC7D,OAAO;YACT;QACF;QAEA;YACE,aAAa;YACb,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,GACZ,IAAI,QAAQ,CAAC,eACT,IAAI,KAAK,IAAI,QAAQ,CAAC,cAAwB,kBAAkB,KAChE;QACR;QACA;YACE,aAAa;YACb,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,GACZ,IAAI,QAAQ,CAAC,eACT,IAAI,KAAK,IAAI,QAAQ,CAAC,cAAwB,kBAAkB,KAChE;QACR;QAEA;YACE,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,iBACZ,6LAAC,8HAAA,CAAA,SAAM;oBACL,MAAK;oBACL,MAAK;oBACL,SAAQ;oBACR,WAAU;oBACV,SAAS,IAAM,OAAO,IAAI,QAAQ;8BACnC;;;;;;QAIL;QACA;YACE,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,GACZ,uBACE,6LAAC,8HAAA,CAAA,SAAM;oBACL,MAAK;oBACL,MAAK;oBACL,SAAQ;oBACR,WAAU;oBACV,SAAS,IAAM,OAAO,IAAI,QAAQ;8BACnC;;;;;2BAGC;QACR;KACD;IAED,IAAI,YAAY,oBAAoB,eAAe;QACjD,KAAK,IAAI,CAAC;YACR,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,iBACZ,6LAAC,8HAAA,CAAA,SAAM;oBACL,MAAK;oBACL,MAAK;oBACL,SAAQ;oBACR,WAAU;oBACV,SAAS,IAAM,SAAS,IAAI,QAAQ,CAAC,EAAE;8BACxC;;;;;;QAIL;IACF;IAEA,OAAO;AACT","debugId":null}},
    {"offset": {"line": 919, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/components/ui/dialog.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { XIcon } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Dialog({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Root>) {\n  return <DialogPrimitive.Root data-slot=\"dialog\" {...props} />\n}\n\nfunction DialogTrigger({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Trigger>) {\n  return <DialogPrimitive.Trigger data-slot=\"dialog-trigger\" {...props} />\n}\n\nfunction DialogPortal({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Portal>) {\n  return <DialogPrimitive.Portal data-slot=\"dialog-portal\" {...props} />\n}\n\nfunction DialogClose({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Close>) {\n  return <DialogPrimitive.Close data-slot=\"dialog-close\" {...props} />\n}\n\nfunction DialogOverlay({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Overlay>) {\n  return (\n    <DialogPrimitive.Overlay\n      data-slot=\"dialog-overlay\"\n      className={cn(\n        \"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DialogContent({\n  className,\n  children,\n  showCloseButton = true,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Content> & {\n  showCloseButton?: boolean\n}) {\n  return (\n    <DialogPortal data-slot=\"dialog-portal\">\n      <DialogOverlay />\n      <DialogPrimitive.Content\n        data-slot=\"dialog-content\"\n        className={cn(\n          \"bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n        {showCloseButton && (\n          <DialogPrimitive.Close\n            data-slot=\"dialog-close\"\n            className=\"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\"\n          >\n            <XIcon />\n            <span className=\"sr-only\">Close</span>\n          </DialogPrimitive.Close>\n        )}\n      </DialogPrimitive.Content>\n    </DialogPortal>\n  )\n}\n\nfunction DialogHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"dialog-header\"\n      className={cn(\"flex flex-col gap-2 text-center sm:text-left\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction DialogFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"dialog-footer\"\n      className={cn(\n        \"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DialogTitle({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Title>) {\n  return (\n    <DialogPrimitive.Title\n      data-slot=\"dialog-title\"\n      className={cn(\"text-lg leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction DialogDescription({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Description>) {\n  return (\n    <DialogPrimitive.Description\n      data-slot=\"dialog-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Dialog,\n  DialogClose,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogOverlay,\n  DialogPortal,\n  DialogTitle,\n  DialogTrigger,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;AAGA;AACA;AAEA;AANA;;;;;AAQA,SAAS,OAAO,EACd,GAAG,OAC+C;IAClD,qBAAO,6LAAC,qKAAA,CAAA,OAAoB;QAAC,aAAU;QAAU,GAAG,KAAK;;;;;;AAC3D;KAJS;AAMT,SAAS,cAAc,EACrB,GAAG,OACkD;IACrD,qBAAO,6LAAC,qKAAA,CAAA,UAAuB;QAAC,aAAU;QAAkB,GAAG,KAAK;;;;;;AACtE;MAJS;AAMT,SAAS,aAAa,EACpB,GAAG,OACiD;IACpD,qBAAO,6LAAC,qKAAA,CAAA,SAAsB;QAAC,aAAU;QAAiB,GAAG,KAAK;;;;;;AACpE;MAJS;AAMT,SAAS,YAAY,EACnB,GAAG,OACgD;IACnD,qBAAO,6LAAC,qKAAA,CAAA,QAAqB;QAAC,aAAU;QAAgB,GAAG,KAAK;;;;;;AAClE;MAJS;AAMT,SAAS,cAAc,EACrB,SAAS,EACT,GAAG,OACkD;IACrD,qBACE,6LAAC,qKAAA,CAAA,UAAuB;QACtB,aAAU;QACV,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EACV,0JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,cAAc,EACrB,SAAS,EACT,QAAQ,EACR,kBAAkB,IAAI,EACtB,GAAG,OAGJ;IACC,qBACE,6LAAC;QAAa,aAAU;;0BACtB,6LAAC;;;;;0BACD,6LAAC,qKAAA,CAAA,UAAuB;gBACtB,aAAU;gBACV,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EACV,+WACA;gBAED,GAAG,KAAK;;oBAER;oBACA,iCACC,6LAAC,qKAAA,CAAA,QAAqB;wBACpB,aAAU;wBACV,WAAU;;0CAEV,6LAAC,mMAAA,CAAA,QAAK;;;;;0CACN,6LAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;;;;;;;;;;;;;AAMtC;MAhCS;AAkCT,SAAS,aAAa,EAAE,SAAS,EAAE,GAAG,OAAoC;IACxE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EAAE,gDAAgD;QAC7D,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,aAAa,EAAE,SAAS,EAAE,GAAG,OAAoC;IACxE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EACV,0DACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,6LAAC,qKAAA,CAAA,QAAqB;QACpB,aAAU;QACV,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EAAE,sCAAsC;QACnD,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,kBAAkB,EACzB,SAAS,EACT,GAAG,OACsD;IACzD,qBACE,6LAAC,qKAAA,CAAA,cAA2B;QAC1B,aAAU;QACV,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MAXS","debugId":null}},
    {"offset": {"line": 1117, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/sections/BeneficiariesSection.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useEffect, useMemo, useState } from 'react';\r\nimport { DataTable } from '@/app/(admin)/admin/dashboard/data-table/data-table/data-table';\r\nimport { beneficiaryColumns } from '@/app/(admin)/admin/dashboard/data-table/columns/beneficiaries';\r\nimport CreateMessageForm from '@/app/admin/dashboard/createMessageForm';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogFooter,\r\n} from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\n\r\nexport default function BeneficiariesSection({\r\n  paginatedData,\r\n  page,\r\n  rowsPerPage,\r\n  handleEdit,\r\n  handleView,\r\n  handleDelete,\r\n  messagesCountMap: initialMessagesCountMap,\r\n  responsesCountMap: initialResponsesCountMap,\r\n  currentUserRole,\r\n  TableActions,\r\n  onAddMessage: externalOnAddMessage,\r\n}: {\r\n  paginatedData: any[];\r\n  page: number;\r\n  rowsPerPage: number;\r\n  handleEdit: (record: any) => void;\r\n  handleDelete: (id: string | number) => void;\r\n  messagesCountMap?: Record<string, number>;\r\n  responsesCountMap?: Record<string, number>;\r\n  currentUserRole: string;\r\n  TableActions: React.FC<any>;\r\n  onAddMessage?: (id: string) => void;\r\n}) {\r\n  // Local maps so the component can update counts immediately after creating a message\r\n  const [messagesCountMap, setMessagesCountMap] = useState<Record<string, number>>(\r\n    initialMessagesCountMap ?? {}\r\n  );\r\n  const [responsesCountMap, setResponsesCountMap] = useState<Record<string, number>>(\r\n    initialResponsesCountMap ?? {}\r\n  );\r\n\r\n  // When paginatedData (server list) changes we merge server-provided counts into the maps\r\n  useEffect(() => {\r\n    if (!Array.isArray(paginatedData)) return;\r\n\r\n    setMessagesCountMap((prev) => {\r\n      const merged = { ...prev };\r\n      for (const b of paginatedData) {\r\n        const id = b?.id;\r\n        const serverCount =\r\n          typeof b?.messageCount === 'number'\r\n            ? b.messageCount\r\n            : typeof b?.messagesCount === 'number'\r\n            ? b.messagesCount\r\n            : undefined;\r\n        if (id && typeof serverCount === 'number') merged[id] = serverCount;\r\n      }\r\n      return merged;\r\n    });\r\n\r\n    setResponsesCountMap((prev) => {\r\n      const merged = { ...prev };\r\n      for (const b of paginatedData) {\r\n        const id = b?.id;\r\n        const serverCount =\r\n          typeof b?.responseCount === 'number'\r\n            ? b.responseCount\r\n            : typeof b?.responsesCount === 'number'\r\n            ? b.responsesCount\r\n            : undefined;\r\n        if (id && typeof serverCount === 'number') merged[id] = serverCount;\r\n      }\r\n      return merged;\r\n    });\r\n  }, [paginatedData]);\r\n\r\n  // Dialog state\r\n  const [openAddMessageFor, setOpenAddMessageFor] = useState<string | null>(null);\r\n  const [creating, setCreating] = useState(false);\r\n\r\n  const openCreateModal = (beneficiaryId: string) => {\r\n    if (externalOnAddMessage) {\r\n      try {\r\n        externalOnAddMessage(beneficiaryId);\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n    setOpenAddMessageFor(beneficiaryId);\r\n  };\r\n\r\n  const closeCreateModal = () => {\r\n    setOpenAddMessageFor(null);\r\n  };\r\n\r\n  // After message creation we refresh counts by fetching beneficiary endpoint.\r\n  const handleCreateSuccess = async (beneficiaryId: string) => {\r\n    setCreating(true);\r\n    try {\r\n      const res = await fetch(`/api/beneficiaries/${encodeURIComponent(beneficiaryId)}`);\r\n      if (!res.ok) {\r\n        // optimistic fallback: increment messages\r\n        setMessagesCountMap((prev) => {\r\n          const prevCount = prev[beneficiaryId] ?? 0;\r\n          return { ...prev, [beneficiaryId]: prevCount + 1 };\r\n        });\r\n        setOpenAddMessageFor(null);\r\n        setCreating(false);\r\n        return;\r\n      }\r\n      const json = await res.json();\r\n      const msgCount =\r\n        typeof json.messageCount === 'number'\r\n          ? json.messageCount\r\n          : typeof json.messagesCount === 'number'\r\n          ? json.messagesCount\r\n          : undefined;\r\n      const respCount =\r\n        typeof json.responseCount === 'number'\r\n          ? json.responseCount\r\n          : typeof json.responsesCount === 'number'\r\n          ? json.responsesCount\r\n          : undefined;\r\n\r\n      setMessagesCountMap((prev) =>\r\n        typeof msgCount === 'number'\r\n          ? { ...prev, [beneficiaryId]: msgCount }\r\n          : { ...prev, [beneficiaryId]: (prev[beneficiaryId] ?? 0) + 1 }\r\n      );\r\n      if (typeof respCount === 'number') {\r\n        setResponsesCountMap((prev) => ({ ...prev, [beneficiaryId]: respCount }));\r\n      }\r\n      setOpenAddMessageFor(null);\r\n    } catch (err) {\r\n      // optimistic fallback increment\r\n      setMessagesCountMap((prev) => {\r\n        const prevCount = prev[beneficiaryId] ?? 0;\r\n        return { ...prev, [beneficiaryId]: prevCount + 1 };\r\n      });\r\n      setOpenAddMessageFor(null);\r\n    } finally {\r\n      setCreating(false);\r\n    }\r\n  };\r\n\r\n  // Provide onAddMessage to columns so Add Message button opens our dialog\r\n  const columns = useMemo(() => {\r\n    return [\r\n      {\r\n        id: 'number',\r\n        header: 'No.',\r\n        cell: ({ row }: any) => (page - 1) * rowsPerPage + row.index + 1,\r\n        size: 50,\r\n      },\r\n      ...beneficiaryColumns({\r\n        onEdit: handleEdit,\r\n        onView: handleView,\r\n        onDelete: handleDelete,\r\n        // pass our local handlers/maps\r\n        messagesCountMap,\r\n        responsesCountMap,\r\n        currentUserRole,\r\n        onAddMessage: (id: string) => openCreateModal(id),\r\n      }),\r\n    ];\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [\r\n    page,\r\n    rowsPerPage,\r\n    handleEdit,\r\n    handleView,\r\n    handleDelete,\r\n    messagesCountMap,\r\n    responsesCountMap,\r\n    currentUserRole,\r\n  ]);\r\n\r\n  return (\r\n    <>\r\n      <DataTable columns={columns} data={paginatedData} />\r\n      <TableActions data={paginatedData} columns={columns} tableRef={React.createRef()} />\r\n\r\n      {/* shadcn Dialog for Create Message */}\r\n      <Dialog open={!!openAddMessageFor} onOpenChange={(val) => !val && closeCreateModal()}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>Create Message for beneficiary</DialogTitle>\r\n          </DialogHeader>\r\n\r\n          {openAddMessageFor && (\r\n            <div className=\"p-4 max-w-3xl\">\r\n              <CreateMessageForm\r\n                messageId={openAddMessageFor}\r\n                onSuccess={async () => {\r\n                  await handleCreateSuccess(openAddMessageFor);\r\n                }}\r\n                onCancel={closeCreateModal}\r\n              />\r\n\r\n              <div className=\"mt-3 flex justify-end\">\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"outline\"\r\n                  onClick={closeCreateModal}\r\n                  disabled={creating}\r\n                >\r\n                  Close\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </DialogContent>\r\n      </Dialog>\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1383, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/sections/MessagesSection.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport { Message } from '@/lib/generated/prisma';\r\n\r\ntype MessageWithRelations = Message & {\r\n  beneficiary?: {\r\n    id: string;\r\n    firstName: string;\r\n    lastName: string;\r\n  } | null;\r\n};\r\n\r\nexport default function MessagesSection({\r\n  paginatedData,\r\n  page,\r\n  rowsPerPage,\r\n  handleEdit,\r\n  handleView,\r\n  handleDelete,\r\n  onRespond,\r\n  currentUserRole,\r\n  TableActions,\r\n  deleteId,\r\n  deleteLoading,\r\n}: {\r\n  paginatedData: MessageWithRelations[] | any[];\r\n  page: number;\r\n  rowsPerPage: number;\r\n  handleEdit: (record: any) => void;\r\n  // now handleView accepts an optional source so the dashboard knows this came from the messages list\r\n  handleView: (record: any, source?: 'messages' | 'responses' | string) => void;\r\n  handleDelete: (id: string | number) => void;\r\n  onRespond?: (messageId: number | string) => void;\r\n  currentUserRole?: string;\r\n  TableActions?: React.FC<any>;\r\n  deleteId?: string | number | null;\r\n  deleteLoading?: boolean;\r\n}) {\r\n  const ownerLabel = (m: MessageWithRelations) => {\r\n    if (m.name && `${m.name}`.trim().length > 0) return m.name;\r\n    if (m.beneficiary) return `${m.beneficiary.firstName} ${m.beneficiary.lastName}`;\r\n    return 'System';\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {(!Array.isArray(paginatedData) || paginatedData.length === 0) && (\r\n        <div className=\"text-center py-8 text-gray-500\">No messages found.</div>\r\n      )}\r\n\r\n      {Array.isArray(paginatedData) &&\r\n        paginatedData.map((m: any) => (\r\n          <div\r\n            key={m.id}\r\n            className=\"p-4 border rounded-md bg-white dark:bg-gray-900 hover:shadow-sm transition-shadow\"\r\n          >\r\n            <div className=\"flex items-start justify-between gap-4\">\r\n              <div\r\n                className=\"flex-1 min-w-0 cursor-pointer\"\r\n                onClick={() => handleView(m, 'messages')}\r\n                role=\"button\"\r\n                tabIndex={0}\r\n                onKeyDown={(e) => {\r\n                  if (e.key === 'Enter' || e.key === ' ') handleView(m, 'messages');\r\n                }}\r\n              >\r\n                <div className=\"flex flex-wrap items-center gap-3\">\r\n                  <div className=\"font-medium truncate\">{ownerLabel(m)}</div>\r\n                  <div className=\"text-xs px-2 py-1 rounded bg-gray-100 dark:bg-gray-800 text-sm\">\r\n                    {m.messageKind ?? '-'}\r\n                  </div>\r\n                  <div className=\"text-xs text-gray-500\">\r\n                    Created: {m.createdAt ? new Date(m.createdAt).toLocaleString() : '-'}\r\n                  </div>\r\n                  <div className=\"text-xs text-gray-500\">\r\n                    Updated: {m.updatedAt ? new Date(m.updatedAt).toLocaleString() : '-'}\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Intentionally not showing message content here */}\r\n              </div>\r\n\r\n              <div className=\"flex items-center gap-2\">\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"px-2 py-1 border rounded text-sm bg-blue-50 hover:bg-blue-100 dark:bg-gray-800 dark:hover:bg-blue-900\"\r\n                  onClick={() => handleView(m, 'messages')}\r\n                >\r\n                  View\r\n                </button>\r\n\r\n                {onRespond && m.allowResponses && (\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"px-2 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700\"\r\n                    onClick={() => onRespond(m.id)}\r\n                  >\r\n                    Respond\r\n                  </button>\r\n                )}\r\n\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"px-2 py-1 border rounded text-sm bg-yellow-50 hover:bg-yellow-100 dark:bg-gray-800 dark:hover:bg-yellow-900\"\r\n                  onClick={() => handleEdit(m)}\r\n                >\r\n                  Edit\r\n                </button>\r\n\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"px-2 py-1 border rounded text-sm bg-red-50 hover:bg-red-100 dark:bg-gray-800 dark:hover:bg-red-900\"\r\n                  onClick={() => handleDelete(m.id)}\r\n                  disabled={Boolean(deleteLoading && deleteId === m.id)}\r\n                >\r\n                  {deleteLoading && deleteId === m.id ? 'Deleting...' : 'Delete'}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ))}\r\n\r\n      {/* TableActions optional */}\r\n      <div>\r\n        {TableActions ? (\r\n          <TableActions data={paginatedData} columns={[]} tableRef={React.createRef()} />\r\n        ) : null}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AAFA;;;AAae,SAAS,gBAAgB,EACtC,aAAa,EACb,IAAI,EACJ,WAAW,EACX,UAAU,EACV,UAAU,EACV,YAAY,EACZ,SAAS,EACT,eAAe,EACf,YAAY,EACZ,QAAQ,EACR,aAAa,EAcd;IACC,MAAM,aAAa,CAAC;QAClB,IAAI,EAAE,IAAI,IAAI,GAAG,EAAE,IAAI,EAAE,CAAC,IAAI,GAAG,MAAM,GAAG,GAAG,OAAO,EAAE,IAAI;QAC1D,IAAI,EAAE,WAAW,EAAE,OAAO,GAAG,EAAE,WAAW,CAAC,SAAS,CAAC,CAAC,EAAE,EAAE,WAAW,CAAC,QAAQ,EAAE;QAChF,OAAO;IACT;IAEA,qBACE,6LAAC;QAAI,WAAU;;YACZ,CAAC,CAAC,MAAM,OAAO,CAAC,kBAAkB,cAAc,MAAM,KAAK,CAAC,mBAC3D,6LAAC;gBAAI,WAAU;0BAAiC;;;;;;YAGjD,MAAM,OAAO,CAAC,kBACb,cAAc,GAAG,CAAC,CAAC,kBACjB,6LAAC;oBAEC,WAAU;8BAEV,cAAA,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCACC,WAAU;gCACV,SAAS,IAAM,WAAW,GAAG;gCAC7B,MAAK;gCACL,UAAU;gCACV,WAAW,CAAC;oCACV,IAAI,EAAE,GAAG,KAAK,WAAW,EAAE,GAAG,KAAK,KAAK,WAAW,GAAG;gCACxD;0CAEA,cAAA,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAI,WAAU;sDAAwB,WAAW;;;;;;sDAClD,6LAAC;4CAAI,WAAU;sDACZ,EAAE,WAAW,IAAI;;;;;;sDAEpB,6LAAC;4CAAI,WAAU;;gDAAwB;gDAC3B,EAAE,SAAS,GAAG,IAAI,KAAK,EAAE,SAAS,EAAE,cAAc,KAAK;;;;;;;sDAEnE,6LAAC;4CAAI,WAAU;;gDAAwB;gDAC3B,EAAE,SAAS,GAAG,IAAI,KAAK,EAAE,SAAS,EAAE,cAAc,KAAK;;;;;;;;;;;;;;;;;;0CAOvE,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCACC,MAAK;wCACL,WAAU;wCACV,SAAS,IAAM,WAAW,GAAG;kDAC9B;;;;;;oCAIA,aAAa,EAAE,cAAc,kBAC5B,6LAAC;wCACC,MAAK;wCACL,WAAU;wCACV,SAAS,IAAM,UAAU,EAAE,EAAE;kDAC9B;;;;;;kDAKH,6LAAC;wCACC,MAAK;wCACL,WAAU;wCACV,SAAS,IAAM,WAAW;kDAC3B;;;;;;kDAID,6LAAC;wCACC,MAAK;wCACL,WAAU;wCACV,SAAS,IAAM,aAAa,EAAE,EAAE;wCAChC,UAAU,QAAQ,iBAAiB,aAAa,EAAE,EAAE;kDAEnD,iBAAiB,aAAa,EAAE,EAAE,GAAG,gBAAgB;;;;;;;;;;;;;;;;;;mBA9DvD,EAAE,EAAE;;;;;0BAsEf,6LAAC;0BACE,6BACC,6LAAC;oBAAa,MAAM;oBAAe,SAAS,EAAE;oBAAE,wBAAU,6JAAA,CAAA,UAAK,CAAC,SAAS;;;;;2BACvE;;;;;;;;;;;;AAIZ;KAtHwB","debugId":null}},
    {"offset": {"line": 1568, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/sections/ResponsesSection.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport { DataTable } from '@/app/(admin)/admin/dashboard/data-table/data-table/data-table';\r\nimport { responseColumns } from '@/app/(admin)/admin/dashboard/data-table/columns/responses';\r\n\r\nexport default function ResponsesSection({\r\n  paginatedData,\r\n  page,\r\n  rowsPerPage,\r\n  handleEdit,\r\n  handleView,\r\n  handleDelete,\r\n  TableActions,\r\n  deleteId,\r\n  deleteLoading,\r\n}: {\r\n  paginatedData: any[];\r\n  page: number;\r\n  rowsPerPage: number;\r\n  handleEdit: (record: any) => void;\r\n  handleView: (record: any) => void;\r\n  handleDelete: (id: string | number) => void;\r\n  TableActions: React.FC<any>;\r\n  deleteId?: string | number | null;\r\n  deleteLoading?: boolean;\r\n}) {\r\n  const columns = [\r\n    {\r\n      id: 'number',\r\n      header: 'No.',\r\n      cell: ({ row }: any) => (page - 1) * rowsPerPage + row.index + 1,\r\n      size: 50,\r\n    },\r\n    ...responseColumns({\r\n      onEdit: handleEdit,\r\n      onView: handleView,\r\n      onDelete: handleDelete,\r\n      deleteId,\r\n      deleteLoading,\r\n    }),\r\n  ];\r\n\r\n  return (\r\n    <>\r\n      <DataTable columns={columns} data={paginatedData} />\r\n      <TableActions data={paginatedData} columns={columns} tableRef={React.createRef()} />\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;;;;;;AAHA;;;;;AAMe,SAAS,iBAAiB,EACvC,aAAa,EACb,IAAI,EACJ,WAAW,EACX,UAAU,EACV,UAAU,EACV,YAAY,EACZ,YAAY,EACZ,QAAQ,EACR,aAAa,EAWd;IACC,MAAM,UAAU;QACd;YACE,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAO,GAAK,CAAC,OAAO,CAAC,IAAI,cAAc,IAAI,KAAK,GAAG;YAC/D,MAAM;QACR;WACG,gBAAgB;YACjB,QAAQ;YACR,QAAQ;YACR,UAAU;YACV;YACA;QACF;KACD;IAED,qBACE;;0BACE,6LAAC,6LAAA,CAAA,YAAS;gBAAC,SAAS;gBAAS,MAAM;;;;;;0BACnC,6LAAC;gBAAa,MAAM;gBAAe,SAAS;gBAAS,wBAAU,6JAAA,CAAA,UAAK,CAAC,SAAS;;;;;;;;AAGpF;KA3CwB","debugId":null}},
    {"offset": {"line": 1634, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/components/ui/input.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Input({ className, type, ...props }: React.ComponentProps<\"input\">) {\n  return (\n    <input\n      type={type}\n      data-slot=\"input\"\n      className={cn(\n        \"file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        \"focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]\",\n        \"aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Input }\n"],"names":[],"mappings":";;;;AAEA;;;AAEA,SAAS,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAsC;IACzE,qBACE,6LAAC;QACC,MAAM;QACN,aAAU;QACV,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EACV,mcACA,iFACA,0GACA;QAED,GAAG,KAAK;;;;;;AAGf;KAdS","debugId":null}},
    {"offset": {"line": 1666, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/components/ui/label.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Label({\n  className,\n  ...props\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\n  return (\n    <LabelPrimitive.Root\n      data-slot=\"label\"\n      className={cn(\n        \"flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Label }\n"],"names":[],"mappings":";;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,MAAM,EACb,SAAS,EACT,GAAG,OAC8C;IACjD,qBACE,6LAAC,oKAAA,CAAA,OAAmB;QAClB,aAAU;QACV,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EACV,uNACA;QAED,GAAG,KAAK;;;;;;AAGf;KAdS","debugId":null}},
    {"offset": {"line": 1700, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/createBeneficiaryForm.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect, ChangeEvent } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Label } from '@/components/ui/label';\r\n\r\nconst publishOptions = ['draft', 'published'] as const;\r\ntype PublishStatus = (typeof publishOptions)[number];\r\nconst genderOptions = ['male', 'female'] as const;\r\ntype GenderType = (typeof genderOptions)[number];\r\ntype Mode = 'create' | 'edit';\r\n\r\nconst institutionTypeOptions = [\r\n  'education',\r\n  'faith_based_organization',\r\n  'local_community',\r\n  'ngo',\r\n  'government',\r\n  'other',\r\n] as const;\r\ntype InstitutionType = (typeof institutionTypeOptions)[number];\r\n\r\ninterface BeneficiaryData {\r\n  id?: string;\r\n  firstName: string;\r\n  lastName: string;\r\n  image?: string;\r\n  images?: string[];\r\n  gender: GenderType;\r\n  email?: string;\r\n  phone?: string;\r\n  dateOfBirth: string;\r\n  beneficiaryStatus: PublishStatus;\r\n  institutionId?: string;\r\n}\r\n\r\ninterface InstitutionData {\r\n  id?: string;\r\n  name: string;\r\n  email?: string;\r\n  phone?: string;\r\n  headName?: string;\r\n  institutionType: InstitutionType;\r\n  logoFile?: File | null;\r\n}\r\n\r\nexport default function CreateBeneficiaryForm({\r\n  mode,\r\n  initialData,\r\n  onSuccess,\r\n  onCancel,\r\n}: {\r\n  mode: Mode;\r\n  initialData?: BeneficiaryData;\r\n  onSuccess?: () => void;\r\n  onCancel?: () => void;\r\n}) {\r\n  const router = useRouter();\r\n\r\n  const [institutions, setInstitutions] = useState<{ id: string; name: string }[]>([]);\r\n  const [institutionsLoading, setInstitutionsLoading] = useState(false);\r\n\r\n  const [form, setForm] = useState<BeneficiaryData>({\r\n    firstName: initialData?.firstName || '',\r\n    lastName: initialData?.lastName || '',\r\n    image: initialData?.image || undefined,\r\n    images: initialData?.images || [],\r\n    gender: initialData?.gender || 'male',\r\n    email: initialData?.email || '',\r\n    phone: initialData?.phone || '',\r\n    dateOfBirth: initialData?.dateOfBirth\r\n      ? new Date(initialData.dateOfBirth).toISOString().split('T')[0]\r\n      : '',\r\n    beneficiaryStatus: initialData?.beneficiaryStatus || 'draft',\r\n    institutionId: initialData?.institutionId || '',\r\n  });\r\n\r\n  const [imageFiles, setImageFiles] = useState<File[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const [showInstitutionForm, setShowInstitutionForm] = useState(false);\r\n  const [newInstitution, setNewInstitution] = useState<InstitutionData>({\r\n    name: '',\r\n    email: '',\r\n    phone: '',\r\n    headName: '',\r\n    institutionType: 'education',\r\n    logoFile: null,\r\n  });\r\n  const [creatingInstitution, setCreatingInstitution] = useState(false);\r\n  const [institutionError, setInstitutionError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    setInstitutionsLoading(true);\r\n    fetch('/api/institutions')\r\n      .then((res) => res.json())\r\n      .then((data) => {\r\n        setInstitutions(data.map((i: any) => ({ id: i.id, name: i.name })));\r\n        setInstitutionsLoading(false);\r\n      })\r\n      .catch(() => setInstitutionsLoading(false));\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (mode === 'edit' && initialData) {\r\n      setForm({\r\n        ...form,\r\n        ...initialData,\r\n        dateOfBirth: initialData.dateOfBirth\r\n          ? new Date(initialData.dateOfBirth).toISOString().split('T')[0]\r\n          : '',\r\n      });\r\n    }\r\n    // eslint-disable-next-line\r\n  }, [mode, initialData]);\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\r\n    const { name, value } = e.target;\r\n    setForm((prev) => ({ ...prev, [name]: value }));\r\n  };\r\n\r\n  const handleImageChange = (e: ChangeEvent<HTMLInputElement>) => {\r\n    if (e.target.files) {\r\n      setImageFiles(Array.from(e.target.files));\r\n    }\r\n  };\r\n\r\n  // Institution logic unchanged\r\n  const handleInstitutionField = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\r\n    const { name, value } = e.target;\r\n    setNewInstitution((prev) => ({ ...prev, [name]: value }));\r\n  };\r\n  const handleInstitutionLogo = (e: ChangeEvent<HTMLInputElement>) => {\r\n    if (e.target.files && e.target.files[0]) {\r\n      setNewInstitution((prev) => ({\r\n        ...prev,\r\n        logoFile: e.target.files![0],\r\n      }));\r\n    }\r\n  };\r\n\r\n  const validateInstitutionForm = () => {\r\n    if (!newInstitution.name || newInstitution.name.length < 2) {\r\n      setInstitutionError('Institution name is required.');\r\n      return false;\r\n    }\r\n    if (!newInstitution.logoFile) {\r\n      setInstitutionError('Logo file is required.');\r\n      return false;\r\n    }\r\n    if (!newInstitution.institutionType) {\r\n      setInstitutionError('Institution type is required.');\r\n      return false;\r\n    }\r\n    setInstitutionError(null);\r\n    return true;\r\n  };\r\n\r\n  const handleCreateInstitution = async () => {\r\n    if (!validateInstitutionForm()) return;\r\n    setCreatingInstitution(true);\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append('name', newInstitution.name.trim());\r\n      if (newInstitution.email) formData.append('email', newInstitution.email.trim());\r\n      if (newInstitution.phone) formData.append('phone', newInstitution.phone.trim());\r\n      if (newInstitution.headName) formData.append('headName', newInstitution.headName.trim());\r\n      formData.append('institutionType', newInstitution.institutionType);\r\n      if (newInstitution.logoFile) {\r\n        formData.append('logoFile', newInstitution.logoFile);\r\n      }\r\n\r\n      const res = await fetch('/api/institutions', {\r\n        method: 'POST',\r\n        body: formData,\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const error = await res.json().catch(() => ({}));\r\n        throw new Error(error.error || 'Failed to create institution');\r\n      }\r\n\r\n      const institution = await res.json();\r\n      setInstitutions((prev) => [...prev, { id: institution.id, name: institution.name }]);\r\n      setShowInstitutionForm(false);\r\n      setForm((prev) => ({\r\n        ...prev,\r\n        institutionId: institution.id,\r\n      }));\r\n      setNewInstitution({\r\n        name: '',\r\n        email: '',\r\n        phone: '',\r\n        headName: '',\r\n        institutionType: 'education',\r\n        logoFile: null,\r\n      });\r\n      setInstitutionError(null);\r\n    } catch (err: any) {\r\n      setInstitutionError(err.message || 'Failed to create institution');\r\n    } finally {\r\n      setCreatingInstitution(false);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n\r\n    try {\r\n      // Create or update Beneficiary via API\r\n      const formData = new FormData();\r\n      formData.append('firstName', form.firstName.trim());\r\n      formData.append('lastName', form.lastName.trim());\r\n      formData.append('gender', form.gender);\r\n      formData.append('dateOfBirth', form.dateOfBirth);\r\n      if (form.email) formData.append('email', form.email.trim());\r\n      if (form.phone) formData.append('phone', form.phone.trim());\r\n      if (form.institutionId) formData.append('institutionId', form.institutionId);\r\n      formData.append('beneficiaryStatus', form.beneficiaryStatus);\r\n\r\n      // Profile images\r\n      imageFiles.forEach((file) => {\r\n        formData.append('images', file);\r\n      });\r\n\r\n      let res;\r\n      let beneficiary: any;\r\n      if (mode === 'edit' && initialData?.id) {\r\n        res = await fetch(`/api/beneficiaries/${initialData.id}`, {\r\n          method: 'PATCH',\r\n          body: formData,\r\n        });\r\n        beneficiary = await res.json();\r\n      } else {\r\n        res = await fetch('/api/beneficiaries', {\r\n          method: 'POST',\r\n          body: formData,\r\n        });\r\n        if (!res.ok) {\r\n          const errorData = await res.json().catch(() => null);\r\n          throw new Error(\r\n            errorData?.error ||\r\n              (mode === 'edit' ? 'Failed to update beneficiary' : 'Failed to create beneficiary')\r\n          );\r\n        }\r\n        beneficiary = await res.json();\r\n      }\r\n\r\n      if (onSuccess) {\r\n        onSuccess();\r\n      } else {\r\n        router.refresh();\r\n        router.push('/admin');\r\n      }\r\n    } catch (err) {\r\n      console.error('Error saving beneficiary:', err);\r\n      alert(\r\n        `There was an error ${\r\n          mode === 'edit' ? 'updating' : 'creating'\r\n        } the beneficiary. Please try again.`\r\n      );\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <form\r\n      onSubmit={handleSubmit}\r\n      className=\"max-w-2xl mx-auto space-y-6 p-6 bg-background rounded-xl shadow\"\r\n      encType=\"multipart/form-data\"\r\n      autoComplete=\"off\"\r\n    >\r\n      <h2 className=\"font-semibold text-xl mb-4\">\r\n        {mode === 'edit' ? 'Edit Beneficiary' : 'Create New Beneficiary'}\r\n      </h2>\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"firstName\">First Name</Label>\r\n        <Input\r\n          id=\"firstName\"\r\n          name=\"firstName\"\r\n          value={form.firstName}\r\n          onChange={handleChange}\r\n          required\r\n        />\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"lastName\">Last Name</Label>\r\n        <Input\r\n          id=\"lastName\"\r\n          name=\"lastName\"\r\n          value={form.lastName}\r\n          onChange={handleChange}\r\n          required\r\n        />\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"gender\">Gender</Label>\r\n        <select\r\n          id=\"gender\"\r\n          name=\"gender\"\r\n          value={form.gender}\r\n          onChange={handleChange}\r\n          className=\"w-full border border-input rounded-md p-2 text-sm bg-background text-foreground\"\r\n          required\r\n        >\r\n          {genderOptions.map((g) => (\r\n            <option key={g} value={g}>\r\n              {g.charAt(0).toUpperCase() + g.slice(1)}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"dateOfBirth\">Date of Birth</Label>\r\n        <Input\r\n          id=\"dateOfBirth\"\r\n          name=\"dateOfBirth\"\r\n          type=\"date\"\r\n          value={form.dateOfBirth}\r\n          onChange={handleChange}\r\n          required\r\n        />\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"email\">Email</Label>\r\n        <Input id=\"email\" name=\"email\" type=\"email\" value={form.email} onChange={handleChange} />\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"phone\">Phone</Label>\r\n        <Input id=\"phone\" name=\"phone\" type=\"tel\" value={form.phone} onChange={handleChange} />\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"images\">Profile Images (PNG, JPG, JPEG)</Label>\r\n        <Input\r\n          id=\"images\"\r\n          name=\"images\"\r\n          type=\"file\"\r\n          accept=\".png,.jpg,.jpeg\"\r\n          multiple\r\n          onChange={handleImageChange}\r\n        />\r\n        <div className=\"text-xs text-muted-foreground\">\r\n          {imageFiles.map((file) => file.name).join(', ')}\r\n        </div>\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"institutionId\">Institution</Label>\r\n        <div className=\"flex gap-2 items-end\">\r\n          <select\r\n            id=\"institutionId\"\r\n            name=\"institutionId\"\r\n            value={form.institutionId}\r\n            onChange={(e) => {\r\n              setForm((prev) => ({ ...prev, institutionId: e.target.value }));\r\n              setShowInstitutionForm(false);\r\n            }}\r\n            className=\"flex-1 border border-input rounded-md p-2 text-sm bg-background text-foreground\"\r\n            disabled={institutionsLoading}\r\n            required\r\n          >\r\n            <option value=\"\">None</option>\r\n            {institutions.map((inst) => (\r\n              <option key={inst.id} value={inst.id}>\r\n                {inst.name}\r\n              </option>\r\n            ))}\r\n          </select>\r\n          <Button\r\n            type=\"button\"\r\n            variant=\"outline\"\r\n            className=\"ml-2\"\r\n            onClick={() => setShowInstitutionForm((val) => !val)}\r\n          >\r\n            Add new institution\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {showInstitutionForm && (\r\n        <div className=\"border rounded-md p-4 mt-2 bg-muted space-y-2\">\r\n          <Label htmlFor=\"institution_name\">Institution Name*</Label>\r\n          <Input\r\n            id=\"institution_name\"\r\n            name=\"name\"\r\n            value={newInstitution.name}\r\n            onChange={handleInstitutionField}\r\n            required\r\n          />\r\n          <Label htmlFor=\"institution_type\">Type*</Label>\r\n          <select\r\n            id=\"institution_type\"\r\n            name=\"institutionType\"\r\n            value={newInstitution.institutionType}\r\n            onChange={handleInstitutionField}\r\n            required\r\n            className=\"w-full border border-input rounded-md p-2 text-sm bg-background text-foreground\"\r\n          >\r\n            {institutionTypeOptions.map((type) => (\r\n              <option key={type} value={type}>\r\n                {type.replace(/_/g, ' ')}\r\n              </option>\r\n            ))}\r\n          </select>\r\n          <Label htmlFor=\"institution_logo\">Logo*</Label>\r\n          <Input\r\n            id=\"institution_logo\"\r\n            name=\"logoFile\"\r\n            type=\"file\"\r\n            accept=\".png,.jpg,.jpeg\"\r\n            onChange={handleInstitutionLogo}\r\n            required\r\n          />\r\n          <Label htmlFor=\"institution_email\">Email</Label>\r\n          <Input\r\n            id=\"institution_email\"\r\n            name=\"email\"\r\n            value={newInstitution.email}\r\n            onChange={handleInstitutionField}\r\n          />\r\n          <Label htmlFor=\"institution_phone\">Phone</Label>\r\n          <Input\r\n            id=\"institution_phone\"\r\n            name=\"phone\"\r\n            value={newInstitution.phone}\r\n            onChange={handleInstitutionField}\r\n          />\r\n          <Label htmlFor=\"institution_headName\">Head Name</Label>\r\n          <Input\r\n            id=\"institution_headName\"\r\n            name=\"headName\"\r\n            value={newInstitution.headName}\r\n            onChange={handleInstitutionField}\r\n          />\r\n          {institutionError && <div className=\"text-red-600 text-xs\">{institutionError}</div>}\r\n          <div className=\"flex gap-2 mt-2\">\r\n            <Button\r\n              type=\"button\"\r\n              className=\"bg-blue-600 hover:bg-blue-700 text-white\"\r\n              disabled={creatingInstitution}\r\n              onClick={handleCreateInstitution}\r\n            >\r\n              {creatingInstitution ? 'Adding...' : 'Add Institution'}\r\n            </Button>\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"outline\"\r\n              className=\"text-blue-600 border-blue-600 hover:bg-blue-50\"\r\n              onClick={() => setShowInstitutionForm(false)}\r\n              disabled={creatingInstitution}\r\n            >\r\n              Cancel\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"beneficiaryStatus\">Beneficiary Publish Status</Label>\r\n        <select\r\n          id=\"beneficiaryStatus\"\r\n          name=\"beneficiaryStatus\"\r\n          value={form.beneficiaryStatus}\r\n          onChange={handleChange}\r\n          className=\"w-full border border-input rounded-md p-2 text-sm bg-background text-foreground\"\r\n        >\r\n          {publishOptions.map((status) => (\r\n            <option key={status} value={status}>\r\n              {status}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      <div className=\"flex gap-3\">\r\n        <Button\r\n          type=\"submit\"\r\n          disabled={loading}\r\n          className=\"flex-1 bg-[#9f004d] hover:bg-[#7c003c] text-white\"\r\n        >\r\n          {loading\r\n            ? mode === 'edit'\r\n              ? 'Updating...'\r\n              : 'Creating...'\r\n            : mode === 'edit'\r\n            ? 'Update Beneficiary'\r\n            : 'Create Beneficiary'}\r\n        </Button>\r\n        {onCancel && (\r\n          <Button\r\n            type=\"button\"\r\n            variant=\"outline\"\r\n            className=\"flex-1 border-[#9f004d] text-[#9f004d] hover:bg-[#f5e3ec]\"\r\n            onClick={onCancel}\r\n            disabled={loading}\r\n          >\r\n            Cancel\r\n          </Button>\r\n        )}\r\n      </div>\r\n    </form>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2505, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/createMessageForm.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useSession } from 'next-auth/react';\r\n\r\ntype Props = {\r\n  messageId?: number | string;\r\n  editId?: string | null;\r\n  initialData?: any;\r\n  onSuccess?: () => void;\r\n  onCancel?: () => void;\r\n};\r\n\r\nexport default function CreateResponseForm({\r\n  messageId,\r\n  editId,\r\n  initialData,\r\n  onSuccess,\r\n  onCancel,\r\n}: Props) {\r\n  const { data: session } = useSession();\r\n  const [content, setContent] = useState<string>(() => {\r\n    if (initialData?.content && typeof initialData.content === 'string') return initialData.content;\r\n    // If content might be JSON, stringify for editing\r\n    if (initialData?.content && typeof initialData.content === 'object')\r\n      return JSON.stringify(initialData.content, null, 2);\r\n    return '';\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n  const [messageCreatorId, setMessageCreatorId] = useState<string | null>(() => {\r\n    // If editing an existing response, the initialData may include message.createdById\r\n    return initialData?.message?.createdById ?? initialData?.message?.createdBy?.id ?? null;\r\n  });\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    // If messageId provided, fetch message to determine creator (to show hint that the response will be tagged Author)\r\n    async function fetchMessage() {\r\n      const id = messageId ?? initialData?.message?.id;\r\n      if (!id) return;\r\n      try {\r\n        const res = await fetch(`/api/messages/${id}`);\r\n        if (!res.ok) return;\r\n        const json = await res.json();\r\n        setMessageCreatorId(json.createdById ?? json.createdBy?.id ?? null);\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n    fetchMessage();\r\n    // If initialData changes and contains message creator info, keep it\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [messageId, initialData?.message?.id]);\r\n\r\n  const submit = async (e?: React.FormEvent) => {\r\n    e?.preventDefault();\r\n    setError(null);\r\n\r\n    const targetMessageId = messageId ?? initialData?.message?.id;\r\n    if (!targetMessageId) {\r\n      setError('No message selected to respond to.');\r\n      return;\r\n    }\r\n\r\n    if (!content || !content.trim()) {\r\n      setError('Content cannot be empty.');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      // Try to send JSON if the content looks like JSON, otherwise send as string\r\n      let parsedContent: unknown = content;\r\n      const trimmed = content.trim();\r\n      if (\r\n        (trimmed.startsWith('{') && trimmed.endsWith('}')) ||\r\n        (trimmed.startsWith('[') && trimmed.endsWith(']'))\r\n      ) {\r\n        try {\r\n          parsedContent = JSON.parse(content);\r\n        } catch {\r\n          // keep as string if parsing fails\r\n          parsedContent = content;\r\n        }\r\n      }\r\n\r\n      const payload = {\r\n        messageId: targetMessageId,\r\n        content: parsedContent,\r\n      };\r\n\r\n      let res: Response;\r\n      if (editId || initialData?.id) {\r\n        const id = editId ?? initialData?.id;\r\n        res = await fetch(`/api/responses/${id}`, {\r\n          method: 'PATCH',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({ content: payload.content }),\r\n        });\r\n      } else {\r\n        res = await fetch(`/api/responses`, {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify(payload),\r\n        });\r\n      }\r\n\r\n      if (!res.ok) {\r\n        const body = await res.json().catch(() => ({}));\r\n        setError(body?.error || `Request failed (${res.status})`);\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      if (onSuccess) onSuccess();\r\n    } catch (err: any) {\r\n      setError(err?.message || 'Unexpected error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const isAuthor = !!(\r\n    session?.user?.id &&\r\n    messageCreatorId &&\r\n    session.user.id === messageCreatorId\r\n  );\r\n\r\n  return (\r\n    <form\r\n      onSubmit={submit}\r\n      className=\"w-full max-w-3xl mx-auto p-6 bg-background rounded-xl shadow space-y-4\"\r\n    >\r\n      <h3 className=\"text-lg font-semibold\">\r\n        {editId || initialData ? 'Edit Response' : 'Create Response'}\r\n      </h3>\r\n\r\n      {isAuthor && (\r\n        <div className=\"text-sm text-gray-700 dark:text-gray-300 p-2 rounded bg-yellow-50 dark:bg-yellow-900\">\r\n          You are the author of the original message — your response will be tagged as{' '}\r\n          <strong>Author</strong>.\r\n        </div>\r\n      )}\r\n\r\n      <div>\r\n        <label className=\"block text-sm font-medium mb-1\">Content</label>\r\n        <textarea\r\n          value={content}\r\n          onChange={(e) => setContent(e.target.value)}\r\n          rows={8}\r\n          className=\"w-full border rounded p-2 bg-white dark:bg-gray-800 dark:text-white\"\r\n        />\r\n        <p className=\"text-xs text-gray-500 mt-1\">\r\n          You can paste TipTap JSON or plain text. JSON will be preserved.\r\n        </p>\r\n      </div>\r\n\r\n      {error && <div className=\"text-sm text-red-600\">{error}</div>}\r\n\r\n      <div className=\"flex items-center gap-3\">\r\n        <button\r\n          type=\"submit\"\r\n          disabled={loading}\r\n          className=\"px-4 py-2 bg-pink-700 text-white rounded hover:bg-pink-800 disabled:opacity-60\"\r\n        >\r\n          {loading ? 'Saving...' : editId || initialData ? 'Save' : 'Create'}\r\n        </button>\r\n\r\n        <button\r\n          type=\"button\"\r\n          onClick={onCancel}\r\n          className=\"px-4 py-2 bg-gray-200 dark:bg-gray-800 rounded hover:bg-gray-300 dark:hover:bg-gray-700\"\r\n        >\r\n          Cancel\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2748, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/createResponseForm.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useSession } from 'next-auth/react';\r\n\r\ntype Props = {\r\n  messageId?: number | string;\r\n  editId?: string | null;\r\n  initialData?: any;\r\n  onSuccess?: () => void;\r\n  onCancel?: () => void;\r\n};\r\n\r\nexport default function CreateResponseForm({\r\n  messageId,\r\n  editId,\r\n  initialData,\r\n  onSuccess,\r\n  onCancel,\r\n}: Props) {\r\n  const { data: session } = useSession();\r\n  const [content, setContent] = useState<string>(() => {\r\n    if (initialData?.content && typeof initialData.content === 'string') return initialData.content;\r\n    // If content might be JSON, stringify for editing\r\n    if (initialData?.content && typeof initialData.content === 'object')\r\n      return JSON.stringify(initialData.content, null, 2);\r\n    return '';\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n  const [messageCreatorId, setMessageCreatorId] = useState<string | null>(() => {\r\n    // If editing an existing response, the initialData may include message.createdById\r\n    return initialData?.message?.createdById ?? initialData?.message?.createdBy?.id ?? null;\r\n  });\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    // If messageId provided, fetch message to determine creator (to show hint that the response will be tagged Author)\r\n    async function fetchMessage() {\r\n      const id = messageId ?? initialData?.message?.id;\r\n      if (!id) return;\r\n      try {\r\n        const res = await fetch(`/api/messages/${id}`);\r\n        if (!res.ok) return;\r\n        const json = await res.json();\r\n        setMessageCreatorId(json.createdById ?? json.createdBy?.id ?? null);\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n    fetchMessage();\r\n    // If initialData changes and contains message creator info, keep it\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [messageId, initialData?.message?.id]);\r\n\r\n  const submit = async (e?: React.FormEvent) => {\r\n    e?.preventDefault();\r\n    setError(null);\r\n\r\n    const targetMessageId = messageId ?? initialData?.message?.id;\r\n    if (!targetMessageId) {\r\n      setError('No message selected to respond to.');\r\n      return;\r\n    }\r\n\r\n    if (!content || !content.trim()) {\r\n      setError('Content cannot be empty.');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      // Try to send JSON if the content looks like JSON, otherwise send as string\r\n      let parsedContent: unknown = content;\r\n      const trimmed = content.trim();\r\n      if (\r\n        (trimmed.startsWith('{') && trimmed.endsWith('}')) ||\r\n        (trimmed.startsWith('[') && trimmed.endsWith(']'))\r\n      ) {\r\n        try {\r\n          parsedContent = JSON.parse(content);\r\n        } catch {\r\n          // keep as string if parsing fails\r\n          parsedContent = content;\r\n        }\r\n      }\r\n\r\n      const payload = {\r\n        messageId: targetMessageId,\r\n        content: parsedContent,\r\n      };\r\n\r\n      let res: Response;\r\n      if (editId || initialData?.id) {\r\n        const id = editId ?? initialData?.id;\r\n        res = await fetch(`/api/responses/${id}`, {\r\n          method: 'PATCH',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({ content: payload.content }),\r\n        });\r\n      } else {\r\n        res = await fetch(`/api/responses`, {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify(payload),\r\n        });\r\n      }\r\n\r\n      if (!res.ok) {\r\n        const body = await res.json().catch(() => ({}));\r\n        setError(body?.error || `Request failed (${res.status})`);\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      if (onSuccess) onSuccess();\r\n    } catch (err: any) {\r\n      setError(err?.message || 'Unexpected error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const isAuthor = !!(\r\n    session?.user?.id &&\r\n    messageCreatorId &&\r\n    session.user.id === messageCreatorId\r\n  );\r\n\r\n  return (\r\n    <form\r\n      onSubmit={submit}\r\n      className=\"w-full max-w-3xl mx-auto p-6 bg-background rounded-xl shadow space-y-4\"\r\n    >\r\n      <h3 className=\"text-lg font-semibold\">\r\n        {editId || initialData ? 'Edit Response' : 'Create Response'}\r\n      </h3>\r\n\r\n      {isAuthor && (\r\n        <div className=\"text-sm text-gray-700 dark:text-gray-300 p-2 rounded bg-yellow-50 dark:bg-yellow-900\">\r\n          You are the author of the original message — your response will be tagged as{' '}\r\n          <strong>Author</strong>.\r\n        </div>\r\n      )}\r\n\r\n      <div>\r\n        <label className=\"block text-sm font-medium mb-1\">Content</label>\r\n        <textarea\r\n          value={content}\r\n          onChange={(e) => setContent(e.target.value)}\r\n          rows={8}\r\n          className=\"w-full border rounded p-2 bg-white dark:bg-gray-800 dark:text-white\"\r\n        />\r\n        <p className=\"text-xs text-gray-500 mt-1\">\r\n          You can paste TipTap JSON or plain text. JSON will be preserved.\r\n        </p>\r\n      </div>\r\n\r\n      {error && <div className=\"text-sm text-red-600\">{error}</div>}\r\n\r\n      <div className=\"flex items-center gap-3\">\r\n        <button\r\n          type=\"submit\"\r\n          disabled={loading}\r\n          className=\"px-4 py-2 bg-pink-700 text-white rounded hover:bg-pink-800 disabled:opacity-60\"\r\n        >\r\n          {loading ? 'Saving...' : editId || initialData ? 'Save' : 'Create'}\r\n        </button>\r\n\r\n        <button\r\n          type=\"button\"\r\n          onClick={onCancel}\r\n          className=\"px-4 py-2 bg-gray-200 dark:bg-gray-800 rounded hover:bg-gray-300 dark:hover:bg-gray-700\"\r\n        >\r\n          Cancel\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2991, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/views/beneficiaryView.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport dynamic from 'next/dynamic';\r\nimport { useSession } from 'next-auth/react';\r\nimport '@/assets/styles/tiptap-editor.css';\r\n\r\n// Use the viewer for read-only rich text display (if any rich text fields)\r\nconst TiptapJsonViewer = dynamic(() => import('@/components/editor/tiptap-json-viewer'), {\r\n  ssr: false,\r\n});\r\n\r\ntype BeneficiaryLike = {\r\n  id?: string;\r\n  firstName?: string | null;\r\n  lastName?: string | null;\r\n  gender?: string | null;\r\n  email?: string | null;\r\n  phone?: string | null;\r\n  dateOfBirth?: string | null;\r\n  beneficiaryStatus?: string | null;\r\n  images?: string[] | null;\r\n  institution?: { name?: string | null } | null;\r\n  createdAt?: string | null;\r\n  updatedAt?: string | null;\r\n\r\n  // optional server-provided counts\r\n  messageCount?: number | null;\r\n  responseCount?: number | null;\r\n};\r\n\r\nexport default function BeneficiaryView({\r\n  data,\r\n  onClose,\r\n}: {\r\n  data: BeneficiaryLike;\r\n  onClose?: () => void;\r\n}) {\r\n  const { data: session } = useSession();\r\n  const role = (session as any)?.user?.role ?? 'guest';\r\n  const isPrivileged = role === 'super' || role === 'admin' || role === 'moderator';\r\n  const isSelfBeneficiary =\r\n    role === 'beneficiary' &&\r\n    !!data &&\r\n    // infer beneficiary identity from session first/last name match when possible\r\n    (session as any)?.user?.firstName &&\r\n    (session as any)?.user?.lastName &&\r\n    (session as any).user.firstName.trim().toLowerCase() ===\r\n      (data.firstName ?? '').trim().toLowerCase() &&\r\n    (session as any).user.lastName.trim().toLowerCase() ===\r\n      (data.lastName ?? '').trim().toLowerCase();\r\n\r\n  const [messageCount, setMessageCount] = useState<number | null>(\r\n    typeof data?.messageCount === 'number' ? data.messageCount : null\r\n  );\r\n  const [responseCount, setResponseCount] = useState<number | null>(\r\n    typeof data?.responseCount === 'number' ? data.responseCount : null\r\n  );\r\n  const [countsLoading, setCountsLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    // If counts are already provided by the server in `data`, don't fetch.\r\n    if (messageCount !== null && responseCount !== null) return;\r\n\r\n    // Only attempt to fetch counts if this view is for the logged-in beneficiary (self)\r\n    // or the current user is privileged (admin/super/moderator).\r\n    if (!isSelfBeneficiary && !isPrivileged) return;\r\n\r\n    // Try a few strategies to obtain counts:\r\n    // 1) /api/beneficiaries/:id/counts (preferred if you provide it)\r\n    // 2) fallback to fetching messages and responses filtered by beneficiaryId (if supported)\r\n    async function fetchCounts() {\r\n      if (!data?.id) return;\r\n      setCountsLoading(true);\r\n\r\n      try {\r\n        // try dedicated endpoint first\r\n        const countsRes = await fetch(`/api/beneficiaries/${data.id}/counts`);\r\n        if (countsRes.ok) {\r\n          const json = await countsRes.json();\r\n          if (typeof json.messageCount === 'number') setMessageCount(json.messageCount);\r\n          if (typeof json.responseCount === 'number') setResponseCount(json.responseCount);\r\n          setCountsLoading(false);\r\n          return;\r\n        }\r\n      } catch {\r\n        // ignore and fallback\r\n      }\r\n\r\n      try {\r\n        // fallback: fetch messages for beneficiary and count\r\n        const msgsRes = await fetch(\r\n          `/api/messages?beneficiaryId=${encodeURIComponent(data.id as string)}`\r\n        );\r\n        if (msgsRes.ok) {\r\n          const msgs = await msgsRes.json();\r\n          if (Array.isArray(msgs)) setMessageCount(msgs.length);\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n\r\n      try {\r\n        // fallback: fetch responses for beneficiary by relying on responses API to filter by message->beneficiary\r\n        const resRes = await fetch(\r\n          `/api/responses?beneficiaryId=${encodeURIComponent(data.id as string)}`\r\n        );\r\n        if (resRes.ok) {\r\n          const rs = await resRes.json();\r\n          if (Array.isArray(rs)) setResponseCount(rs.length);\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n\r\n      setCountsLoading(false);\r\n    }\r\n\r\n    fetchCounts();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [data?.id, isSelfBeneficiary, isPrivileged]);\r\n\r\n  // Render a compact card for beneficiary (for self) or a full info card (for privileged users)\r\n  return (\r\n    <div className=\"w-full max-w-5xl mx-auto space-y-4 bg-background rounded-xl shadow p-6\">\r\n      <div className=\"flex items-start justify-between\">\r\n        <h2 className=\"font-semibold text-xl\">Beneficiary</h2>\r\n        <div className=\"text-sm text-gray-600\">\r\n          {countsLoading ? (\r\n            'Loading counts…'\r\n          ) : (\r\n            <>\r\n              <div>\r\n                <strong>Messages:</strong> {messageCount !== null ? messageCount : 'N/A'}\r\n              </div>\r\n              <div>\r\n                <strong>Responses:</strong> {responseCount !== null ? responseCount : 'N/A'}\r\n              </div>\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n        <div>\r\n          <div>\r\n            <strong>Name:</strong> {data.firstName ?? '-'} {data.lastName ?? ''}\r\n          </div>\r\n\r\n          {isPrivileged && (\r\n            <>\r\n              <div>\r\n                <strong>Gender:</strong> {data.gender ?? '-'}\r\n              </div>\r\n              <div>\r\n                <strong>Email:</strong> {data.email ?? '-'}\r\n              </div>\r\n              <div>\r\n                <strong>Phone:</strong> {data.phone ?? '-'}\r\n              </div>\r\n              <div>\r\n                <strong>Date of Birth:</strong>{' '}\r\n                {data.dateOfBirth ? new Date(data.dateOfBirth).toLocaleDateString() : '-'}\r\n              </div>\r\n              <div>\r\n                <strong>Status:</strong> {data.beneficiaryStatus ?? '-'}\r\n              </div>\r\n            </>\r\n          )}\r\n\r\n          {!isPrivileged && (\r\n            <>\r\n              {/* For non-privileged beneficiaries (self) show limited contact info */}\r\n              <div>\r\n                <strong>Email:</strong> {data.email ? maskEmail(data.email) : '-'}\r\n              </div>\r\n              <div>\r\n                <strong>Phone:</strong> {data.phone ? maskPhone(data.phone) : '-'}\r\n              </div>\r\n            </>\r\n          )}\r\n        </div>\r\n\r\n        <div>\r\n          {Array.isArray(data.images) && data.images.length > 0 && (\r\n            <div>\r\n              <strong>Images:</strong>\r\n              <div className=\"flex flex-wrap gap-2 mt-2\">\r\n                {data.images.map((img: string, idx: number) =>\r\n                  img ? (\r\n                    <img\r\n                      key={idx}\r\n                      src={img}\r\n                      alt={`Beneficiary image ${idx + 1}`}\r\n                      className=\"max-w-xs max-h-64 rounded shadow border\"\r\n                      style={{ objectFit: 'cover' }}\r\n                    />\r\n                  ) : null\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {isPrivileged && (\r\n            <div className=\"mt-4\">\r\n              <div>\r\n                <strong>Institution:</strong> {data.institution?.name ?? '-'}\r\n              </div>\r\n              <div>\r\n                <strong>Created At:</strong>{' '}\r\n                {data.createdAt ? new Date(data.createdAt).toLocaleString() : '-'}\r\n              </div>\r\n              <div>\r\n                <strong>Updated At:</strong>{' '}\r\n                {data.updatedAt ? new Date(data.updatedAt).toLocaleString() : '-'}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"mt-4\">\r\n        {onClose && (\r\n          <button className=\"px-4 py-2 bg-pink-700 text-white rounded\" onClick={onClose}>\r\n            Close\r\n          </button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// small helpers to avoid showing raw contact details to other beneficiaries\r\nfunction maskEmail(e: string) {\r\n  try {\r\n    const [local, domain] = e.split('@');\r\n    if (!local || !domain) return e;\r\n    if (local.length <= 2) return `*@${domain}`;\r\n    return `${local[0]}${'*'.repeat(Math.max(1, local.length - 2))}${local.slice(-1)}@${domain}`;\r\n  } catch {\r\n    return e;\r\n  }\r\n}\r\n\r\nfunction maskPhone(p: string) {\r\n  const digits = p.replace(/\\D/g, '');\r\n  if (digits.length <= 4) return '****';\r\n  return `${'*'.repeat(Math.max(0, digits.length - 4))}${digits.slice(-4)}`;\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3471, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/views/messageView.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport dynamic from 'next/dynamic';\r\nimport { useSession } from 'next-auth/react';\r\nimport { Message, Response } from '@/lib/generated/prisma';\r\nimport '@/assets/styles/tiptap-editor.css';\r\n\r\n// TipTap JSON viewer for rich text message\r\nconst TiptapJsonViewer = dynamic(() => import('@/components/editor/tiptap-json-viewer'), {\r\n  ssr: false,\r\n});\r\n\r\ntype MessageWithRelations = Message & {\r\n  beneficiary?: {\r\n    id: string;\r\n    firstName: string;\r\n    lastName: string;\r\n    createdById?: string | null;\r\n  } | null;\r\n  createdBy?: {\r\n    id: string;\r\n    firstName?: string | null;\r\n    lastName?: string | null;\r\n    email?: string | null;\r\n  } | null;\r\n  // include createdById on the message when available (some APIs return it)\r\n  createdById?: string | null;\r\n  responses?: Array<\r\n    Response & {\r\n      responderUser?: {\r\n        id: string;\r\n        firstName: string;\r\n        lastName: string;\r\n        email?: string | null;\r\n      } | null;\r\n      responderBeneficiary?: {\r\n        id: string;\r\n        firstName: string;\r\n        lastName: string;\r\n        createdById?: string | null;\r\n      } | null;\r\n      message?: { id: number; title?: string | null };\r\n      responderRole?: 'USER' | 'BENEFICIARY' | 'AUTHOR' | 'SYSTEM';\r\n    }\r\n  >;\r\n};\r\n\r\nfunction AuthorBadge() {\r\n  return (\r\n    <span className=\"ml-2 inline-flex items-center text-xs font-semibold px-2 py-0.5 rounded bg-yellow-100 text-yellow-800 dark:bg-yellow-800 dark:text-yellow-100\">\r\n      Author\r\n    </span>\r\n  );\r\n}\r\n\r\nexport default function MessageView({\r\n  data,\r\n  onClose,\r\n  onRespond,\r\n}: {\r\n  data: MessageWithRelations;\r\n  onClose?: () => void;\r\n  onRespond?: (messageId: number | string) => void;\r\n}) {\r\n  const { data: session } = useSession();\r\n\r\n  if (!data) return null;\r\n\r\n  const content = data.content;\r\n\r\n  const renderContent = (c: unknown) => {\r\n    if (c === undefined || c === null) return <span>-</span>;\r\n    if (typeof c === 'object') {\r\n      return (\r\n        <div className=\"border rounded bg-white dark:bg-gray-900 mt-2\">\r\n          <TiptapJsonViewer content={c} className=\"tiptap tiptap-view-only\" />\r\n        </div>\r\n      );\r\n    }\r\n    return <span className=\"whitespace-pre-line\">{String(c)}</span>;\r\n  };\r\n\r\n  const ownerLabel = () => {\r\n    if (data.name && `${data.name}`.trim().length > 0) return data.name;\r\n    if (data.beneficiary) return `${data.beneficiary.firstName} ${data.beneficiary.lastName}`;\r\n    if (data.createdBy)\r\n      return `${data.createdBy.firstName ?? ''} ${data.createdBy.lastName ?? ''}`.trim();\r\n    return 'System';\r\n  };\r\n\r\n  const responderLabelText = (r: any) => {\r\n    if (!r) return 'System';\r\n    if (r.responderUser) {\r\n      const u = r.responderUser;\r\n      return `${u.firstName} ${u.lastName}${u.email ? ` (${u.email})` : ''}`;\r\n    }\r\n    if (r.responderBeneficiary) {\r\n      const b = r.responderBeneficiary;\r\n      return `${b.firstName} ${b.lastName}`;\r\n    }\r\n    // fallback to role\r\n    if (r.responderRole === 'AUTHOR') return 'Author';\r\n    return 'System';\r\n  };\r\n\r\n  // Helper: strict identity-based author check\r\n  const isResponseAuthor = (msg: MessageWithRelations, r: any) => {\r\n    // 1) server-declared AUTHOR is authoritative\r\n    if (r?.responderRole === 'AUTHOR') return true;\r\n\r\n    // message-level keys\r\n    const messageAuthorUserId =\r\n      (msg.createdBy && (msg.createdBy as any).id) ?? (msg as any).createdById ?? undefined;\r\n    const messageBeneficiaryId = msg.beneficiary?.id ?? (msg as any).beneficiaryId ?? undefined;\r\n\r\n    // responder-level keys\r\n    const responderUserId = r?.responderUser?.id ?? undefined;\r\n    const responderBeneficiaryId = r?.responderBeneficiary?.id ?? undefined;\r\n    const responderBeneficiaryOwnerId = r?.responderBeneficiary?.createdById ?? undefined;\r\n\r\n    // 2) If message was authored by a user account and responder is that same user\r\n    if (\r\n      messageAuthorUserId &&\r\n      responderUserId &&\r\n      String(messageAuthorUserId) === String(responderUserId)\r\n    )\r\n      return true;\r\n\r\n    // 3) If message is tied to a beneficiary (author is that beneficiary) and responder is that beneficiary\r\n    if (\r\n      messageBeneficiaryId &&\r\n      responderBeneficiaryId &&\r\n      String(messageBeneficiaryId) === String(responderBeneficiaryId)\r\n    )\r\n      return true;\r\n\r\n    // 4) If message was authored by a user account, and responder is a beneficiary whose createdById matches that user\r\n    //    (i.e., the responder beneficiary account is owned by the same user who authored the message)\r\n    if (\r\n      messageAuthorUserId &&\r\n      responderBeneficiaryOwnerId &&\r\n      String(messageAuthorUserId) === String(responderBeneficiaryOwnerId)\r\n    )\r\n      return true;\r\n\r\n    // No strict identity match => not author\r\n    return false;\r\n  };\r\n\r\n  // split responses by responder being the author of the message or not\r\n  const authorResponses = Array.isArray(data.responses)\r\n    ? data.responses.filter((r) => isResponseAuthor(data, r))\r\n    : [];\r\n  const otherResponses = Array.isArray(data.responses)\r\n    ? data.responses.filter((r) => !isResponseAuthor(data, r))\r\n    : [];\r\n\r\n  return (\r\n    <div className=\"w-full max-w-5xl mx-auto space-y-6 p-6 bg-background rounded-xl shadow\">\r\n      <h2 className=\"font-semibold text-xl mb-4\">View Message</h2>\r\n\r\n      <div className=\"space-y-3\">\r\n        {/* First line: owner name, category, createdAt, updatedAt (inline) */}\r\n        <div className=\"flex flex-wrap items-center gap-4 text-sm text-gray-600 dark:text-gray-300\">\r\n          <div className=\"font-medium\">{ownerLabel()}</div>\r\n          <div className=\"px-2 py-1 rounded bg-gray-100 dark:bg-gray-800 text-xs\">\r\n            {(data as any).messageCategory ?? '-'}\r\n          </div>\r\n          <div className=\"text-xs text-gray-500\">\r\n            Created: {data.createdAt ? new Date(data.createdAt).toLocaleString() : '-'}\r\n          </div>\r\n          <div className=\"text-xs text-gray-500\">\r\n            Updated: {data.updatedAt ? new Date(data.updatedAt).toLocaleString() : '-'}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Second line: message content */}\r\n        <div className=\"mt-2\">\r\n          <div className=\"font-medium mb-1\">Content</div>\r\n          <div className=\"ml-0\">{renderContent(content)}</div>\r\n        </div>\r\n\r\n        {/* Author response (distinct) */}\r\n        {authorResponses.length > 0 && (\r\n          <div className=\"mt-6\">\r\n            <h3 className=\"font-semibold text-lg mb-3\">Author's response</h3>\r\n            <div className=\"space-y-4\">\r\n              {authorResponses.map((r) => {\r\n                const isAuthor = isResponseAuthor(data, r);\r\n                return (\r\n                  <div\r\n                    key={r.id}\r\n                    className=\"p-3 border-l-4 border-pink-600 bg-pink-50 dark:bg-pink-900 rounded\"\r\n                  >\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div className=\"flex items-center\">\r\n                        <div className=\"text-sm font-medium\">{responderLabelText(r)}</div>\r\n                        {isAuthor && <AuthorBadge />}\r\n                      </div>\r\n                      <div className=\"text-xs text-gray-500\">\r\n                        {r.createdAt ? new Date(r.createdAt).toLocaleString() : ''}\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"mt-2\">{renderContent((r as any).content)}</div>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Other responses */}\r\n        {otherResponses.length > 0 && (\r\n          <div className=\"mt-6\">\r\n            <h3 className=\"font-semibold text-lg mb-3\">Responses</h3>\r\n            <div className=\"space-y-4\">\r\n              {otherResponses.map((r) => {\r\n                const isAuthor = isResponseAuthor(data, r);\r\n                return (\r\n                  <div key={r.id} className=\"p-3 border rounded bg-white dark:bg-gray-900\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div className=\"flex items-center\">\r\n                        <div className=\"text-sm font-medium\">{responderLabelText(r)}</div>\r\n                        {isAuthor && <AuthorBadge />}\r\n                      </div>\r\n                      <div className=\"text-xs text-gray-500\">\r\n                        {r.createdAt ? new Date(r.createdAt).toLocaleString() : ''}\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"mt-2\">{renderContent((r as any).content)}</div>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      <div className=\"flex gap-3 mt-4\">\r\n        {onClose && (\r\n          <button\r\n            type=\"button\"\r\n            className=\"px-4 py-2 bg-gray-200 dark:bg-gray-800 rounded hover:bg-gray-300 dark:hover:bg-gray-700\"\r\n            onClick={onClose}\r\n          >\r\n            Close\r\n          </button>\r\n        )}\r\n\r\n        {onRespond && data.allowResponses && (\r\n          <button\r\n            type=\"button\"\r\n            className=\"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700\"\r\n            onClick={() => onRespond(data.id)}\r\n          >\r\n            Respond\r\n          </button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3901, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useSession } from 'next-auth/react';\r\nimport { useRouter, useSearchParams, usePathname } from 'next/navigation';\r\nimport { useEffect, useState, useRef } from 'react';\r\nimport * as XLSX from 'xlsx';\r\nimport DownloadColumnsModal, { ColumnOption } from './components/downloadColumnsModal';\r\nimport { handleDownloadPDF } from './components/handleDownloadPDF';\r\n\r\nimport { FaUsers, FaEnvelope, FaReply, FaAngleLeft, FaAngleRight } from 'react-icons/fa';\r\n\r\n// Sections we keep\r\nimport BeneficiariesSection from './components/sections/BeneficiariesSection';\r\nimport MessagesSection from './components/sections/MessagesSection';\r\nimport ResponsesSection from './components/sections/ResponsesSection';\r\n\r\n// Create/edit forms we keep\r\nimport CreateBeneficiaryForm from './createBeneficiaryForm';\r\nimport CreateMessageForm from './createMessageForm';\r\nimport CreateResponseForm from './createResponseForm';\r\n\r\n// View-only components we keep\r\nimport BeneficiaryView from './components/views/beneficiaryView';\r\nimport MessageView from './components/views/messageView';\r\nimport ResponseView from './components/views/responseView';\r\n\r\n// Table controls component for search/filter/add/export\r\nfunction TableControls({\r\n  search,\r\n  setSearch,\r\n  onAddNew,\r\n  exportExcel,\r\n  downloadPDF,\r\n  activeSection,\r\n  sectionLabels,\r\n  hideSearch,\r\n  addNewLabel,\r\n}: {\r\n  search: string;\r\n  setSearch: (s: string) => void;\r\n  onAddNew: () => void;\r\n  exportExcel: () => void;\r\n  downloadPDF: () => void;\r\n  activeSection: string;\r\n  sectionLabels: Record<string, string>;\r\n  hideSearch?: boolean;\r\n  addNewLabel?: string;\r\n}) {\r\n  return (\r\n    <div className=\"flex flex-wrap items-center justify-between mb-4 gap-2\">\r\n      <div className=\"flex items-center gap-2 flex-1\">\r\n        {!hideSearch && (\r\n          <input\r\n            type=\"text\"\r\n            className=\"border px-3 py-2 rounded w-64 focus:outline-pink-500 dark:bg-gray-800 dark:text-white\"\r\n            placeholder={`Search ${sectionLabels[activeSection] || 'records'}...`}\r\n            value={search}\r\n            onChange={(e) => setSearch(e.target.value)}\r\n          />\r\n        )}\r\n        {!hideSearch && (\r\n          <>\r\n            <button\r\n              className=\"px-2 py-1 border rounded text-sm bg-green-50 hover:bg-green-100 dark:bg-gray-800 dark:hover:bg-green-900\"\r\n              title=\"Export to Excel\"\r\n              onClick={exportExcel}\r\n            >\r\n              Export to Excel\r\n            </button>\r\n            <button\r\n              className=\"px-2 py-1 border rounded text-sm bg-yellow-50 hover:bg-yellow-100 dark:bg-gray-800 dark:hover:bg-yellow-900\"\r\n              title=\"Download as PDF\"\r\n              onClick={downloadPDF}\r\n            >\r\n              Download as PDF\r\n            </button>\r\n          </>\r\n        )}\r\n      </div>\r\n      <div>\r\n        {addNewLabel && (\r\n          <button\r\n            className=\"px-4 py-2 bg-pink-700 text-white rounded hover:bg-pink-900 text-sm font-semibold\"\r\n            onClick={onAddNew}\r\n          >\r\n            {addNewLabel}\r\n          </button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Keep only these sections in the dashboard\r\nconst sections = ['beneficiaries', 'messages', 'responses'] as const;\r\ntype Section = (typeof sections)[number];\r\n\r\nconst sectionFeatures: Record<Section, { apiRoute?: string }> = {\r\n  beneficiaries: { apiRoute: '/api/beneficiaries' },\r\n  messages: { apiRoute: '/api/messages' },\r\n  responses: { apiRoute: '/api/responses' },\r\n};\r\n\r\nconst sectionIcons: Record<Section, React.ReactNode> = {\r\n  beneficiaries: <FaUsers className=\"text-indigo-600 dark:text-indigo-400\" />,\r\n  messages: <FaEnvelope className=\"text-orange-500 dark:text-orange-400\" />,\r\n  responses: <FaReply className=\"text-purple-600 dark:text-purple-400\" />,\r\n};\r\n\r\nconst sectionLabels: Record<Section, string> = {\r\n  beneficiaries: 'Beneficiaries',\r\n  messages: 'Messages',\r\n  responses: 'Responses',\r\n};\r\n\r\nexport default function AdminDashboardPage() {\r\n  const { data: session } = useSession();\r\n  const router = useRouter();\r\n  const [activeSection, setActiveSection] = useState<Section>('beneficiaries');\r\n  const [sidebarCollapsed, setSidebarCollapsed] = useState(false);\r\n  const [data, setData] = useState<any[]>([]);\r\n  const [editRecord, setEditRecord] = useState<any | null>(null);\r\n  const [viewRecord, setViewRecord] = useState<any | null>(null);\r\n  const [deleteId, setDeleteId] = useState<string | number | null>(null);\r\n  const [deleteLoading, setDeleteLoading] = useState(false);\r\n  const [sortBy, setSortBy] = useState('createdAt');\r\n  const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('desc');\r\n  const [rowsPerPage, setRowsPerPage] = useState<number>(10);\r\n  const [page, setPage] = useState<number>(1);\r\n  const [search, setSearch] = useState('');\r\n  const sectionRef = useRef<Section>('beneficiaries');\r\n\r\n  const searchParams = useSearchParams();\r\n  const pathname = usePathname();\r\n\r\n  const [downloadModalOpen, setDownloadModalOpen] = useState(false);\r\n  const [downloadColumns, setDownloadColumns] = useState<ColumnOption[]>([]);\r\n  const [pendingDownloadData, setPendingDownloadData] = useState<any[]>([]);\r\n\r\n  // Hide controls when viewing/editing/adding\r\n  const [hideControls, setHideControls] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const searchType = (searchParams.get('type') as Section) ?? null;\r\n    const sectionToLoad: Section =\r\n      searchType && sections.includes(searchType) ? searchType : 'beneficiaries';\r\n    handleMenuClick(sectionToLoad);\r\n    // eslint-disable-next-line\r\n  }, []);\r\n\r\n  async function handleMenuClick(section: Section) {\r\n    const newUrl = `${pathname}?type=${section}`;\r\n    router.replace(newUrl);\r\n    setActiveSection(section);\r\n    sectionRef.current = section;\r\n    setEditRecord(null);\r\n    setViewRecord(null);\r\n    setDeleteId(null);\r\n    setPage(1);\r\n    setHideControls(false);\r\n\r\n    const feat = sectionFeatures[section];\r\n    if (feat?.apiRoute) {\r\n      try {\r\n        const res = await fetch(feat.apiRoute);\r\n        if (!res.ok) {\r\n          setData([]);\r\n          return;\r\n        }\r\n        const rawData = await res.json();\r\n        if (Array.isArray(rawData)) {\r\n          setData(rawData);\r\n        } else if (rawData == null) {\r\n          setData([]);\r\n        } else {\r\n          setData([rawData]);\r\n        }\r\n      } catch {\r\n        setData([]);\r\n      }\r\n    } else {\r\n      setData([]);\r\n    }\r\n  }\r\n\r\n  function getSortedData(\r\n    data: any[],\r\n    sortBy: string,\r\n    sortOrder: 'asc' | 'desc',\r\n    activeSection: Section\r\n  ) {\r\n    if (!Array.isArray(data)) return [];\r\n    let sorted = [...data];\r\n    sorted.sort((a, b) => {\r\n      let valA = a[sortBy];\r\n      let valB = b[sortBy];\r\n      if (sortBy === 'createdAt' || sortBy === 'updatedAt') {\r\n        valA = new Date(valA).getTime();\r\n        valB = new Date(valB).getTime();\r\n      }\r\n      if (valA < valB) return sortOrder === 'asc' ? -1 : 1;\r\n      if (valA > valB) return sortOrder === 'asc' ? 1 : -1;\r\n      return 0;\r\n    });\r\n    return sorted;\r\n  }\r\n\r\n  function getFilteredData(sortedData: any[], search: string) {\r\n    if (!Array.isArray(sortedData)) return [];\r\n    if (!search.trim()) return sortedData;\r\n    const lower = search.toLowerCase();\r\n    return sortedData.filter((item) =>\r\n      Object.keys(item).some(\r\n        (key) => typeof item[key] === 'string' && item[key].toLowerCase().includes(lower)\r\n      )\r\n    );\r\n  }\r\n\r\n  function getPaginatedData(filteredData: any[], page: number, rowsPerPage: number) {\r\n    if (!Array.isArray(filteredData)) return [];\r\n    return (filteredData ?? []).slice((page - 1) * rowsPerPage, page * rowsPerPage);\r\n  }\r\n\r\n  const sortedData = getSortedData(data, sortBy, sortOrder, activeSection);\r\n  const filteredData = getFilteredData(sortedData, search);\r\n  const pageCount = Math.max(1, Math.ceil((filteredData?.length ?? 0) / rowsPerPage));\r\n  const paginatedData = getPaginatedData(filteredData, page, rowsPerPage);\r\n\r\n  // Edit/View handlers\r\n  function handleEdit(record: any) {\r\n    setHideControls(true);\r\n    setEditRecord(record);\r\n  }\r\n  function handleCancelEdit() {\r\n    setHideControls(false);\r\n    setEditRecord(null);\r\n  }\r\n  async function handleSaveEdit() {\r\n    setHideControls(false);\r\n    setEditRecord(null);\r\n    await handleMenuClick(activeSection);\r\n  }\r\n\r\n  function handleRespondToMessage(messageId: number | string) {\r\n    setHideControls(true);\r\n    setActiveSection('responses');\r\n    setEditRecord({ messageId });\r\n    setViewRecord(null);\r\n  }\r\n\r\n  // Unified view handler used by sections.\r\n  async function handleView(record: any, source?: Section) {\r\n    setHideControls(true);\r\n\r\n    if (!record) {\r\n      setViewRecord(null);\r\n      return;\r\n    }\r\n\r\n    // If the request came from the messages list, show the MessageView (with responses)\r\n    if (source === 'messages' || sectionRef.current === 'messages') {\r\n      try {\r\n        const id = record?.id ?? record;\r\n        const msgRes = await fetch(`/api/messages/${id}`);\r\n        const msgData = msgRes.ok ? await msgRes.json() : record;\r\n\r\n        const respRes = await fetch(`/api/responses`);\r\n        const respData = respRes.ok ? await respRes.json() : [];\r\n\r\n        const parentId = typeof msgData.id === 'number' ? msgData.id : Number(msgData.id);\r\n        const linkedResponses = Array.isArray(respData)\r\n          ? respData.filter(\r\n              (r: any) =>\r\n                (r.message && (r.message.id === parentId || Number(r.message.id) === parentId)) ||\r\n                (r.messageId && Number(r.messageId) === parentId)\r\n            )\r\n          : [];\r\n\r\n        setViewRecord({ ...msgData, responses: linkedResponses });\r\n        setActiveSection('messages');\r\n        return;\r\n      } catch {\r\n        // fallback to showing raw record\r\n      }\r\n    }\r\n\r\n    // If the request came from responses, show ResponseView\r\n    if (source === 'responses' || sectionRef.current === 'responses') {\r\n      try {\r\n        const id = record?.id ?? record;\r\n        const res = await fetch(`/api/responses/${id}`);\r\n        if (res.ok) {\r\n          const fullRecord = await res.json();\r\n          setViewRecord(fullRecord);\r\n          setActiveSection('responses');\r\n          return;\r\n        }\r\n      } catch {\r\n        // fallback\r\n      }\r\n    }\r\n\r\n    // For beneficiaries or fallback, set viewRecord directly\r\n    setViewRecord(record);\r\n  }\r\n\r\n  function handleCloseView() {\r\n    setHideControls(false);\r\n    setViewRecord(null);\r\n  }\r\n\r\n  async function handleDelete(id: string | number) {\r\n    setDeleteId(id);\r\n    setDeleteLoading(true);\r\n    try {\r\n      let apiRoute = sectionFeatures[activeSection]?.apiRoute;\r\n      if (!apiRoute) throw new Error('Delete API route not defined');\r\n      if (apiRoute.endsWith('/')) apiRoute = apiRoute.slice(0, -1);\r\n      const url = `${apiRoute}/${id}`;\r\n      const res = await fetch(url, { method: 'DELETE' });\r\n      const text = await res.text();\r\n      if (!res.ok) {\r\n        alert(`Failed to delete record: ${res.status}\\n${text}`);\r\n      } else {\r\n        await handleMenuClick(activeSection);\r\n      }\r\n    } catch (err) {\r\n      alert('Error deleting record: ' + err);\r\n    } finally {\r\n      setDeleteLoading(false);\r\n      setDeleteId(null);\r\n    }\r\n  }\r\n\r\n  function getCurrentColumns(): any[] {\r\n    return [];\r\n  }\r\n  const handleExportExcel = () => {\r\n    const columns = getCurrentColumns();\r\n    const headers = columns\r\n      .filter((col) => col.header && col.header !== 'Actions' && col.header !== 'Delete')\r\n      .map((col) => (typeof col.header === 'function' ? col.header({}) : col.header));\r\n    const exportableCols = columns.filter(\r\n      (col) => col.header && col.header !== 'Actions' && col.header !== 'Delete'\r\n    );\r\n    const rows = paginatedData.map((row, idx) =>\r\n      exportableCols.map((col) => {\r\n        if (col.id === 'number') return idx + 1;\r\n        return row[col.id || col.accessorKey] ?? '';\r\n      })\r\n    );\r\n    const ws = XLSX.utils.aoa_to_sheet([headers, ...rows]);\r\n    const wb = XLSX.utils.book_new();\r\n    XLSX.utils.book_append_sheet(wb, ws, 'Sheet1');\r\n    XLSX.writeFile(wb, 'table.xlsx');\r\n  };\r\n  const handleDownloadPDFButton = () => {\r\n    const columns = getCurrentColumns();\r\n    const columnOptions: ColumnOption[] = columns\r\n      .filter((col) => col.header && col.header !== 'Actions' && col.header !== 'Delete')\r\n      .map((col) => ({\r\n        id: col.id || col.accessorKey,\r\n        label: typeof col.header === 'function' ? col.header({}) : col.header,\r\n      }));\r\n    setDownloadColumns(columnOptions);\r\n    setPendingDownloadData(paginatedData);\r\n    setDownloadModalOpen(true);\r\n  };\r\n\r\n  function handleAddNew() {\r\n    setHideControls(true);\r\n    setEditRecord({});\r\n    setViewRecord(null);\r\n  }\r\n\r\n  function renderSection() {\r\n    if (viewRecord) {\r\n      switch (activeSection) {\r\n        case 'messages':\r\n          return (\r\n            <MessageView\r\n              data={viewRecord}\r\n              onClose={handleCloseView}\r\n              onRespond={handleRespondToMessage}\r\n            />\r\n          );\r\n        case 'responses':\r\n          return <ResponseView data={viewRecord} onClose={handleCloseView} />;\r\n        case 'beneficiaries':\r\n          return <BeneficiaryView data={viewRecord} onClose={handleCloseView} />;\r\n        default:\r\n          return null;\r\n      }\r\n    }\r\n\r\n    if (editRecord) {\r\n      switch (activeSection) {\r\n        case 'beneficiaries':\r\n          return (\r\n            <CreateBeneficiaryForm\r\n              initialData={editRecord}\r\n              onSuccess={handleSaveEdit}\r\n              onCancel={handleCancelEdit}\r\n              mode={editRecord?.id ? 'edit' : 'create'}\r\n            />\r\n          );\r\n        case 'messages':\r\n          return (\r\n            <CreateMessageForm\r\n              initialValues={editRecord}\r\n              onSuccess={handleSaveEdit}\r\n              onCancel={handleCancelEdit}\r\n            />\r\n          );\r\n        case 'responses':\r\n          return (\r\n            <CreateResponseForm\r\n              messageId={editRecord?.messageId}\r\n              editId={editRecord?.id}\r\n              initialData={editRecord?.id ? editRecord : undefined}\r\n              onSuccess={handleSaveEdit}\r\n              onCancel={handleCancelEdit}\r\n            />\r\n          );\r\n        default:\r\n          return null;\r\n      }\r\n    }\r\n\r\n    switch (activeSection) {\r\n      case 'beneficiaries':\r\n        return (\r\n          <BeneficiariesSection\r\n            paginatedData={paginatedData}\r\n            page={page}\r\n            rowsPerPage={rowsPerPage}\r\n            handleEdit={handleEdit}\r\n            handleView={(r: any) => handleView(r, 'beneficiaries')}\r\n            handleDelete={handleDelete}\r\n            messagesCountMap={{}}\r\n            requestsCountMap={{}}\r\n            currentUserRole={(session?.user as any)?.role ?? ''}\r\n            TableActions={() => null}\r\n            onAddMessage={(id: string) => {\r\n              // open create message modal bound to beneficiary\r\n              setHideControls(true);\r\n              setEditRecord({ beneficiaryId: id });\r\n            }}\r\n            onAddRequest={() => {}}\r\n            deleteId={deleteId}\r\n            deleteLoading={deleteLoading}\r\n          />\r\n        );\r\n      case 'messages':\r\n        return (\r\n          <MessagesSection\r\n            paginatedData={paginatedData}\r\n            page={page}\r\n            rowsPerPage={rowsPerPage}\r\n            handleEdit={handleEdit}\r\n            handleView={(r: any) => handleView(r, 'messages')}\r\n            handleDelete={handleDelete}\r\n            onRespond={handleRespondToMessage}\r\n            currentUserRole={(session?.user as any)?.role ?? ''}\r\n            TableActions={() => null}\r\n            deleteId={deleteId}\r\n            deleteLoading={deleteLoading}\r\n          />\r\n        );\r\n      case 'responses':\r\n        return (\r\n          <ResponsesSection\r\n            paginatedData={paginatedData}\r\n            page={page}\r\n            rowsPerPage={rowsPerPage}\r\n            handleEdit={handleEdit}\r\n            handleView={(r: any) => handleView(r, 'responses')}\r\n            handleDelete={handleDelete}\r\n            TableActions={() => null}\r\n            deleteId={deleteId}\r\n            deleteLoading={deleteLoading}\r\n          />\r\n        );\r\n      default:\r\n        return null;\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex h-screen bg-gray-50 dark:bg-gray-900 transition-colors\">\r\n      {/* Sidebar */}\r\n      <aside\r\n        className={`transition-all duration-300 bg-white dark:bg-gray-950 border-r dark:border-gray-800 shadow-sm h-full ${\r\n          sidebarCollapsed ? 'w-16' : 'w-60'\r\n        } flex flex-col`}\r\n      >\r\n        <div className=\"flex items-center justify-between px-2 py-4 border-b dark:border-gray-800\">\r\n          <span className=\"text-xl font-bold text-pink-600 dark:text-pink-400 hidden sm:block\">\r\n            {!sidebarCollapsed && 'Dashboard'}\r\n          </span>\r\n          <button\r\n            className=\"ml-auto p-2 text-gray-700 dark:text-gray-300 hover:text-pink-600 dark:hover:text-pink-400\"\r\n            onClick={() => setSidebarCollapsed((c) => !c)}\r\n            aria-label={sidebarCollapsed ? 'Expand sidebar' : 'Collapse sidebar'}\r\n          >\r\n            {sidebarCollapsed ? <FaAngleRight size={18} /> : <FaAngleLeft size={18} />}\r\n          </button>\r\n        </div>\r\n        <nav className=\"mt-2 flex-1 overflow-y-auto\">\r\n          {sections.map((section) => (\r\n            <button\r\n              key={section}\r\n              onClick={() => handleMenuClick(section)}\r\n              className={`w-full flex items-center gap-3 px-2 py-2 rounded transition-all font-medium\r\n                ${\r\n                  activeSection === section\r\n                    ? 'bg-pink-100 dark:bg-pink-950 text-pink-600 dark:text-pink-400'\r\n                    : 'text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-900 hover:text-pink-700 dark:hover:text-pink-400'\r\n                }\r\n              `}\r\n              style={{ minWidth: 0 }}\r\n            >\r\n              <span className=\"text-lg\">{sectionIcons[section]}</span>\r\n              {!sidebarCollapsed && <span className=\"truncate\">{sectionLabels[section]}</span>}\r\n            </button>\r\n          ))}\r\n        </nav>\r\n      </aside>\r\n\r\n      {/* Main Content */}\r\n      <main className=\"flex-1 min-w-0 overflow-y-auto p-4 bg-white dark:bg-gray-900 transition-colors\">\r\n        {/* Top bar */}\r\n        <div className=\"flex items-center gap-2 mb-8\">\r\n          <span className=\"text-2xl\">{sectionIcons[activeSection]}</span>\r\n          <span className=\"text-xl font-bold text-gray-700 dark:text-gray-100\">\r\n            {sectionLabels[activeSection]}\r\n          </span>\r\n        </div>\r\n\r\n        {/* Controls */}\r\n        {!hideControls && (\r\n          <TableControls\r\n            search={search}\r\n            setSearch={setSearch}\r\n            onAddNew={handleAddNew}\r\n            exportExcel={handleExportExcel}\r\n            downloadPDF={handleDownloadPDFButton}\r\n            activeSection={activeSection}\r\n            sectionLabels={sectionLabels}\r\n            hideSearch={false}\r\n            addNewLabel={`Add New ${sectionLabels[activeSection]}`}\r\n          />\r\n        )}\r\n\r\n        {/* Section Content */}\r\n        <div className=\"w-full flex flex-col\">\r\n          {activeSection && <div className=\"mt-2 w-full\">{renderSection()}</div>}\r\n        </div>\r\n\r\n        {/* Pagination */}\r\n        {pageCount > 1 && !hideControls && (\r\n          <div className=\"flex gap-2 mt-4 justify-end items-center\">\r\n            <button\r\n              className=\"px-2 py-1 rounded border dark:border-gray-700 dark:bg-gray-950 dark:text-gray-100\"\r\n              disabled={page === 1}\r\n              onClick={() => setPage(page - 1)}\r\n            >\r\n              Prev\r\n            </button>\r\n            <span className=\"dark:text-gray-100\">\r\n              Page {page} of {pageCount}\r\n            </span>\r\n            <button\r\n              className=\"px-2 py-1 rounded border dark:border-gray-700 dark:bg-gray-950 dark:text-gray-100\"\r\n              disabled={page === pageCount}\r\n              onClick={() => setPage(page + 1)}\r\n            >\r\n              Next\r\n            </button>\r\n          </div>\r\n        )}\r\n\r\n        {/* Download Modal */}\r\n        <DownloadColumnsModal\r\n          isOpen={downloadModalOpen}\r\n          onClose={() => setDownloadModalOpen(false)}\r\n          columns={downloadColumns}\r\n          onDownload={(selectedColumns) => {\r\n            handleDownloadPDF(\r\n              pendingDownloadData,\r\n              selectedColumns,\r\n              activeSection\r\n                ? activeSection.charAt(0).toUpperCase() + activeSection.slice(1)\r\n                : 'Data'\r\n            );\r\n          }}\r\n        />\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}