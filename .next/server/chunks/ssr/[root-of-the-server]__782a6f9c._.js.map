{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/downloadColumnsModal.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { DndContext, closestCenter, PointerSensor, useSensor, useSensors } from '@dnd-kit/core';\r\nimport {\r\n  SortableContext,\r\n  useSortable,\r\n  verticalListSortingStrategy,\r\n  arrayMove,\r\n} from '@dnd-kit/sortable';\r\nimport { CSS } from '@dnd-kit/utilities';\r\n\r\nexport interface ColumnOption {\r\n  id: string;\r\n  label: string;\r\n}\r\n\r\ninterface DownloadColumnsModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  columns: ColumnOption[];\r\n  onDownload: (selectedColumns: ColumnOption[]) => void;\r\n  defaultSelected?: string[];\r\n}\r\n\r\nexport default function DownloadColumnsModal({\r\n  isOpen,\r\n  onClose,\r\n  columns,\r\n  onDownload,\r\n  defaultSelected = [],\r\n}: DownloadColumnsModalProps) {\r\n  const [available, setAvailable] = useState<ColumnOption[]>([]);\r\n  const [selected, setSelected] = useState<ColumnOption[]>([]);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      setAvailable(columns.filter((c) => !defaultSelected.includes(c.id)));\r\n      setSelected(columns.filter((c) => defaultSelected.includes(c.id)));\r\n    }\r\n  }, [isOpen]); // Only reset when modal opens\r\n\r\n  const sensors = useSensors(\r\n    useSensor(PointerSensor, {\r\n      activationConstraint: { distance: 5 },\r\n    })\r\n  );\r\n\r\n  function handleDragEnd(event: any) {\r\n    const { active, over } = event;\r\n\r\n    // Reordering in selected\r\n    if (\r\n      active &&\r\n      over &&\r\n      selected.find((c) => c.id === active.id) &&\r\n      selected.find((c) => c.id === over.id) &&\r\n      active.id !== over.id\r\n    ) {\r\n      setSelected((items) => {\r\n        const oldIndex = items.findIndex((i) => i.id === active.id);\r\n        const newIndex = items.findIndex((i) => i.id === over.id);\r\n        return arrayMove(items, oldIndex, newIndex);\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Drag from available to selected area\r\n    if (\r\n      active &&\r\n      over &&\r\n      available.find((c) => c.id === active.id) &&\r\n      over.id === 'selected-drop-area'\r\n    ) {\r\n      const col = available.find((c) => c.id === active.id)!;\r\n      setAvailable((prev) => prev.filter((c) => c.id !== col.id));\r\n      setSelected((prev) => [...prev, col]);\r\n    }\r\n  }\r\n\r\n  function handleAdd(col: ColumnOption) {\r\n    setAvailable((prev) => prev.filter((c) => c.id !== col.id));\r\n    setSelected((prev) => [...prev, col]);\r\n  }\r\n\r\n  function handleRemove(col: ColumnOption) {\r\n    setSelected((prev) => prev.filter((c) => c.id !== col.id));\r\n    setAvailable((prev) => [...prev, col]);\r\n  }\r\n\r\n  // PDF Export Helper: handles serial number and date formatting\r\n  function handleDownload() {\r\n    onDownload(selected);\r\n    onClose();\r\n  }\r\n\r\n  return (\r\n    <Dialog\r\n      open={isOpen}\r\n      onClose={onClose}\r\n      className=\"fixed inset-0 z-50 flex items-center justify-center\"\r\n    >\r\n      <div className=\"fixed inset-0 bg-black/30 dark:bg-black/70\" aria-hidden=\"true\" />\r\n      <div className=\"relative bg-white dark:bg-gray-900 rounded-lg shadow-lg w-full max-w-2xl mx-auto p-6 z-10\">\r\n        <Dialog.Title className=\"text-lg font-bold mb-2 dark:text-white\">\r\n          Select & Order Columns\r\n        </Dialog.Title>\r\n        <div className=\"flex gap-6\">\r\n          {/* Available Columns */}\r\n          <div className=\"w-1/2\">\r\n            <div className=\"font-semibold mb-2 dark:text-gray-200\">All Columns</div>\r\n            <DndContext\r\n              sensors={sensors}\r\n              collisionDetection={closestCenter}\r\n              onDragEnd={handleDragEnd}\r\n            >\r\n              <ul className=\"border rounded p-2 min-h-[200px] bg-gray-50 dark:bg-gray-800\">\r\n                {available.map((col) => (\r\n                  <DraggableColumnItem\r\n                    key={col.id}\r\n                    id={col.id}\r\n                    label={col.label}\r\n                    onAdd={() => handleAdd(col)}\r\n                  />\r\n                ))}\r\n                {available.length === 0 && (\r\n                  <li className=\"text-gray-400 dark:text-gray-500 text-sm\">All columns selected</li>\r\n                )}\r\n              </ul>\r\n            </DndContext>\r\n          </div>\r\n          {/* Selected Columns (drag to reorder, droppable area) */}\r\n          <div className=\"w-1/2\">\r\n            <div className=\"font-semibold mb-2 dark:text-gray-200\">\r\n              To Download (drag to reorder)\r\n            </div>\r\n            <DndContext\r\n              sensors={sensors}\r\n              collisionDetection={closestCenter}\r\n              onDragEnd={handleDragEnd}\r\n            >\r\n              <SortableContext\r\n                items={selected.map((c) => c.id)}\r\n                strategy={verticalListSortingStrategy}\r\n              >\r\n                <ul\r\n                  id=\"selected-drop-area\"\r\n                  className=\"border rounded p-2 min-h-[200px] bg-gray-50 dark:bg-gray-800\"\r\n                >\r\n                  {selected.map((col) => (\r\n                    <SortableColumnItem\r\n                      key={col.id}\r\n                      id={col.id}\r\n                      label={col.label}\r\n                      onRemove={() => handleRemove(col)}\r\n                    />\r\n                  ))}\r\n                  {selected.length === 0 && (\r\n                    <li className=\"text-gray-400 dark:text-gray-500 text-sm\">\r\n                      No columns selected\r\n                    </li>\r\n                  )}\r\n                </ul>\r\n              </SortableContext>\r\n            </DndContext>\r\n          </div>\r\n        </div>\r\n        <div className=\"flex justify-end mt-6 gap-2\">\r\n          <button\r\n            className=\"px-4 py-2 bg-gray-200 dark:bg-gray-700 dark:text-gray-100 rounded\"\r\n            onClick={onClose}\r\n          >\r\n            Cancel\r\n          </button>\r\n          <button\r\n            className=\"px-4 py-2 bg-blue-600 dark:bg-blue-700 text-white rounded disabled:opacity-50\"\r\n            disabled={selected.length === 0}\r\n            onClick={handleDownload}\r\n          >\r\n            Download PDF\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\n// Draggable item for available columns (left)\r\nfunction DraggableColumnItem({\r\n  id,\r\n  label,\r\n  onAdd,\r\n}: {\r\n  id: string;\r\n  label: string;\r\n  onAdd: () => void;\r\n}) {\r\n  const { attributes, listeners, setNodeRef, transform, transition, isDragging } = useSortable({\r\n    id,\r\n  });\r\n  return (\r\n    <li\r\n      ref={setNodeRef}\r\n      style={{\r\n        transform: CSS.Transform.toString(transform),\r\n        transition,\r\n        opacity: isDragging ? 0.5 : 1,\r\n      }}\r\n      className=\"flex items-center gap-2 bg-white dark:bg-gray-900 border-b last:border-b-0 border-gray-100 dark:border-gray-800 py-1 px-2 rounded cursor-pointer group\"\r\n      {...attributes}\r\n      {...listeners}\r\n      tabIndex={0}\r\n      onClick={onAdd}\r\n      title=\"Add to Download\"\r\n    >\r\n      <span\r\n        className=\"cursor-move text-gray-400 dark:text-gray-500 select-none\"\r\n        aria-label=\"Drag to select column\"\r\n        title=\"Drag to select column\"\r\n      >\r\n        ☰\r\n      </span>\r\n      <span className=\"flex-1 dark:text-gray-100\">{label}</span>\r\n    </li>\r\n  );\r\n}\r\n\r\n// Draggable/sortable item for selected columns (right)\r\nfunction SortableColumnItem({\r\n  id,\r\n  label,\r\n  onRemove,\r\n}: {\r\n  id: string;\r\n  label: string;\r\n  onRemove: () => void;\r\n}) {\r\n  const { attributes, listeners, setNodeRef, transform, transition, isDragging } = useSortable({\r\n    id,\r\n  });\r\n  return (\r\n    <li\r\n      ref={setNodeRef}\r\n      style={{\r\n        transform: CSS.Transform.toString(transform),\r\n        transition,\r\n        opacity: isDragging ? 0.5 : 1,\r\n      }}\r\n      className=\"flex items-center gap-2 bg-white dark:bg-gray-900 border-b last:border-b-0 border-gray-100 dark:border-gray-800 py-1 px-2 rounded cursor-move group\"\r\n      {...attributes}\r\n      {...listeners}\r\n    >\r\n      <span\r\n        className=\"cursor-move text-gray-400 dark:text-gray-500 select-none\"\r\n        aria-label=\"Drag to reorder\"\r\n        title=\"Drag to reorder\"\r\n      >\r\n        ☰\r\n      </span>\r\n      <span className=\"flex-1 dark:text-gray-100\">{label}</span>\r\n      <button\r\n        onClick={onRemove}\r\n        className=\"ml-auto text-gray-400 hover:text-red-500 dark:hover:text-red-400\"\r\n        title=\"Remove\"\r\n        type=\"button\"\r\n      >\r\n        ✕\r\n      </button>\r\n    </li>\r\n  );\r\n}\r\n// This code defines a modal component for selecting and ordering columns to download as a PDF.\r\n// It uses DnD Kit for drag-and-drop functionality, allowing users to reorder selected columns"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 376, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/handleDownloadPDF.ts"],"sourcesContent":["import jsPDF from 'jspdf';\r\nimport autoTable from 'jspdf-autotable';\r\nimport { ColumnOption } from './downloadColumnsModal';\r\n\r\n// Update with your correct logo path\r\nconst LOGO_URL = '/assets/images/system/goGirlsLogoV2.png';\r\nconst HEADER_BG_COLOR = '#9f004d';\r\nconst FOOTER_BG_COLOR = '#9f004d';\r\nconst HEADER_HEIGHT = 28; // in jsPDF units (about 7mm)\r\nconst FOOTER_HEIGHT = 20;\r\n\r\nconst dateFields = ['createdAt', 'updatedAt', 'date', 'dateOfBirth'];\r\n\r\n// Helper for Day.Month.Year format (e.g. 12.07.2025)\r\nfunction getCurrentDayMonthYear() {\r\n  const now = new Date();\r\n  const day = String(now.getDate()).padStart(2, '0');\r\n  const month = String(now.getMonth() + 1).padStart(2, '0');\r\n  const year = now.getFullYear();\r\n  return `${day}.${month}.${year}`;\r\n}\r\n\r\nexport async function handleDownloadPDF(data: any[], columns: ColumnOption[], cardName: string) {\r\n  const doc = new jsPDF({ orientation: 'landscape' });\r\n  const pageWidth = doc.internal.pageSize.getWidth();\r\n  const pageHeight = doc.internal.pageSize.getHeight();\r\n\r\n  // Load logo as base64\r\n  const logoImg = await fetch(LOGO_URL)\r\n    .then((r) => r.blob())\r\n    .then(\r\n      (blob) =>\r\n        new Promise<string>((resolve) => {\r\n          const reader = new FileReader();\r\n          reader.onloadend = () => resolve(reader.result as string);\r\n          reader.readAsDataURL(blob);\r\n        })\r\n    );\r\n\r\n  // ----- HEADER -----\r\n  // Draw header background\r\n  doc.setFillColor(HEADER_BG_COLOR);\r\n  doc.rect(0, 0, pageWidth, HEADER_HEIGHT, 'F');\r\n\r\n  // Vertically center everything in the header\r\n  const centerY = HEADER_HEIGHT / 2 + 1; // small correction for optical centering\r\n\r\n  // Logo (vertically centered)\r\n  const logoHeight = 18;\r\n  const logoWidth = 18;\r\n  const logoY = centerY - logoHeight / 2;\r\n  doc.addImage(logoImg, 'PNG', 10, logoY, logoWidth, logoHeight);\r\n\r\n  // \"GoGirls ICT Initiative\" (white, bold, large)\r\n  doc.setFontSize(22);\r\n  doc.setTextColor('#FFFFFF');\r\n  doc.setFont('helvetica', 'bold');\r\n  const orgName = 'GoGirls ICT Initiative';\r\n  const orgNameX = 10 + logoWidth + 10; // logo + spacing\r\n  doc.text(orgName, orgNameX, centerY, { baseline: 'middle' });\r\n\r\n  // Card Name (black, bold, large, right-aligned, same line)\r\n  doc.setFontSize(22);\r\n  doc.setTextColor('#000000');\r\n  doc.setFont('helvetica', 'bold');\r\n  const cardTextWidth = doc.getTextWidth(cardName);\r\n  doc.text(cardName, pageWidth - 10 - cardTextWidth, centerY, { baseline: 'middle' });\r\n\r\n  // ----- TABLE -----\r\n  const headers = columns.map((col) => col.label);\r\n  const rows = data.map((row, idx) =>\r\n    columns.map((col) => {\r\n      if (col.id === 'number') return idx + 1;\r\n      if (dateFields.includes(col.id) && row[col.id]) {\r\n        // Format all dates as Day.Month.Year\r\n        const d = new Date(row[col.id]);\r\n        return `${String(d.getDate()).padStart(2, '0')}.${String(d.getMonth() + 1).padStart(\r\n          2,\r\n          '0'\r\n        )}.${d.getFullYear()}`;\r\n      }\r\n      return row[col.id] ?? '';\r\n    })\r\n  );\r\n\r\n  autoTable(doc, {\r\n    head: [headers],\r\n    body: rows,\r\n    startY: HEADER_HEIGHT + 6,\r\n    margin: { left: 10, right: 10 },\r\n    didDrawPage: function (data) {\r\n      // ----- FOOTER -----\r\n      // Draw footer background\r\n      doc.setFillColor(FOOTER_BG_COLOR);\r\n      doc.rect(0, pageHeight - FOOTER_HEIGHT, pageWidth, FOOTER_HEIGHT, 'F');\r\n\r\n      // Footer content: copyright, day.month.year, org name, centered\r\n      doc.setFontSize(13);\r\n      doc.setTextColor('#FFFFFF');\r\n      doc.setFont('helvetica', 'bold');\r\n      const dayMonthYear = getCurrentDayMonthYear();\r\n      const footerText = `System-Generated on ${dayMonthYear} ©GoGirls ICT Initiative`;\r\n      const textWidth = doc.getTextWidth(footerText);\r\n      const centerX = pageWidth / 2;\r\n      const footerY = pageHeight - FOOTER_HEIGHT / 2 + 1; // optical center\r\n      doc.text(footerText, centerX - textWidth / 2, footerY, { baseline: 'middle' });\r\n    },\r\n  });\r\n\r\n  doc.save('table.pdf');\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 491, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/components/ui/table.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Table({ className, ...props }: React.ComponentProps<\"table\">) {\n  return (\n    <div\n      data-slot=\"table-container\"\n      className=\"relative w-full overflow-x-auto\"\n    >\n      <table\n        data-slot=\"table\"\n        className={cn(\"w-full caption-bottom text-sm\", className)}\n        {...props}\n      />\n    </div>\n  )\n}\n\nfunction TableHeader({ className, ...props }: React.ComponentProps<\"thead\">) {\n  return (\n    <thead\n      data-slot=\"table-header\"\n      className={cn(\"[&_tr]:border-b\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction TableBody({ className, ...props }: React.ComponentProps<\"tbody\">) {\n  return (\n    <tbody\n      data-slot=\"table-body\"\n      className={cn(\"[&_tr:last-child]:border-0\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction TableFooter({ className, ...props }: React.ComponentProps<\"tfoot\">) {\n  return (\n    <tfoot\n      data-slot=\"table-footer\"\n      className={cn(\n        \"bg-muted/50 border-t font-medium [&>tr]:last:border-b-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableRow({ className, ...props }: React.ComponentProps<\"tr\">) {\n  return (\n    <tr\n      data-slot=\"table-row\"\n      className={cn(\n        \"hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableHead({ className, ...props }: React.ComponentProps<\"th\">) {\n  return (\n    <th\n      data-slot=\"table-head\"\n      className={cn(\n        \"text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableCell({ className, ...props }: React.ComponentProps<\"td\">) {\n  return (\n    <td\n      data-slot=\"table-cell\"\n      className={cn(\n        \"p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableCaption({\n  className,\n  ...props\n}: React.ComponentProps<\"caption\">) {\n  return (\n    <caption\n      data-slot=\"table-caption\"\n      className={cn(\"text-muted-foreground mt-4 text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n"],"names":[],"mappings":";;;;;;;;;;;AAIA;AAJA;;;AAMA,SAAS,MAAM,EAAE,SAAS,EAAE,GAAG,OAAsC;IACnE,qBACE,8OAAC;QACC,aAAU;QACV,WAAU;kBAEV,cAAA,8OAAC;YACC,aAAU;YACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;YAC9C,GAAG,KAAK;;;;;;;;;;;AAIjB;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAsC;IACzE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EAAE,mBAAmB;QAChC,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAsC;IACvE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EAAE,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAsC;IACzE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EACV,2DACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,SAAS,EAAE,SAAS,EAAE,GAAG,OAAmC;IACnE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EACV,+EACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAmC;IACpE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EACV,sJACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAmC;IACpE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EACV,0GACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,aAAa,EACpB,SAAS,EACT,GAAG,OAC6B;IAChC,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EAAE,sCAAsC;QACnD,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 609, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/data-table/data-table/data-table.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { ColumnDef, flexRender, getCoreRowModel, useReactTable } from '@tanstack/react-table';\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from '@/components/ui/table';\r\nimport React from 'react';\r\nimport '@/assets/styles/resizer.css'; // Import the CSS file for the resizer\r\n\r\ninterface DataTableProps<TData, TValue> {\r\n  columns: ColumnDef<TData, TValue>[];\r\n  data: TData[];\r\n}\r\n\r\nexport function DataTable<TData, TValue>({ columns, data }: DataTableProps<TData, TValue>) {\r\n  const table = useReactTable({\r\n    data,\r\n    columns,\r\n    getCoreRowModel: getCoreRowModel(),\r\n    enableColumnResizing: true,\r\n    columnResizeMode: 'onChange', // or \"onEnd\"\r\n  });\r\n\r\n  return (\r\n    <div className=\"rounded-md border mt-6 overflow-x-auto\">\r\n      <Table>\r\n        <TableHeader>\r\n          {table.getHeaderGroups().map((headerGroup) => (\r\n            <TableRow key={headerGroup.id}>\r\n              {headerGroup.headers.map((header) => (\r\n                <TableHead\r\n                  key={header.id}\r\n                  style={{\r\n                    position: 'relative',\r\n                    width: header.getSize(),\r\n                    minWidth: header.column.columnDef.minSize ?? 40,\r\n                    maxWidth: header.column.columnDef.maxSize ?? 1000,\r\n                  }}\r\n                >\r\n                  {flexRender(header.column.columnDef.header, header.getContext())}\r\n                  {header.column.getCanResize() && (\r\n                    <div\r\n                      onMouseDown={header.getResizeHandler()}\r\n                      onTouchStart={header.getResizeHandler()}\r\n                      className=\"resizer\"\r\n                    />\r\n                  )}\r\n                </TableHead>\r\n              ))}\r\n            </TableRow>\r\n          ))}\r\n        </TableHeader>\r\n        <TableBody>\r\n          {table.getRowModel().rows.map((row) => (\r\n            <TableRow\r\n              key={row.id}\r\n              className=\"hover:bg-gray-100 dark:hover:bg-neutral-800 transition-colors\"\r\n            >\r\n              {row.getVisibleCells().map((cell) => (\r\n                <TableCell\r\n                  key={cell.id}\r\n                  style={{\r\n                    width: cell.column.getSize(),\r\n                    minWidth: cell.column.columnDef.minSize ?? 40,\r\n                    maxWidth: cell.column.columnDef.maxSize ?? 1000,\r\n                  }}\r\n                >\r\n                  {flexRender(cell.column.columnDef.cell, cell.getContext())}\r\n                </TableCell>\r\n              ))}\r\n            </TableRow>\r\n          ))}\r\n        </TableBody>\r\n      </Table>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AAAA;AACA;AAHA;;;;;AAmBO,SAAS,UAAyB,EAAE,OAAO,EAAE,IAAI,EAAiC;IACvF,MAAM,QAAQ,CAAA,GAAA,sLAAA,CAAA,gBAAa,AAAD,EAAE;QAC1B;QACA;QACA,iBAAiB,CAAA,GAAA,qKAAA,CAAA,kBAAe,AAAD;QAC/B,sBAAsB;QACtB,kBAAkB;IACpB;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC,0HAAA,CAAA,QAAK;;8BACJ,8OAAC,0HAAA,CAAA,cAAW;8BACT,MAAM,eAAe,GAAG,GAAG,CAAC,CAAC,4BAC5B,8OAAC,0HAAA,CAAA,WAAQ;sCACN,YAAY,OAAO,CAAC,GAAG,CAAC,CAAC,uBACxB,8OAAC,0HAAA,CAAA,YAAS;oCAER,OAAO;wCACL,UAAU;wCACV,OAAO,OAAO,OAAO;wCACrB,UAAU,OAAO,MAAM,CAAC,SAAS,CAAC,OAAO,IAAI;wCAC7C,UAAU,OAAO,MAAM,CAAC,SAAS,CAAC,OAAO,IAAI;oCAC/C;;wCAEC,CAAA,GAAA,sLAAA,CAAA,aAAU,AAAD,EAAE,OAAO,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE,OAAO,UAAU;wCAC5D,OAAO,MAAM,CAAC,YAAY,oBACzB,8OAAC;4CACC,aAAa,OAAO,gBAAgB;4CACpC,cAAc,OAAO,gBAAgB;4CACrC,WAAU;;;;;;;mCAbT,OAAO,EAAE;;;;;2BAHL,YAAY,EAAE;;;;;;;;;;8BAwBjC,8OAAC,0HAAA,CAAA,YAAS;8BACP,MAAM,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,oBAC7B,8OAAC,0HAAA,CAAA,WAAQ;4BAEP,WAAU;sCAET,IAAI,eAAe,GAAG,GAAG,CAAC,CAAC,qBAC1B,8OAAC,0HAAA,CAAA,YAAS;oCAER,OAAO;wCACL,OAAO,KAAK,MAAM,CAAC,OAAO;wCAC1B,UAAU,KAAK,MAAM,CAAC,SAAS,CAAC,OAAO,IAAI;wCAC3C,UAAU,KAAK,MAAM,CAAC,SAAS,CAAC,OAAO,IAAI;oCAC7C;8CAEC,CAAA,GAAA,sLAAA,CAAA,aAAU,AAAD,EAAE,KAAK,MAAM,CAAC,SAAS,CAAC,IAAI,EAAE,KAAK,UAAU;mCAPlD,KAAK,EAAE;;;;;2BALX,IAAI,EAAE;;;;;;;;;;;;;;;;;;;;;AAqBzB","debugId":null}},
    {"offset": {"line": 712, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/data-table/columns/beneficiaries.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { ColumnDef } from '@tanstack/react-table';\r\nimport { Beneficiary } from '@/lib/generated/prisma';\r\nimport { Button } from '@/components/ui/button';\r\n\r\ntype BeneficiaryWithRelations = Beneficiary & {\r\n  createdBy?: {\r\n    firstName: string;\r\n    lastName: string;\r\n  };\r\n  institution?: {\r\n    id: string;\r\n    name: string;\r\n  };\r\n  beneficiaryMessages?: { id: string; title?: string }[];\r\n  messagesCount?: number; // server-provided (various names used across APIs)\r\n  messageCount?: number;\r\n  messages?: any[]; // sometimes relations are present\r\n  _count?: { messages?: number }; // Prisma _count shape\r\n  responsesCount?: number; // server-provided\r\n  responseCount?: number;\r\n  responses?: any[];\r\n};\r\n\r\ntype Opts = {\r\n  onEdit: (beneficiary: BeneficiaryWithRelations) => void;\r\n  onView: (beneficiary: BeneficiaryWithRelations) => void;\r\n  onDelete?: (beneficiaryId: string) => void;\r\n  onAddMessage?: (beneficiaryId: string) => void;\r\n  onMessageIdClick?: (msgId: string) => void;\r\n  messagesCountMap?: Record<string, number>;\r\n  responsesCountMap?: Record<string, number>;\r\n  currentUserRole?: string;\r\n};\r\n\r\nfunction numericOrUndefined(v: unknown): number | undefined {\r\n  if (typeof v === 'number' && !Number.isNaN(v)) return v;\r\n  if (typeof v === 'string' && v.trim() !== '' && !Number.isNaN(Number(v))) return Number(v);\r\n  return undefined;\r\n}\r\n\r\nexport function beneficiaryColumns({\r\n  onEdit,\r\n  onView,\r\n  onDelete,\r\n  onAddMessage,\r\n  onMessageIdClick,\r\n  messagesCountMap,\r\n  responsesCountMap,\r\n  currentUserRole,\r\n}: Opts): ColumnDef<BeneficiaryWithRelations>[] {\r\n  const cols: ColumnDef<BeneficiaryWithRelations>[] = [\r\n    {\r\n      accessorKey: 'firstName',\r\n      header: 'First Name',\r\n      cell: ({ row }) => (\r\n        <div className=\"whitespace-normal break-words max-w-xs\">{row.getValue('firstName')}</div>\r\n      ),\r\n    },\r\n    {\r\n      accessorKey: 'lastName',\r\n      header: 'Last Name',\r\n      cell: ({ row }) => (\r\n        <div className=\"whitespace-normal break-words max-w-xs\">{row.getValue('lastName')}</div>\r\n      ),\r\n    },\r\n\r\n    {\r\n      id: 'messagesCount',\r\n      header: 'Messages',\r\n      cell: ({ row }) => {\r\n        const id = row.original.id as string | undefined;\r\n\r\n        // Try a bunch of server-provided locations (to be resilient to different API shapes)\r\n        const serverCandidates = [\r\n          row.original.messageCount,\r\n          row.original.messagesCount,\r\n          row.original._count?.messages,\r\n          numericOrUndefined(row.original._count?.messages),\r\n          numericOrUndefined(row.original.messageCount),\r\n          numericOrUndefined(row.original.messagesCount),\r\n          // sometimes the API returns the relation array\r\n          Array.isArray(row.original.beneficiaryMessages)\r\n            ? row.original.beneficiaryMessages.length\r\n            : undefined,\r\n          Array.isArray(row.original.messages) ? row.original.messages.length : undefined,\r\n        ];\r\n\r\n        for (const cand of serverCandidates) {\r\n          if (typeof cand === 'number') return cand;\r\n          if (typeof cand === 'string' && cand !== '') {\r\n            const parsed = Number(cand);\r\n            if (!Number.isNaN(parsed)) return parsed;\r\n          }\r\n        }\r\n\r\n        // Fallback to the messagesCountMap passed down from parent (optimistic updates)\r\n        if (messagesCountMap && id) return messagesCountMap[id] ?? 0;\r\n\r\n        // Last resort: zero\r\n        return 0;\r\n      },\r\n    },\r\n    {\r\n      id: 'addMessage',\r\n      header: '',\r\n      cell: ({ row }) =>\r\n        onAddMessage ? (\r\n          <Button\r\n            type=\"button\"\r\n            size=\"sm\"\r\n            className=\"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 dark:hover:bg-green-800 text-xs\"\r\n            onClick={() => onAddMessage(row.original.id)}\r\n          >\r\n            Add Message\r\n          </Button>\r\n        ) : null,\r\n    },\r\n\r\n    {\r\n      id: 'responsesCount',\r\n      header: 'Responses',\r\n      cell: ({ row }) => {\r\n        const id = row.original.id as string | undefined;\r\n\r\n        const serverCandidates = [\r\n          row.original.responseCount,\r\n          row.original.responsesCount,\r\n          numericOrUndefined(row.original.responseCount),\r\n          numericOrUndefined(row.original.responsesCount),\r\n          Array.isArray(row.original.responses) ? row.original.responses.length : undefined,\r\n        ];\r\n        for (const cand of serverCandidates) {\r\n          if (typeof cand === 'number') return cand;\r\n          if (typeof cand === 'string' && cand !== '') {\r\n            const parsed = Number(cand);\r\n            if (!Number.isNaN(parsed)) return parsed;\r\n          }\r\n        }\r\n\r\n        if (responsesCountMap && id) return responsesCountMap[id] ?? 0;\r\n        return 0;\r\n      },\r\n    },\r\n\r\n    {\r\n      accessorKey: 'createdAt',\r\n      header: 'Created At',\r\n      cell: ({ row }) =>\r\n        row.getValue('createdAt')\r\n          ? new Date(row.getValue('createdAt') as string).toLocaleDateString()\r\n          : '',\r\n    },\r\n    {\r\n      accessorKey: 'updatedAt',\r\n      header: 'Updated At',\r\n      cell: ({ row }) =>\r\n        row.getValue('updatedAt')\r\n          ? new Date(row.getValue('updatedAt') as string).toLocaleDateString()\r\n          : '',\r\n    },\r\n\r\n    {\r\n      id: 'edit',\r\n      header: 'Edit',\r\n      cell: ({ row }) => (\r\n        <Button\r\n          type=\"button\"\r\n          size=\"sm\"\r\n          variant=\"outline\"\r\n          className=\"transition-colors duration-150 hover:bg-yellow-100 dark:hover:bg-yellow-800 hover:text-yellow-900 dark:hover:text-yellow-100\"\r\n          onClick={() => onEdit(row.original)}\r\n        >\r\n          Edit\r\n        </Button>\r\n      ),\r\n    },\r\n    {\r\n      id: 'view',\r\n      header: 'View',\r\n      cell: ({ row }) =>\r\n        onView ? (\r\n          <Button\r\n            type=\"button\"\r\n            size=\"sm\"\r\n            variant=\"outline\"\r\n            className=\"transition-colors duration-150 hover:bg-blue-100 dark:hover:bg-blue-800 hover:text-blue-900 dark:hover:text-blue-100\"\r\n            onClick={() => onView(row.original)}\r\n          >\r\n            View\r\n          </Button>\r\n        ) : null,\r\n    },\r\n  ];\r\n\r\n  if (onDelete && currentUserRole !== 'beneficiary') {\r\n    cols.push({\r\n      id: 'delete',\r\n      header: 'Delete',\r\n      cell: ({ row }) => (\r\n        <Button\r\n          type=\"button\"\r\n          size=\"sm\"\r\n          variant=\"destructive\"\r\n          className=\"transition-colors duration-150 hover:bg-red-600 dark:hover:bg-red-800 hover:text-white dark:hover:text-white\"\r\n          onClick={() => onDelete(row.original.id)}\r\n        >\r\n          Delete\r\n        </Button>\r\n      ),\r\n    });\r\n  }\r\n\r\n  return cols;\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 888, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/components/ui/dialog.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { XIcon } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Dialog({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Root>) {\n  return <DialogPrimitive.Root data-slot=\"dialog\" {...props} />\n}\n\nfunction DialogTrigger({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Trigger>) {\n  return <DialogPrimitive.Trigger data-slot=\"dialog-trigger\" {...props} />\n}\n\nfunction DialogPortal({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Portal>) {\n  return <DialogPrimitive.Portal data-slot=\"dialog-portal\" {...props} />\n}\n\nfunction DialogClose({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Close>) {\n  return <DialogPrimitive.Close data-slot=\"dialog-close\" {...props} />\n}\n\nfunction DialogOverlay({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Overlay>) {\n  return (\n    <DialogPrimitive.Overlay\n      data-slot=\"dialog-overlay\"\n      className={cn(\n        \"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DialogContent({\n  className,\n  children,\n  showCloseButton = true,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Content> & {\n  showCloseButton?: boolean\n}) {\n  return (\n    <DialogPortal data-slot=\"dialog-portal\">\n      <DialogOverlay />\n      <DialogPrimitive.Content\n        data-slot=\"dialog-content\"\n        className={cn(\n          \"bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n        {showCloseButton && (\n          <DialogPrimitive.Close\n            data-slot=\"dialog-close\"\n            className=\"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\"\n          >\n            <XIcon />\n            <span className=\"sr-only\">Close</span>\n          </DialogPrimitive.Close>\n        )}\n      </DialogPrimitive.Content>\n    </DialogPortal>\n  )\n}\n\nfunction DialogHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"dialog-header\"\n      className={cn(\"flex flex-col gap-2 text-center sm:text-left\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction DialogFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"dialog-footer\"\n      className={cn(\n        \"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DialogTitle({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Title>) {\n  return (\n    <DialogPrimitive.Title\n      data-slot=\"dialog-title\"\n      className={cn(\"text-lg leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction DialogDescription({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Description>) {\n  return (\n    <DialogPrimitive.Description\n      data-slot=\"dialog-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Dialog,\n  DialogClose,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogOverlay,\n  DialogPortal,\n  DialogTitle,\n  DialogTrigger,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;AAGA;AACA;AAEA;AANA;;;;;AAQA,SAAS,OAAO,EACd,GAAG,OAC+C;IAClD,qBAAO,8OAAC,kKAAA,CAAA,OAAoB;QAAC,aAAU;QAAU,GAAG,KAAK;;;;;;AAC3D;AAEA,SAAS,cAAc,EACrB,GAAG,OACkD;IACrD,qBAAO,8OAAC,kKAAA,CAAA,UAAuB;QAAC,aAAU;QAAkB,GAAG,KAAK;;;;;;AACtE;AAEA,SAAS,aAAa,EACpB,GAAG,OACiD;IACpD,qBAAO,8OAAC,kKAAA,CAAA,SAAsB;QAAC,aAAU;QAAiB,GAAG,KAAK;;;;;;AACpE;AAEA,SAAS,YAAY,EACnB,GAAG,OACgD;IACnD,qBAAO,8OAAC,kKAAA,CAAA,QAAqB;QAAC,aAAU;QAAgB,GAAG,KAAK;;;;;;AAClE;AAEA,SAAS,cAAc,EACrB,SAAS,EACT,GAAG,OACkD;IACrD,qBACE,8OAAC,kKAAA,CAAA,UAAuB;QACtB,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EACV,0JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,cAAc,EACrB,SAAS,EACT,QAAQ,EACR,kBAAkB,IAAI,EACtB,GAAG,OAGJ;IACC,qBACE,8OAAC;QAAa,aAAU;;0BACtB,8OAAC;;;;;0BACD,8OAAC,kKAAA,CAAA,UAAuB;gBACtB,aAAU;gBACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EACV,+WACA;gBAED,GAAG,KAAK;;oBAER;oBACA,iCACC,8OAAC,kKAAA,CAAA,QAAqB;wBACpB,aAAU;wBACV,WAAU;;0CAEV,8OAAC,gMAAA,CAAA,QAAK;;;;;0CACN,8OAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;;;;;;;;;;;;;AAMtC;AAEA,SAAS,aAAa,EAAE,SAAS,EAAE,GAAG,OAAoC;IACxE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EAAE,gDAAgD;QAC7D,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,aAAa,EAAE,SAAS,EAAE,GAAG,OAAoC;IACxE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EACV,0DACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,8OAAC,kKAAA,CAAA,QAAqB;QACpB,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EAAE,sCAAsC;QACnD,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,kBAAkB,EACzB,SAAS,EACT,GAAG,OACsD;IACzD,qBACE,8OAAC,kKAAA,CAAA,cAA2B;QAC1B,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 1062, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/sections/BeneficiariesSection.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useEffect, useMemo, useState } from 'react';\r\nimport { DataTable } from '@/app/(admin)/admin/dashboard/data-table/data-table/data-table';\r\nimport { beneficiaryColumns } from '@/app/(admin)/admin/dashboard/data-table/columns/beneficiaries';\r\nimport createServer from 'next/dist/server/next';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\n\r\nexport default function BeneficiariesSection({\r\n  paginatedData,\r\n  page,\r\n  rowsPerPage,\r\n  handleEdit,\r\n  handleView,\r\n  handleDelete,\r\n  messagesCountMap: initialMessagesCountMap,\r\n  responsesCountMap: initialResponsesCountMap,\r\n  currentUserRole,\r\n  TableActions,\r\n  onAddMessage: externalOnAddMessage,\r\n}: {\r\n  paginatedData: any[];\r\n  page: number;\r\n  rowsPerPage: number;\r\n  handleEdit: (record: any) => void;\r\n  handleDelete: (id: string | number) => void;\r\n  messagesCountMap?: Record<string, number>;\r\n  responsesCountMap?: Record<string, number>;\r\n  currentUserRole: string;\r\n  TableActions: React.FC<any>;\r\n  onAddMessage?: (id: string) => void;\r\n}) {\r\n  // Local maps so the component can update counts immediately after creating a message\r\n  const [messagesCountMap, setMessagesCountMap] = useState<Record<string, number>>(\r\n    initialMessagesCountMap ?? {}\r\n  );\r\n  const [responsesCountMap, setResponsesCountMap] = useState<Record<string, number>>(\r\n    initialResponsesCountMap ?? {}\r\n  );\r\n\r\n  // Merge server-provided counts from paginatedData whenever it changes (keeps UI accurate after refresh)\r\n  useEffect(() => {\r\n    if (!Array.isArray(paginatedData)) return;\r\n\r\n    setMessagesCountMap((prev) => {\r\n      const merged = { ...prev };\r\n      for (const b of paginatedData) {\r\n        const id = b?.id;\r\n        // Accept many shapes for server-provided counts\r\n        const serverCount =\r\n          typeof b?.messageCount === 'number'\r\n            ? b.messageCount\r\n            : typeof b?.messagesCount === 'number'\r\n            ? b.messagesCount\r\n            : typeof b?._count?.messages === 'number'\r\n            ? b._count.messages\r\n            : Array.isArray(b?.beneficiaryMessages)\r\n            ? b.beneficiaryMessages.length\r\n            : Array.isArray(b?.messages)\r\n            ? b.messages.length\r\n            : undefined;\r\n        if (id && typeof serverCount === 'number') merged[id] = serverCount;\r\n      }\r\n      return merged;\r\n    });\r\n\r\n    setResponsesCountMap((prev) => {\r\n      const merged = { ...prev };\r\n      for (const b of paginatedData) {\r\n        const id = b?.id;\r\n        const serverCount =\r\n          typeof b?.responseCount === 'number'\r\n            ? b.responseCount\r\n            : typeof b?.responsesCount === 'number'\r\n            ? b.responsesCount\r\n            : Array.isArray(b?.responses)\r\n            ? b.responses.length\r\n            : undefined;\r\n        if (id && typeof serverCount === 'number') merged[id] = serverCount;\r\n      }\r\n      return merged;\r\n    });\r\n  }, [paginatedData]);\r\n\r\n  // Dialog state for creating a message\r\n  const [openAddMessageFor, setOpenAddMessageFor] = useState<string | null>(null);\r\n  const [creating, setCreating] = useState(false);\r\n\r\n  const openCreateModal = (beneficiaryId: string) => {\r\n    if (externalOnAddMessage) {\r\n      try {\r\n        externalOnAddMessage(beneficiaryId);\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n    setOpenAddMessageFor(beneficiaryId);\r\n  };\r\n\r\n  const closeCreateModal = () => {\r\n    setOpenAddMessageFor(null);\r\n  };\r\n\r\n  // After message creation we refresh counts by fetching beneficiary endpoint,\r\n  // and also optimistically increment local map to show instant feedback.\r\n  const handleCreateSuccess = async (beneficiaryId: string) => {\r\n    setCreating(true);\r\n\r\n    // optimistic increment first\r\n    setMessagesCountMap((prev) => ({ ...prev, [beneficiaryId]: (prev[beneficiaryId] ?? 0) + 1 }));\r\n\r\n    try {\r\n      const res = await fetch(`/api/beneficiaries/${encodeURIComponent(beneficiaryId)}`);\r\n      if (!res.ok) {\r\n        setOpenAddMessageFor(null);\r\n        return;\r\n      }\r\n      const json = await res.json();\r\n      const msgCount =\r\n        typeof json?.messageCount === 'number'\r\n          ? json.messageCount\r\n          : typeof json?.messagesCount === 'number'\r\n          ? json.messagesCount\r\n          : typeof json?._count?.messages === 'number'\r\n          ? json._count.messages\r\n          : undefined;\r\n      const respCount =\r\n        typeof json?.responseCount === 'number'\r\n          ? json.responseCount\r\n          : typeof json?.responsesCount === 'number'\r\n          ? json.responsesCount\r\n          : undefined;\r\n\r\n      if (typeof msgCount === 'number') {\r\n        setMessagesCountMap((prev) => ({ ...prev, [beneficiaryId]: msgCount }));\r\n      }\r\n      if (typeof respCount === 'number') {\r\n        setResponsesCountMap((prev) => ({ ...prev, [beneficiaryId]: respCount }));\r\n      }\r\n      setOpenAddMessageFor(null);\r\n    } catch (err) {\r\n      // already optimistic, ignore\r\n      setOpenAddMessageFor(null);\r\n    } finally {\r\n      setCreating(false);\r\n    }\r\n  };\r\n\r\n  const columns = useMemo(() => {\r\n    return [\r\n      {\r\n        id: 'number',\r\n        header: 'No.',\r\n        cell: ({ row }: any) => (page - 1) * rowsPerPage + row.index + 1,\r\n        size: 50,\r\n      },\r\n      ...beneficiaryColumns({\r\n        onEdit: handleEdit,\r\n        onView: handleView,\r\n        onDelete: handleDelete,\r\n        // pass our local handlers/maps\r\n        messagesCountMap,\r\n        responsesCountMap,\r\n        currentUserRole,\r\n        onAddMessage: (id: string) => openCreateModal(id),\r\n      }),\r\n    ];\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [\r\n    page,\r\n    rowsPerPage,\r\n    handleEdit,\r\n    handleView,\r\n    handleDelete,\r\n    messagesCountMap,\r\n    responsesCountMap,\r\n    currentUserRole,\r\n  ]);\r\n\r\n  // local wrappers to call parent handlers\r\n  function handleEdit(record: any) {\r\n    handleEditProp(record);\r\n  }\r\n  function handleView(record: any) {\r\n    handleViewProp(record);\r\n  }\r\n  function handleDelete(recordId: any) {\r\n    handleDeleteProp(recordId);\r\n  }\r\n\r\n  // Because we renamed parent props above, rebind them here to avoid lint issues\r\n  // (these are the original functions passed as props)\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n  const handleEditProp = handleEdit;\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n  const handleViewProp = handleView;\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n  const handleDeleteProp = handleDelete;\r\n\r\n  return (\r\n    <div>\r\n      <DataTable columns={columns} data={paginatedData} />\r\n      <TableActions data={paginatedData} columns={columns} tableRef={React.createRef()} />\r\n\r\n      {/* Dialog for creating message */}\r\n      <Dialog open={!!openAddMessageFor} onOpenChange={(val) => !val && closeCreateModal()}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>Create Message for beneficiary</DialogTitle>\r\n          </DialogHeader>\r\n\r\n          {openAddMessageFor && (\r\n            <div className=\"p-4 max-w-3xl\">\r\n              <CreateMessageForm\r\n                messageId={openAddMessageFor}\r\n                onSuccess={async () => {\r\n                  await handleCreateSuccess(openAddMessageFor);\r\n                }}\r\n                onCancel={closeCreateModal}\r\n              />\r\n\r\n              <div className=\"mt-3 flex justify-end\">\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"outline\"\r\n                  onClick={closeCreateModal}\r\n                  disabled={creating}\r\n                >\r\n                  Close\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </DialogContent>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1312, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/sections/MessagesSection.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport { Message } from '@/lib/generated/prisma';\r\n\r\ntype MessageWithRelations = Message & {\r\n  beneficiary?: {\r\n    id: string;\r\n    firstName: string;\r\n    lastName: string;\r\n  } | null;\r\n};\r\n\r\nexport default function MessagesSection({\r\n  paginatedData,\r\n  page,\r\n  rowsPerPage,\r\n  handleEdit,\r\n  handleView,\r\n  handleDelete,\r\n  onRespond,\r\n  currentUserRole,\r\n  TableActions,\r\n  deleteId,\r\n  deleteLoading,\r\n}: {\r\n  paginatedData: MessageWithRelations[] | any[];\r\n  page: number;\r\n  rowsPerPage: number;\r\n  handleEdit: (record: any) => void;\r\n  // now handleView accepts an optional source so the dashboard knows this came from the messages list\r\n  handleView: (record: any, source?: 'messages' | 'responses' | string) => void;\r\n  handleDelete: (id: string | number) => void;\r\n  onRespond?: (messageId: number | string) => void;\r\n  currentUserRole?: string;\r\n  TableActions?: React.FC<any>;\r\n  deleteId?: string | number | null;\r\n  deleteLoading?: boolean;\r\n}) {\r\n  const ownerLabel = (m: MessageWithRelations) => {\r\n    if (m.name && `${m.name}`.trim().length > 0) return m.name;\r\n    if (m.beneficiary) return `${m.beneficiary.firstName} ${m.beneficiary.lastName}`;\r\n    return 'System';\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {(!Array.isArray(paginatedData) || paginatedData.length === 0) && (\r\n        <div className=\"text-center py-8 text-gray-500\">No messages found.</div>\r\n      )}\r\n\r\n      {Array.isArray(paginatedData) &&\r\n        paginatedData.map((m: any) => (\r\n          <div\r\n            key={m.id}\r\n            className=\"p-4 border rounded-md bg-white dark:bg-gray-900 hover:shadow-sm transition-shadow\"\r\n          >\r\n            <div className=\"flex items-start justify-between gap-4\">\r\n              <div\r\n                className=\"flex-1 min-w-0 cursor-pointer\"\r\n                onClick={() => handleView(m, 'messages')}\r\n                role=\"button\"\r\n                tabIndex={0}\r\n                onKeyDown={(e) => {\r\n                  if (e.key === 'Enter' || e.key === ' ') handleView(m, 'messages');\r\n                }}\r\n              >\r\n                <div className=\"flex flex-wrap items-center gap-3\">\r\n                  <div className=\"font-medium truncate\">{ownerLabel(m)}</div>\r\n                  <div className=\"text-xs px-2 py-1 rounded bg-gray-100 dark:bg-gray-800 text-sm\">\r\n                    {m.messageKind ?? '-'}\r\n                  </div>\r\n                  <div className=\"text-xs text-gray-500\">\r\n                    Created: {m.createdAt ? new Date(m.createdAt).toLocaleString() : '-'}\r\n                  </div>\r\n                  <div className=\"text-xs text-gray-500\">\r\n                    Updated: {m.updatedAt ? new Date(m.updatedAt).toLocaleString() : '-'}\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Intentionally not showing message content here */}\r\n              </div>\r\n\r\n              <div className=\"flex items-center gap-2\">\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"px-2 py-1 border rounded text-sm bg-blue-50 hover:bg-blue-100 dark:bg-gray-800 dark:hover:bg-blue-900\"\r\n                  onClick={() => handleView(m, 'messages')}\r\n                >\r\n                  View\r\n                </button>\r\n\r\n                {onRespond && m.allowResponses && (\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"px-2 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700\"\r\n                    onClick={() => onRespond(m.id)}\r\n                  >\r\n                    Respond\r\n                  </button>\r\n                )}\r\n\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"px-2 py-1 border rounded text-sm bg-yellow-50 hover:bg-yellow-100 dark:bg-gray-800 dark:hover:bg-yellow-900\"\r\n                  onClick={() => handleEdit(m)}\r\n                >\r\n                  Edit\r\n                </button>\r\n\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"px-2 py-1 border rounded text-sm bg-red-50 hover:bg-red-100 dark:bg-gray-800 dark:hover:bg-red-900\"\r\n                  onClick={() => handleDelete(m.id)}\r\n                  disabled={Boolean(deleteLoading && deleteId === m.id)}\r\n                >\r\n                  {deleteLoading && deleteId === m.id ? 'Deleting...' : 'Delete'}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ))}\r\n\r\n      {/* TableActions optional */}\r\n      <div>\r\n        {TableActions ? (\r\n          <TableActions data={paginatedData} columns={[]} tableRef={React.createRef()} />\r\n        ) : null}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AAFA;;;AAae,SAAS,gBAAgB,EACtC,aAAa,EACb,IAAI,EACJ,WAAW,EACX,UAAU,EACV,UAAU,EACV,YAAY,EACZ,SAAS,EACT,eAAe,EACf,YAAY,EACZ,QAAQ,EACR,aAAa,EAcd;IACC,MAAM,aAAa,CAAC;QAClB,IAAI,EAAE,IAAI,IAAI,GAAG,EAAE,IAAI,EAAE,CAAC,IAAI,GAAG,MAAM,GAAG,GAAG,OAAO,EAAE,IAAI;QAC1D,IAAI,EAAE,WAAW,EAAE,OAAO,GAAG,EAAE,WAAW,CAAC,SAAS,CAAC,CAAC,EAAE,EAAE,WAAW,CAAC,QAAQ,EAAE;QAChF,OAAO;IACT;IAEA,qBACE,8OAAC;QAAI,WAAU;;YACZ,CAAC,CAAC,MAAM,OAAO,CAAC,kBAAkB,cAAc,MAAM,KAAK,CAAC,mBAC3D,8OAAC;gBAAI,WAAU;0BAAiC;;;;;;YAGjD,MAAM,OAAO,CAAC,kBACb,cAAc,GAAG,CAAC,CAAC,kBACjB,8OAAC;oBAEC,WAAU;8BAEV,cAAA,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCACC,WAAU;gCACV,SAAS,IAAM,WAAW,GAAG;gCAC7B,MAAK;gCACL,UAAU;gCACV,WAAW,CAAC;oCACV,IAAI,EAAE,GAAG,KAAK,WAAW,EAAE,GAAG,KAAK,KAAK,WAAW,GAAG;gCACxD;0CAEA,cAAA,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAI,WAAU;sDAAwB,WAAW;;;;;;sDAClD,8OAAC;4CAAI,WAAU;sDACZ,EAAE,WAAW,IAAI;;;;;;sDAEpB,8OAAC;4CAAI,WAAU;;gDAAwB;gDAC3B,EAAE,SAAS,GAAG,IAAI,KAAK,EAAE,SAAS,EAAE,cAAc,KAAK;;;;;;;sDAEnE,8OAAC;4CAAI,WAAU;;gDAAwB;gDAC3B,EAAE,SAAS,GAAG,IAAI,KAAK,EAAE,SAAS,EAAE,cAAc,KAAK;;;;;;;;;;;;;;;;;;0CAOvE,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCACC,MAAK;wCACL,WAAU;wCACV,SAAS,IAAM,WAAW,GAAG;kDAC9B;;;;;;oCAIA,aAAa,EAAE,cAAc,kBAC5B,8OAAC;wCACC,MAAK;wCACL,WAAU;wCACV,SAAS,IAAM,UAAU,EAAE,EAAE;kDAC9B;;;;;;kDAKH,8OAAC;wCACC,MAAK;wCACL,WAAU;wCACV,SAAS,IAAM,WAAW;kDAC3B;;;;;;kDAID,8OAAC;wCACC,MAAK;wCACL,WAAU;wCACV,SAAS,IAAM,aAAa,EAAE,EAAE;wCAChC,UAAU,QAAQ,iBAAiB,aAAa,EAAE,EAAE;kDAEnD,iBAAiB,aAAa,EAAE,EAAE,GAAG,gBAAgB;;;;;;;;;;;;;;;;;;mBA9DvD,EAAE,EAAE;;;;;0BAsEf,8OAAC;0BACE,6BACC,8OAAC;oBAAa,MAAM;oBAAe,SAAS,EAAE;oBAAE,wBAAU,qMAAA,CAAA,UAAK,CAAC,SAAS;;;;;2BACvE;;;;;;;;;;;;AAIZ","debugId":null}},
    {"offset": {"line": 1491, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/data-table/columns/responses.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { ColumnDef } from '@tanstack/react-table';\r\nimport { Response } from '@/lib/generated/prisma';\r\nimport { Button } from '@/components/ui/button';\r\n\r\ntype ResponseWithRelations = Response & {\r\n  responderUser?: {\r\n    id: string;\r\n    firstName: string;\r\n    lastName: string;\r\n    email?: string | null;\r\n  } | null;\r\n  responderBeneficiary?: {\r\n    id: string;\r\n    firstName: string;\r\n    lastName: string;\r\n  } | null;\r\n  message?: {\r\n    id: number;\r\n    title?: string | null;\r\n    messageKind?: string | null;\r\n  } | null;\r\n};\r\n\r\ntype Opts = {\r\n  onEdit: (row: ResponseWithRelations) => void;\r\n  onView?: (row: ResponseWithRelations) => void;\r\n  onDelete?: (id: string) => void;\r\n  deleteId?: string | number | null;\r\n  deleteLoading?: boolean;\r\n  currentUserRole?: string;\r\n};\r\n\r\nexport function responseColumns({\r\n  onEdit,\r\n  onView,\r\n  onDelete,\r\n  deleteId,\r\n  deleteLoading,\r\n}: Opts): ColumnDef<ResponseWithRelations>[] {\r\n  const cols: ColumnDef<ResponseWithRelations>[] = [\r\n    {\r\n      accessorKey: 'message',\r\n      header: 'Message',\r\n      cell: ({ row }) => row.original.message?.title ?? '-',\r\n    },\r\n    {\r\n      accessorKey: 'message.messageKind',\r\n      header: 'Message Kind',\r\n      cell: ({ row }) => row.original.message?.messageKind ?? '-',\r\n    },\r\n    {\r\n      accessorKey: 'responder',\r\n      header: 'Responder',\r\n      cell: ({ row }) => {\r\n        const u = row.original.responderUser;\r\n        const b = row.original.responderBeneficiary;\r\n        if (u) return `${u.firstName} ${u.lastName}${u.email ? ` (${u.email})` : ''}`;\r\n        if (b) return `${b.firstName} ${b.lastName}`;\r\n        return 'System';\r\n      },\r\n    },\r\n    {\r\n      accessorKey: 'createdAt',\r\n      header: 'Created At',\r\n      cell: ({ row }) =>\r\n        row.getValue('createdAt')\r\n          ? new Date(row.getValue('createdAt') as string).toLocaleString()\r\n          : '',\r\n    },\r\n    {\r\n      accessorKey: 'updatedAt',\r\n      header: 'Updated At',\r\n      cell: ({ row }) =>\r\n        row.getValue('updatedAt')\r\n          ? new Date(row.getValue('updatedAt') as string).toLocaleString()\r\n          : '',\r\n    },\r\n    {\r\n      id: 'edit',\r\n      header: 'Edit',\r\n      cell: ({ row }) => (\r\n        <Button\r\n          type=\"button\"\r\n          size=\"sm\"\r\n          variant=\"outline\"\r\n          className=\"transition-colors duration-150 hover:bg-yellow-100 dark:hover:bg-yellow-800 hover:text-yellow-900 dark:hover:text-yellow-100\"\r\n          onClick={() => onEdit(row.original)}\r\n        >\r\n          Edit\r\n        </Button>\r\n      ),\r\n    },\r\n    {\r\n      id: 'view',\r\n      header: 'View',\r\n      cell: ({ row }) =>\r\n        onView ? (\r\n          <Button\r\n            type=\"button\"\r\n            size=\"sm\"\r\n            variant=\"outline\"\r\n            className=\"transition-colors duration-150 hover:bg-blue-100 dark:hover:bg-blue-800 hover:text-blue-900 dark:hover:text-blue-100\"\r\n            onClick={() => onView(row.original)}\r\n          >\r\n            View\r\n          </Button>\r\n        ) : null,\r\n    },\r\n    {\r\n      id: 'delete',\r\n      header: 'Delete',\r\n      cell: ({ row }) => (\r\n        <Button\r\n          type=\"button\"\r\n          size=\"sm\"\r\n          variant=\"destructive\"\r\n          className=\"transition-colors duration-150 hover:bg-red-600 dark:hover:bg-red-800 hover:text-white dark:hover:text-white\"\r\n          onClick={() => onDelete && onDelete(row.original.id)}\r\n          disabled={Boolean(deleteLoading && deleteId === row.original.id)}\r\n        >\r\n          {deleteLoading && deleteId === row.original.id ? 'Deleting...' : 'Delete'}\r\n        </Button>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  return cols;\r\n}\r\n"],"names":[],"mappings":";;;;AAIA;AAJA;;;AAkCO,SAAS,gBAAgB,EAC9B,MAAM,EACN,MAAM,EACN,QAAQ,EACR,QAAQ,EACR,aAAa,EACR;IACL,MAAM,OAA2C;QAC/C;YACE,aAAa;YACb,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAI,QAAQ,CAAC,OAAO,EAAE,SAAS;QACpD;QACA;YACE,aAAa;YACb,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAI,QAAQ,CAAC,OAAO,EAAE,eAAe;QAC1D;QACA;YACE,aAAa;YACb,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE;gBACZ,MAAM,IAAI,IAAI,QAAQ,CAAC,aAAa;gBACpC,MAAM,IAAI,IAAI,QAAQ,CAAC,oBAAoB;gBAC3C,IAAI,GAAG,OAAO,GAAG,EAAE,SAAS,CAAC,CAAC,EAAE,EAAE,QAAQ,GAAG,EAAE,KAAK,GAAG,CAAC,EAAE,EAAE,EAAE,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI;gBAC7E,IAAI,GAAG,OAAO,GAAG,EAAE,SAAS,CAAC,CAAC,EAAE,EAAE,QAAQ,EAAE;gBAC5C,OAAO;YACT;QACF;QACA;YACE,aAAa;YACb,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,GACZ,IAAI,QAAQ,CAAC,eACT,IAAI,KAAK,IAAI,QAAQ,CAAC,cAAwB,cAAc,KAC5D;QACR;QACA;YACE,aAAa;YACb,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,GACZ,IAAI,QAAQ,CAAC,eACT,IAAI,KAAK,IAAI,QAAQ,CAAC,cAAwB,cAAc,KAC5D;QACR;QACA;YACE,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,iBACZ,8OAAC,2HAAA,CAAA,SAAM;oBACL,MAAK;oBACL,MAAK;oBACL,SAAQ;oBACR,WAAU;oBACV,SAAS,IAAM,OAAO,IAAI,QAAQ;8BACnC;;;;;;QAIL;QACA;YACE,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,GACZ,uBACE,8OAAC,2HAAA,CAAA,SAAM;oBACL,MAAK;oBACL,MAAK;oBACL,SAAQ;oBACR,WAAU;oBACV,SAAS,IAAM,OAAO,IAAI,QAAQ;8BACnC;;;;;2BAGC;QACR;QACA;YACE,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,iBACZ,8OAAC,2HAAA,CAAA,SAAM;oBACL,MAAK;oBACL,MAAK;oBACL,SAAQ;oBACR,WAAU;oBACV,SAAS,IAAM,YAAY,SAAS,IAAI,QAAQ,CAAC,EAAE;oBACnD,UAAU,QAAQ,iBAAiB,aAAa,IAAI,QAAQ,CAAC,EAAE;8BAE9D,iBAAiB,aAAa,IAAI,QAAQ,CAAC,EAAE,GAAG,gBAAgB;;;;;;QAGvE;KACD;IAED,OAAO;AACT","debugId":null}},
    {"offset": {"line": 1590, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/sections/ResponsesSection.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport { DataTable } from '@/app/(admin)/admin/dashboard/data-table/data-table/data-table';\r\nimport { responseColumns } from '@/app/(admin)/admin/dashboard/data-table/columns/responses';\r\n\r\nexport default function ResponsesSection({\r\n  paginatedData,\r\n  page,\r\n  rowsPerPage,\r\n  handleEdit,\r\n  handleView,\r\n  handleDelete,\r\n  TableActions,\r\n  deleteId,\r\n  deleteLoading,\r\n}: {\r\n  paginatedData: any[];\r\n  page: number;\r\n  rowsPerPage: number;\r\n  handleEdit: (record: any) => void;\r\n  handleView: (record: any) => void;\r\n  handleDelete: (id: string | number) => void;\r\n  TableActions: React.FC<any>;\r\n  deleteId?: string | number | null;\r\n  deleteLoading?: boolean;\r\n}) {\r\n  const columns = [\r\n    {\r\n      id: 'number',\r\n      header: 'No.',\r\n      cell: ({ row }: any) => (page - 1) * rowsPerPage + row.index + 1,\r\n      size: 50,\r\n    },\r\n    ...responseColumns({\r\n      onEdit: handleEdit,\r\n      onView: handleView,\r\n      onDelete: handleDelete,\r\n      deleteId,\r\n      deleteLoading,\r\n    }),\r\n  ];\r\n\r\n  return (\r\n    <>\r\n      <DataTable columns={columns} data={paginatedData} />\r\n      <TableActions data={paginatedData} columns={columns} tableRef={React.createRef()} />\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAJA;;;;;AAMe,SAAS,iBAAiB,EACvC,aAAa,EACb,IAAI,EACJ,WAAW,EACX,UAAU,EACV,UAAU,EACV,YAAY,EACZ,YAAY,EACZ,QAAQ,EACR,aAAa,EAWd;IACC,MAAM,UAAU;QACd;YACE,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAO,GAAK,CAAC,OAAO,CAAC,IAAI,cAAc,IAAI,KAAK,GAAG;YAC/D,MAAM;QACR;WACG,CAAA,GAAA,gLAAA,CAAA,kBAAe,AAAD,EAAE;YACjB,QAAQ;YACR,QAAQ;YACR,UAAU;YACV;YACA;QACF;KACD;IAED,qBACE;;0BACE,8OAAC,0LAAA,CAAA,YAAS;gBAAC,SAAS;gBAAS,MAAM;;;;;;0BACnC,8OAAC;gBAAa,MAAM;gBAAe,SAAS;gBAAS,wBAAU,qMAAA,CAAA,UAAK,CAAC,SAAS;;;;;;;;AAGpF","debugId":null}},
    {"offset": {"line": 1646, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/sections/UsersSection.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useMemo } from 'react';\r\nimport { DataTable } from '@/app/(admin)/admin/dashboard/data-table/data-table/data-table';\r\nimport { Button } from '@/components/ui/button';\r\n\r\nexport default function UsersSection({\r\n  paginatedData,\r\n  page,\r\n  rowsPerPage,\r\n  handleEdit,\r\n  handleView,\r\n  handleDelete,\r\n  messagesCountMap, // not used here but kept for API compatibility with other sections\r\n  responsesCountMap,\r\n  currentUserRole,\r\n  TableActions,\r\n  onAddMessage,\r\n}: {\r\n  paginatedData: any[];\r\n  page: number;\r\n  rowsPerPage: number;\r\n  handleEdit: (record: any) => void;\r\n  handleView: (record: any) => void;\r\n  handleDelete: (id: string | number) => void;\r\n  messagesCountMap: Record<string, number>;\r\n  responsesCountMap?: Record<string, number>;\r\n  currentUserRole: string;\r\n  TableActions: React.FC<any>;\r\n  onAddMessage?: (id: string) => void;\r\n}) {\r\n  const columns = useMemo(\r\n    () => [\r\n      {\r\n        id: 'number',\r\n        header: 'No.',\r\n        cell: ({ row }: any) => (page - 1) * rowsPerPage + row.index + 1,\r\n        size: 50,\r\n      },\r\n      {\r\n        accessorKey: 'username',\r\n        header: 'Username',\r\n        cell: ({ row }: any) => (\r\n          <div className=\"whitespace-normal break-words max-w-xs\">{row.getValue('username')}</div>\r\n        ),\r\n      },\r\n      {\r\n        id: 'name',\r\n        header: 'Name',\r\n        cell: ({ row }: any) =>\r\n          `${row.original.firstName ?? ''} ${row.original.lastName ?? ''}`.trim() || '-',\r\n      },\r\n      {\r\n        accessorKey: 'email',\r\n        header: 'Email',\r\n        cell: ({ row }: any) => row.getValue('email') ?? '-',\r\n      },\r\n      {\r\n        id: 'role',\r\n        header: 'Role',\r\n        cell: ({ row }: any) => row.original.role ?? '-',\r\n      },\r\n      {\r\n        accessorKey: 'createdAt',\r\n        header: 'Created At',\r\n        cell: ({ row }: any) =>\r\n          row.getValue('createdAt')\r\n            ? new Date(row.getValue('createdAt') as string).toLocaleDateString()\r\n            : '',\r\n      },\r\n      {\r\n        id: 'view',\r\n        header: 'View',\r\n        cell: ({ row }: any) =>\r\n          handleView ? (\r\n            <Button\r\n              type=\"button\"\r\n              size=\"sm\"\r\n              variant=\"outline\"\r\n              className=\"transition-colors duration-150 hover:bg-blue-100 dark:hover:bg-blue-800 hover:text-blue-900 dark:hover:text-blue-100\"\r\n              onClick={() => handleView(row.original)}\r\n            >\r\n              View\r\n            </Button>\r\n          ) : null,\r\n      },\r\n      {\r\n        id: 'edit',\r\n        header: 'Edit',\r\n        cell: ({ row }: any) =>\r\n          handleEdit ? (\r\n            <Button\r\n              type=\"button\"\r\n              size=\"sm\"\r\n              variant=\"outline\"\r\n              className=\"transition-colors duration-150 hover:bg-yellow-100 dark:hover:bg-yellow-800 hover:text-yellow-900 dark:hover:text-yellow-100\"\r\n              onClick={() => handleEdit(row.original)}\r\n            >\r\n              Edit\r\n            </Button>\r\n          ) : null,\r\n      },\r\n      {\r\n        id: 'delete',\r\n        header: 'Delete',\r\n        cell: ({ row }: any) =>\r\n          handleDelete ? (\r\n            <Button\r\n              type=\"button\"\r\n              size=\"sm\"\r\n              variant=\"destructive\"\r\n              className=\"transition-colors duration-150 hover:bg-red-600 dark:hover:bg-red-800 hover:text-white dark:hover:text-white\"\r\n              onClick={() => handleDelete(row.original.id)}\r\n            >\r\n              Delete\r\n            </Button>\r\n          ) : null,\r\n      },\r\n    ],\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    [page, rowsPerPage, handleEdit, handleView, handleDelete]\r\n  );\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"mb-4 flex items-center justify-end\">\r\n        {/* Optionally the parent can render Add User; we keep it out of the table to let parent control creation */}\r\n      </div>\r\n\r\n      <DataTable columns={columns} data={paginatedData} />\r\n      <TableActions data={paginatedData} columns={columns} tableRef={React.createRef()} />\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAJA;;;;;AAMe,SAAS,aAAa,EACnC,aAAa,EACb,IAAI,EACJ,WAAW,EACX,UAAU,EACV,UAAU,EACV,YAAY,EACZ,gBAAgB,EAChB,iBAAiB,EACjB,eAAe,EACf,YAAY,EACZ,YAAY,EAab;IACC,MAAM,UAAU,CAAA,GAAA,qMAAA,CAAA,UAAO,AAAD,EACpB,IAAM;YACJ;gBACE,IAAI;gBACJ,QAAQ;gBACR,MAAM,CAAC,EAAE,GAAG,EAAO,GAAK,CAAC,OAAO,CAAC,IAAI,cAAc,IAAI,KAAK,GAAG;gBAC/D,MAAM;YACR;YACA;gBACE,aAAa;gBACb,QAAQ;gBACR,MAAM,CAAC,EAAE,GAAG,EAAO,iBACjB,8OAAC;wBAAI,WAAU;kCAA0C,IAAI,QAAQ,CAAC;;;;;;YAE1E;YACA;gBACE,IAAI;gBACJ,QAAQ;gBACR,MAAM,CAAC,EAAE,GAAG,EAAO,GACjB,GAAG,IAAI,QAAQ,CAAC,SAAS,IAAI,GAAG,CAAC,EAAE,IAAI,QAAQ,CAAC,QAAQ,IAAI,IAAI,CAAC,IAAI,MAAM;YAC/E;YACA;gBACE,aAAa;gBACb,QAAQ;gBACR,MAAM,CAAC,EAAE,GAAG,EAAO,GAAK,IAAI,QAAQ,CAAC,YAAY;YACnD;YACA;gBACE,IAAI;gBACJ,QAAQ;gBACR,MAAM,CAAC,EAAE,GAAG,EAAO,GAAK,IAAI,QAAQ,CAAC,IAAI,IAAI;YAC/C;YACA;gBACE,aAAa;gBACb,QAAQ;gBACR,MAAM,CAAC,EAAE,GAAG,EAAO,GACjB,IAAI,QAAQ,CAAC,eACT,IAAI,KAAK,IAAI,QAAQ,CAAC,cAAwB,kBAAkB,KAChE;YACR;YACA;gBACE,IAAI;gBACJ,QAAQ;gBACR,MAAM,CAAC,EAAE,GAAG,EAAO,GACjB,2BACE,8OAAC,2HAAA,CAAA,SAAM;wBACL,MAAK;wBACL,MAAK;wBACL,SAAQ;wBACR,WAAU;wBACV,SAAS,IAAM,WAAW,IAAI,QAAQ;kCACvC;;;;;+BAGC;YACR;YACA;gBACE,IAAI;gBACJ,QAAQ;gBACR,MAAM,CAAC,EAAE,GAAG,EAAO,GACjB,2BACE,8OAAC,2HAAA,CAAA,SAAM;wBACL,MAAK;wBACL,MAAK;wBACL,SAAQ;wBACR,WAAU;wBACV,SAAS,IAAM,WAAW,IAAI,QAAQ;kCACvC;;;;;+BAGC;YACR;YACA;gBACE,IAAI;gBACJ,QAAQ;gBACR,MAAM,CAAC,EAAE,GAAG,EAAO,GACjB,6BACE,8OAAC,2HAAA,CAAA,SAAM;wBACL,MAAK;wBACL,MAAK;wBACL,SAAQ;wBACR,WAAU;wBACV,SAAS,IAAM,aAAa,IAAI,QAAQ,CAAC,EAAE;kCAC5C;;;;;+BAGC;YACR;SACD,EACD,uDAAuD;IACvD;QAAC;QAAM;QAAa;QAAY;QAAY;KAAa;IAG3D,qBACE,8OAAC;;0BACC,8OAAC;gBAAI,WAAU;;;;;;0BAIf,8OAAC,0LAAA,CAAA,YAAS;gBAAC,SAAS;gBAAS,MAAM;;;;;;0BACnC,8OAAC;gBAAa,MAAM;gBAAe,SAAS;gBAAS,wBAAU,qMAAA,CAAA,UAAK,CAAC,SAAS;;;;;;;;;;;;AAGpF","debugId":null}},
    {"offset": {"line": 1793, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/createUserForm.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect, useRef } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\n\r\ntype ShowOnly = 'all' | 'profile' | 'password' | 'username';\r\n\r\ntype Props = {\r\n  mode?: 'create' | 'edit';\r\n  userId?: string;\r\n  initialData?: any; // optional preloaded data: {firstName, lastName, username, email, image, role, ...}\r\n  onSuccess?: (updatedUser?: any) => void;\r\n  onCancel?: () => void;\r\n  onDelete?: (userId: string) => void;\r\n  forceChangePassword?: boolean;\r\n  forceChangeUsername?: boolean;\r\n  // New: allow callers to render only a specific subsection of the form\r\n  showOnly?: ShowOnly;\r\n};\r\n\r\nfunction getCameFrom() {\r\n  if (typeof window !== 'undefined') {\r\n    return sessionStorage.getItem('came-from') || '/';\r\n  }\r\n  return '/';\r\n}\r\n\r\nconst ROLE_OPTIONS = [\r\n  { value: 'super', label: 'Super' },\r\n  { value: 'admin', label: 'Admin' },\r\n  { value: 'moderator', label: 'Moderator' },\r\n  { value: 'beneficiary', label: 'Beneficiary' },\r\n  { value: 'guest', label: 'Guest' },\r\n] as const;\r\n\r\nexport default function CreateOrEditUserForm({\r\n  mode = 'create',\r\n  userId,\r\n  initialData,\r\n  onSuccess,\r\n  onCancel,\r\n  onDelete,\r\n  forceChangePassword = false,\r\n  forceChangeUsername = false,\r\n  showOnly = 'all',\r\n}: Props) {\r\n  // Defensive: don't even render the form if edit mode and no id and no initialData\r\n  if (mode === 'edit' && !userId && !initialData) {\r\n    return <div className=\"text-red-500 text-center\">User ID missing. Cannot edit user</div>;\r\n  }\r\n\r\n  // initialRef keeps a snapshot of the data we consider \"original\" for diffing\r\n  const initialRef = useRef<any>(initialData ?? null);\r\n  useEffect(() => {\r\n    if (initialData) initialRef.current = initialData;\r\n  }, [initialData]);\r\n\r\n  const isEdit = mode === 'edit' || !!userId || !!initialData;\r\n\r\n  // Form state (visible values)\r\n  const [form, setForm] = useState({\r\n    firstName: initialData?.firstName ?? '',\r\n    lastName: initialData?.lastName ?? '',\r\n    username: initialData?.username ?? '',\r\n    email: initialData?.email ?? '',\r\n    password: '',\r\n    confirmPassword: '',\r\n    role: initialData?.role ?? '', // role included for both create & edit\r\n  });\r\n  const [imageFile, setImageFile] = useState<File | null>(null);\r\n  const [imageUrl, setImageUrl] = useState<string>(initialData?.image || '');\r\n  const [imagePreview, setImagePreview] = useState<string | null>(initialData?.image || null);\r\n  const [imageToDelete, setImageToDelete] = useState<string | null>(null);\r\n\r\n  const [changeUsername, setChangeUsername] = useState(false);\r\n  const [newUsername, setNewUsername] = useState('');\r\n  const [confirmNewUsername, setConfirmNewUsername] = useState('');\r\n\r\n  const [changePassword, setChangePassword] = useState(false);\r\n  const [newPassword, setNewPassword] = useState('');\r\n  const [confirmNewPassword, setConfirmNewPassword] = useState('');\r\n\r\n  const [error, setError] = useState<string>('');\r\n  const [success, setSuccess] = useState<string>('');\r\n  const [checkingUsername, setCheckingUsername] = useState(false);\r\n  const [usernameInvalid, setUsernameInvalid] = useState(false);\r\n  const [deleting, setDeleting] = useState(false);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [registerDot, setRegisterDot] = useState(0);\r\n\r\n  const [loadingUser, setLoadingUser] = useState(false);\r\n  const [fetchError, setFetchError] = useState<string | null>(null);\r\n\r\n  const router = useRouter();\r\n\r\n  // Fetcher (used both on mount and on retry)\r\n  async function fetchUserData(signal?: AbortSignal) {\r\n    const idToUse = userId ?? initialRef.current?.id;\r\n    if (!idToUse) return;\r\n    setLoadingUser(true);\r\n    setFetchError(null);\r\n    try {\r\n      const res = await fetch(`/api/users/${encodeURIComponent(String(idToUse))}`, { signal });\r\n      if (!res.ok) {\r\n        const txt = await res.text().catch(() => '');\r\n        throw new Error(txt || `Failed to load user (${res.status})`);\r\n      }\r\n      const json = await res.json();\r\n      // populate\r\n      initialRef.current = json;\r\n      setForm({\r\n        firstName: json?.firstName ?? '',\r\n        lastName: json?.lastName ?? '',\r\n        username: json?.username ?? '',\r\n        email: json?.email ?? '',\r\n        password: '',\r\n        confirmPassword: '',\r\n        role: json?.role ?? '',\r\n      });\r\n      setImageUrl(json?.image ?? '');\r\n      setImagePreview(json?.image ?? null);\r\n\r\n      // Toggles from props\r\n      setChangePassword(Boolean(forceChangePassword));\r\n      setChangeUsername(Boolean(forceChangeUsername));\r\n      setNewPassword('');\r\n      setConfirmNewPassword('');\r\n      setNewUsername('');\r\n      setConfirmNewUsername('');\r\n      setUsernameInvalid(false);\r\n      setError('');\r\n      setSuccess('');\r\n    } catch (err: any) {\r\n      if (err.name === 'AbortError') return;\r\n      setFetchError(err?.message || 'Failed to load user');\r\n    } finally {\r\n      setLoadingUser(false);\r\n    }\r\n  }\r\n\r\n  // If in edit mode and we have a userId, default behavior is to fetch the latest user data to populate the form.\r\n  useEffect(() => {\r\n    let controller: AbortController | null = null;\r\n    const shouldFetch = isEdit && (userId ?? initialRef.current?.id);\r\n    if (!shouldFetch) return;\r\n\r\n    controller = new AbortController();\r\n    fetchUserData(controller.signal);\r\n\r\n    return () => {\r\n      if (controller) controller.abort();\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [isEdit, userId]);\r\n\r\n  // If parent provides initialData explicitly (e.g., dashboard passed it), keep form in sync with that too.\r\n  useEffect(() => {\r\n    if (!initialData) return;\r\n    setForm({\r\n      firstName: initialData?.firstName ?? '',\r\n      lastName: initialData?.lastName ?? '',\r\n      username: initialData?.username ?? '',\r\n      email: initialData?.email ?? '',\r\n      password: '',\r\n      confirmPassword: '',\r\n      role: initialData?.role ?? '',\r\n    });\r\n    setImageUrl(initialData?.image || '');\r\n    setImagePreview(initialData?.image || null);\r\n    setImageFile(null);\r\n    setImageToDelete(null);\r\n\r\n    setChangePassword(Boolean(forceChangePassword));\r\n    setChangeUsername(Boolean(forceChangeUsername));\r\n    setNewPassword('');\r\n    setConfirmNewPassword('');\r\n    setNewUsername('');\r\n    setConfirmNewUsername('');\r\n    setError('');\r\n    setSuccess('');\r\n    setUsernameInvalid(false);\r\n    initialRef.current = initialData;\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [initialData]);\r\n\r\n  // Smart username availability/exact check:\r\n  // - When creating: checkAvailable\r\n  // - When editing:\r\n  //    - if user edits the main username input (form.username !== orig.username): checkAvailable\r\n  //    - else (unchanged): checkExact (validates that server still has same username)\r\n  const handleUsernameBlur = async () => {\r\n    if (!form.username) return;\r\n    try {\r\n      setCheckingUsername(true);\r\n\r\n      const origUsername = initialRef.current?.username;\r\n      const idToUse = userId ?? initialRef.current?.id;\r\n\r\n      let url: string;\r\n      if (mode === 'edit' && idToUse) {\r\n        if (form.username !== origUsername) {\r\n          // user changed main username field -> check availability\r\n          url = `/api/users?checkAvailable=1&username=${encodeURIComponent(form.username)}`;\r\n        } else {\r\n          // unchanged -> verify exact\r\n          url = `/api/users?checkExact=1&userId=${encodeURIComponent(\r\n            String(idToUse)\r\n          )}&username=${encodeURIComponent(form.username)}`;\r\n        }\r\n      } else {\r\n        // create mode\r\n        url = `/api/users?checkAvailable=1&username=${encodeURIComponent(form.username)}`;\r\n      }\r\n\r\n      const res = await fetch(url);\r\n      if (!res.ok) {\r\n        setUsernameInvalid(false);\r\n        setCheckingUsername(false);\r\n        return;\r\n      }\r\n      const data = await res.json().catch(() => null);\r\n      const valid = data && (data.valid === true || data.available === true || data.ok === true);\r\n      setUsernameInvalid(!valid);\r\n    } catch {\r\n      setUsernameInvalid(false);\r\n    } finally {\r\n      setCheckingUsername(false);\r\n    }\r\n  };\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\r\n    setForm({ ...form, [e.target.name]: e.target.value });\r\n    setError('');\r\n    setSuccess('');\r\n    if (e.target.name === 'username') setUsernameInvalid(false);\r\n  };\r\n\r\n  const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0] || null;\r\n    if (file) {\r\n      if (imageUrl) setImageToDelete(imageUrl);\r\n      setImageFile(file);\r\n      setImagePreview(URL.createObjectURL(file));\r\n    }\r\n  };\r\n\r\n  const handleImageDelete = async () => {\r\n    if (imageUrl) setImageToDelete(imageUrl);\r\n    setImageFile(null);\r\n    setImageUrl('');\r\n    setImagePreview(null);\r\n    const idToUse = userId ?? initialRef.current?.id;\r\n    if (idToUse && imageUrl) {\r\n      try {\r\n        // Merged route: POST /api/users with JSON { imageUrl } to delete image\r\n        const res = await fetch('/api/users', {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({ imageUrl }),\r\n        });\r\n        if (!res.ok) {\r\n          // ignore failures for delete-image\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n  };\r\n\r\n  // Animated dots for submit button\r\n  useEffect(() => {\r\n    let dotInterval: any;\r\n    if (isSubmitting) {\r\n      dotInterval = setInterval(() => {\r\n        setRegisterDot((prev) => (prev + 1) % 3);\r\n      }, 400);\r\n    } else {\r\n      setRegisterDot(0);\r\n    }\r\n    return () => {\r\n      if (dotInterval) clearInterval(dotInterval);\r\n    };\r\n  }, [isSubmitting]);\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setError('');\r\n    setSuccess('');\r\n    setIsSubmitting(true);\r\n\r\n    // --- Validation ---\r\n    // If showOnly restricts the UI, validate only relevant fields\r\n    if (!isEdit) {\r\n      // create mode validation\r\n      if (showOnly === 'all' || showOnly === 'profile') {\r\n        if (\r\n          !form.firstName ||\r\n          !form.lastName ||\r\n          !form.username ||\r\n          !form.email ||\r\n          (!imageFile && !imagePreview)\r\n        ) {\r\n          setError('All profile fields and image are required');\r\n          setIsSubmitting(false);\r\n          return;\r\n        }\r\n      }\r\n      if (showOnly === 'all' || showOnly === 'password') {\r\n        if (!form.password || !form.confirmPassword) {\r\n          setError('Password and confirmation are required');\r\n          setIsSubmitting(false);\r\n          return;\r\n        }\r\n        if (form.password !== form.confirmPassword) {\r\n          setError('Passwords do not match');\r\n          setIsSubmitting(false);\r\n          return;\r\n        }\r\n      }\r\n    } else {\r\n      // edit mode validation\r\n\r\n      // Determine if username is being changed:\r\n      // - changeUsername checkbox (explicit)\r\n      // - OR user edited main username input (form.username !== orig.username)\r\n      const orig = initialRef.current ?? {};\r\n      const usernameEdited = form.username !== (orig.username ?? '');\r\n      const wantsUsernameChangeExplicit = changeUsername;\r\n      const wantsUsernameChange = wantsUsernameChangeExplicit || usernameEdited;\r\n\r\n      if (wantsUsernameChangeExplicit) {\r\n        // explicit flow requires newUsername + confirmNewUsername and they must match\r\n        if (!newUsername || !confirmNewUsername) {\r\n          setError('Please provide the new username and confirmation');\r\n          setIsSubmitting(false);\r\n          return;\r\n        }\r\n        if (newUsername !== confirmNewUsername) {\r\n          setError('New usernames do not match');\r\n          setIsSubmitting(false);\r\n          return;\r\n        }\r\n      }\r\n\r\n      if ((showOnly === 'all' || showOnly === 'password' || changePassword) && changePassword) {\r\n        if (!newPassword || !confirmNewPassword) {\r\n          setError('Please provide the new password and confirmation');\r\n          setIsSubmitting(false);\r\n          return;\r\n        }\r\n        if (newPassword !== confirmNewPassword) {\r\n          setError('New passwords do not match');\r\n          setIsSubmitting(false);\r\n          return;\r\n        }\r\n      }\r\n      if (usernameInvalid) {\r\n        setError('The Username appears invalid');\r\n        setIsSubmitting(false);\r\n        return;\r\n      }\r\n      if (!userId && !initialRef.current?.id) {\r\n        setError('Invalid form mode or missing user ID');\r\n        setIsSubmitting(false);\r\n        return;\r\n      }\r\n    }\r\n\r\n    try {\r\n      const formData = new FormData();\r\n\r\n      if (!isEdit) {\r\n        if (showOnly === 'all' || showOnly === 'profile') {\r\n          formData.append('firstName', form.firstName);\r\n          formData.append('lastName', form.lastName);\r\n          formData.append('username', form.username);\r\n          formData.append('email', form.email);\r\n          if (imageFile) formData.append('image', imageFile);\r\n        }\r\n        if (showOnly === 'all' || showOnly === 'password') {\r\n          formData.append('password', form.password);\r\n        }\r\n        // include role on create when present\r\n        if ((showOnly === 'all' || showOnly === 'profile') && form.role) {\r\n          formData.append('role', form.role);\r\n        }\r\n      } else {\r\n        const orig = initialRef.current ?? {};\r\n\r\n        // include original username to help server-side checks\r\n        if (orig.username) formData.append('username', orig.username);\r\n        else if (form.username) formData.append('username', form.username);\r\n\r\n        if (showOnly === 'all' || showOnly === 'profile') {\r\n          if (form.firstName !== (orig.firstName ?? ''))\r\n            formData.append('firstName', form.firstName);\r\n          if (form.lastName !== (orig.lastName ?? '')) formData.append('lastName', form.lastName);\r\n          if (form.email !== (orig.email ?? '')) formData.append('email', form.email);\r\n          if (imageFile) formData.append('image', imageFile);\r\n          if (imageToDelete) formData.append('oldImageUrl', imageToDelete);\r\n\r\n          // include role in edit (always include if provided)\r\n          if (form.role && form.role !== (orig.role ?? '')) {\r\n            formData.append('role', form.role);\r\n          } else if (form.role) {\r\n            // even if unchanged, include to make server-side handling simple\r\n            formData.append('role', form.role);\r\n          }\r\n        }\r\n\r\n        // username change flow:\r\n        // - explicit (checkbox): use newUsername (and confirmation validated)\r\n        // - implicit (user edited main username input): send newUsername = form.username\r\n        const origUsername = orig.username ?? '';\r\n        if (changeUsername) {\r\n          formData.append('newUsername', newUsername || form.username);\r\n        } else if (form.username !== origUsername) {\r\n          // user edited the main username input without checking the box -> treat as username change\r\n          formData.append('newUsername', form.username);\r\n        }\r\n\r\n        // password change flow (explicit or via showOnly)\r\n        if (changePassword || showOnly === 'password') {\r\n          const pw = changePassword ? newPassword : form.password;\r\n          if (pw) formData.append('password', pw);\r\n        } else if (form.password) {\r\n          // backwards compatibility: if user typed in main password field, include it\r\n          formData.append('password', form.password);\r\n        }\r\n      }\r\n\r\n      let res;\r\n      if (isEdit) {\r\n        const idToUse = userId ?? initialRef.current?.id;\r\n        res = await fetch(`/api/users/${encodeURIComponent(String(idToUse))}`, {\r\n          method: 'PATCH',\r\n          body: formData,\r\n        });\r\n      } else {\r\n        res = await fetch('/api/users', {\r\n          method: 'POST',\r\n          body: formData,\r\n        });\r\n      }\r\n\r\n      const data = await res.json().catch(() => null);\r\n      if (!res.ok) throw new Error((data && (data.error || data.message)) || 'Operation failed');\r\n\r\n      setSuccess(isEdit ? 'User updated!' : 'User created!');\r\n\r\n      // Call onSuccess with the returned user (for optimistic parent updates)\r\n      if (data?.user && onSuccess) {\r\n        try {\r\n          onSuccess(data.user);\r\n        } catch {\r\n          // ignore parent errors\r\n        }\r\n      } else if (onSuccess) {\r\n        try {\r\n          onSuccess(data ?? undefined);\r\n        } catch {\r\n          // ignore\r\n        }\r\n      }\r\n\r\n      if (!isEdit) {\r\n        const cameFrom = getCameFrom();\r\n        sessionStorage.removeItem('came-from');\r\n        setTimeout(() => {\r\n          router.push(cameFrom);\r\n        }, 800);\r\n      } else {\r\n        if (data?.user) {\r\n          setImageUrl(data.user.image || '');\r\n          setImagePreview(data.user.image || null);\r\n          setForm((f) => ({\r\n            ...f,\r\n            username: data.user.username || f.username,\r\n            role: data.user.role ?? f.role,\r\n          }));\r\n          initialRef.current = { ...(initialRef.current || {}), ...data.user };\r\n        }\r\n      }\r\n    } catch (err: any) {\r\n      setError(err?.message || 'Something went wrong');\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    if (onCancel) onCancel();\r\n    else router.back();\r\n  };\r\n\r\n  const handleDelete = async () => {\r\n    const idToUse = userId ?? initialRef.current?.id;\r\n    if (!idToUse) return;\r\n    if (!window.confirm('Are you sure you want to delete this user? This action cannot be undone.'))\r\n      return;\r\n    setDeleting(true);\r\n    try {\r\n      const res = await fetch(`/api/users/${encodeURIComponent(String(idToUse))}`, {\r\n        method: 'DELETE',\r\n      });\r\n      if (!res.ok) {\r\n        const data = await res.json().catch(() => null);\r\n        throw new Error(data?.error || 'Failed to delete user');\r\n      }\r\n      if (onDelete) onDelete(String(idToUse));\r\n      if (onSuccess) onSuccess(undefined);\r\n      router.refresh();\r\n      router.push('/admin/dashboard');\r\n    } catch (err: any) {\r\n      setError(err.message || 'Something went wrong');\r\n    } finally {\r\n      setDeleting(false);\r\n    }\r\n  };\r\n\r\n  // Retry fetch user (exposed in UI when fetchError is set)\r\n  const retryFetchUser = () => {\r\n    setFetchError(null);\r\n    fetchUserData();\r\n  };\r\n\r\n  // Render\r\n  // If showOnly restricts UI, we render only matching sections:\r\n  const renderProfileFields = () => (\r\n    <>\r\n      {/* User Image */}\r\n      <div className=\"flex flex-col items-center\">\r\n        <label className=\"text-sm block mb-1\">Profile image</label>\r\n        {imagePreview ? (\r\n          <div className=\"relative flex flex-col items-center\">\r\n            <img\r\n              src={imagePreview}\r\n              alt=\"User\"\r\n              className=\"w-24 h-24 rounded-full object-cover border mx-auto\"\r\n            />\r\n            <button\r\n              type=\"button\"\r\n              className=\"absolute top-0 right-0 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center -mt-2 -mr-2\"\r\n              onClick={handleImageDelete}\r\n              title=\"Delete Image\"\r\n            >\r\n              ×\r\n            </button>\r\n          </div>\r\n        ) : (\r\n          <div className=\"w-24 h-24 rounded-full border flex items-center justify-center mb-2 text-gray-400\">\r\n            No Image\r\n          </div>\r\n        )}\r\n        <input\r\n          type=\"file\"\r\n          accept=\"image/*\"\r\n          onChange={handleImageChange}\r\n          className=\"mt-2 mb-2 block\"\r\n        />\r\n      </div>\r\n\r\n      {/* Name row */}\r\n      <div className=\"flex gap-4\">\r\n        <div className=\"w-1/2\">\r\n          <label className=\"text-sm block mb-1\">First name</label>\r\n          <input\r\n            name=\"firstName\"\r\n            placeholder=\"First Name\"\r\n            value={form.firstName}\r\n            onChange={handleChange}\r\n            className=\"border p-2 rounded w-full\"\r\n          />\r\n        </div>\r\n        <div className=\"w-1/2\">\r\n          <label className=\"text-sm block mb-1\">Last name</label>\r\n          <input\r\n            name=\"lastName\"\r\n            placeholder=\"Last Name\"\r\n            value={form.lastName}\r\n            onChange={handleChange}\r\n            className=\"border p-2 rounded w-full\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Username and Email */}\r\n      <div className=\"flex gap-4\">\r\n        <div className=\"w-1/2\">\r\n          <label className=\"text-sm block mb-1\">Username</label>\r\n          <input\r\n            name=\"username\"\r\n            placeholder=\"Username\"\r\n            value={form.username}\r\n            onChange={handleChange}\r\n            onBlur={handleUsernameBlur}\r\n            className={`border p-2 rounded w-full ${usernameInvalid ? 'border-red-500' : ''}`}\r\n            autoComplete=\"off\"\r\n            disabled={changeUsername || showOnly === 'username'}\r\n          />\r\n        </div>\r\n        <div className=\"w-1/2\">\r\n          <label className=\"text-sm block mb-1\">Email</label>\r\n          <input\r\n            name=\"email\"\r\n            type=\"email\"\r\n            placeholder=\"Email\"\r\n            value={form.email}\r\n            onChange={handleChange}\r\n            className=\"border p-2 rounded w-full\"\r\n            autoComplete=\"off\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Role select (visible in both create and edit profile sections) */}\r\n      <div className=\"mt-2\">\r\n        <label className=\"text-sm block mb-1\">Role</label>\r\n        <select\r\n          name=\"role\"\r\n          value={form.role}\r\n          onChange={handleChange}\r\n          className=\"border p-2 rounded w-full\"\r\n        >\r\n          <option value=\"\">— select role —</option>\r\n          {ROLE_OPTIONS.map((r) => (\r\n            <option key={r.value} value={r.value}>\r\n              {r.label}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n    </>\r\n  );\r\n\r\n  const renderUsernameChange = () => (\r\n    <div className=\"border rounded p-3 bg-gray-50 dark:bg-gray-800\">\r\n      <label className=\"flex items-center gap-2\">\r\n        <input\r\n          type=\"checkbox\"\r\n          checked={changeUsername}\r\n          onChange={() => {\r\n            setChangeUsername(!changeUsername);\r\n            setNewUsername('');\r\n            setConfirmNewUsername('');\r\n            setError('');\r\n          }}\r\n        />\r\n        <span className=\"text-sm font-medium\">Change username</span>\r\n      </label>\r\n\r\n      {changeUsername && (\r\n        <div className=\"mt-3 space-y-2\">\r\n          <div>\r\n            <label className=\"text-sm block mb-1\">New username</label>\r\n            <input\r\n              placeholder=\"New username\"\r\n              value={newUsername}\r\n              onChange={(e) => setNewUsername(e.target.value)}\r\n              className=\"border p-2 rounded w-full\"\r\n              autoComplete=\"off\"\r\n            />\r\n          </div>\r\n          <div>\r\n            <label className=\"text-sm block mb-1\">Confirm new username</label>\r\n            <input\r\n              placeholder=\"Confirm new username\"\r\n              value={confirmNewUsername}\r\n              onChange={(e) => setConfirmNewUsername(e.target.value)}\r\n              className=\"border p-2 rounded w-full\"\r\n              autoComplete=\"off\"\r\n            />\r\n          </div>\r\n          <div className=\"text-xs text-muted-foreground\">\r\n            If you change username, you'll be updating the account handle.\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n\r\n  const renderPasswordChange = () => (\r\n    <div className=\"border rounded p-3 bg-gray-50 dark:bg-gray-800\">\r\n      <label className=\"flex items-center gap-2\">\r\n        <input\r\n          type=\"checkbox\"\r\n          checked={changePassword}\r\n          onChange={() => {\r\n            setChangePassword(!changePassword);\r\n            setNewPassword('');\r\n            setConfirmNewPassword('');\r\n            setError('');\r\n          }}\r\n        />\r\n        <span className=\"text-sm font-medium\">Change password</span>\r\n      </label>\r\n\r\n      {changePassword && (\r\n        <div className=\"mt-3 flex gap-4\">\r\n          <div className=\"w-1/2\">\r\n            <label className=\"text-sm block mb-1\">New password</label>\r\n            <input\r\n              type=\"password\"\r\n              placeholder=\"New password\"\r\n              value={newPassword}\r\n              onChange={(e) => setNewPassword(e.target.value)}\r\n              className=\"border p-2 rounded w-full\"\r\n              autoComplete=\"new-password\"\r\n            />\r\n          </div>\r\n          <div className=\"w-1/2\">\r\n            <label className=\"text-sm block mb-1\">Confirm new password</label>\r\n            <input\r\n              type=\"password\"\r\n              placeholder=\"Confirm new password\"\r\n              value={confirmNewPassword}\r\n              onChange={(e) => setConfirmNewPassword(e.target.value)}\r\n              className=\"border p-2 rounded w-full\"\r\n              autoComplete=\"new-password\"\r\n            />\r\n          </div>\r\n        </div>\r\n      )}\r\n      {!changePassword && (\r\n        <div className=\"text-xs text-muted-foreground mt-2\">\r\n          Leave password blank to keep existing password.\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div className=\"flex max-w-lg items-center justify-center mx-auto\">\r\n      {loadingUser ? (\r\n        <div className=\"p-6 text-center\">Loading…</div>\r\n      ) : fetchError ? (\r\n        <div className=\"p-6 text-center\">\r\n          <div className=\"text-red-600 mb-2\">Failed to load user: {fetchError}</div>\r\n          <div className=\"flex gap-2 justify-center\">\r\n            <button onClick={retryFetchUser} className=\"px-3 py-2 bg-blue-600 text-white rounded\">\r\n              Retry\r\n            </button>\r\n            <button onClick={handleCancel} className=\"px-3 py-2 bg-gray-200 rounded\">\r\n              Close\r\n            </button>\r\n          </div>\r\n        </div>\r\n      ) : (\r\n        <form onSubmit={handleSubmit} className=\"space-y-6 w-full\">\r\n          {(showOnly === 'all' || showOnly === 'profile') && renderProfileFields()}\r\n\r\n          {/* show username change section when requested (checkbox) */}\r\n          {(showOnly === 'all' || showOnly === 'username') && isEdit && renderUsernameChange()}\r\n\r\n          {/* show password fields depending on mode and showOnly */}\r\n          {!isEdit && (showOnly === 'all' || showOnly === 'password') && (\r\n            <div className=\"flex gap-4\">\r\n              <div className=\"w-1/2\">\r\n                <label className=\"text-sm block mb-1\">Password</label>\r\n                <input\r\n                  type=\"password\"\r\n                  name=\"password\"\r\n                  placeholder=\"Password\"\r\n                  onChange={handleChange}\r\n                  value={form.password}\r\n                  className=\"border p-2 rounded w-full\"\r\n                  autoComplete=\"new-password\"\r\n                />\r\n              </div>\r\n              <div className=\"w-1/2\">\r\n                <label className=\"text-sm block mb-1\">Confirm Password</label>\r\n                <input\r\n                  type=\"password\"\r\n                  name=\"confirmPassword\"\r\n                  placeholder=\"Confirm Password\"\r\n                  onChange={handleChange}\r\n                  value={form.confirmPassword}\r\n                  className=\"border p-2 rounded w-full\"\r\n                  autoComplete=\"new-password\"\r\n                />\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {isEdit && (showOnly === 'all' || showOnly === 'password') && renderPasswordChange()}\r\n\r\n          {error && <p className=\"text-red-500 text-sm\">{error}</p>}\r\n          {success && <p className=\"text-green-600 text-sm\">{success}</p>}\r\n\r\n          {/* Actions */}\r\n          <div className=\"flex gap-3\">\r\n            {/* Primary: when showOnly restricts to a section, change label accordingly */}\r\n            <button\r\n              type=\"submit\"\r\n              className=\"w-1/2 bg-green-600 text-white py-2 rounded flex items-center justify-center\"\r\n              disabled={\r\n                isSubmitting ||\r\n                checkingUsername ||\r\n                usernameInvalid ||\r\n                (!isEdit &&\r\n                  (showOnly === 'password'\r\n                    ? form.password !== form.confirmPassword\r\n                    : showOnly === 'all' && form.password !== form.confirmPassword)) ||\r\n                (isEdit && changePassword && newPassword !== confirmNewPassword) ||\r\n                (isEdit && changeUsername && newUsername !== confirmNewUsername)\r\n              }\r\n            >\r\n              {isEdit\r\n                ? showOnly === 'password'\r\n                  ? 'Change password'\r\n                  : showOnly === 'username'\r\n                  ? 'Change username'\r\n                  : 'Save changes'\r\n                : 'Register'}\r\n              {isSubmitting && (\r\n                <span className=\"ml-2 flex\">\r\n                  {[0, 1, 2].map((i) => (\r\n                    <span\r\n                      key={i}\r\n                      className={`transition-all w-1.5 h-1.5 rounded-full mx-0.5 inline-block ${\r\n                        registerDot === i ? 'bg-white' : 'bg-green-900 opacity-40'\r\n                      }`}\r\n                    ></span>\r\n                  ))}\r\n                </span>\r\n              )}\r\n            </button>\r\n\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleCancel}\r\n              className=\"w-1/2 bg-black text-white py-2 rounded\"\r\n              disabled={deleting}\r\n            >\r\n              Cancel\r\n            </button>\r\n          </div>\r\n\r\n          {isEdit &&\r\n            (userId ?? initialRef.current?.id) &&\r\n            showOnly !== 'password' &&\r\n            showOnly !== 'username' && (\r\n              <div className=\"flex flex-col gap-2\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleDelete}\r\n                  className=\"w-full bg-red-600 text-white py-2 rounded mt-2\"\r\n                  disabled={deleting}\r\n                >\r\n                  {deleting ? 'Deleting...' : 'Delete User'}\r\n                </button>\r\n              </div>\r\n            )}\r\n        </form>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2994, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/sections/SettingsSection.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport { useSession, signOut } from 'next-auth/react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Home, User, Star, Target, Search, Gem } from 'lucide-react';\r\n\r\n/**\r\n * SettingsSection\r\n *\r\n * - Header: \"User Settings\" title (icon) only.\r\n * - Profile block moved BELOW the title and ABOVE the \"Edit your profile...\" paragraph.\r\n *   The profile block shows the avatar at left and the name/username/email to the right of it.\r\n * - Action buttons are below the profile block and are laid out left-to-right.\r\n * - Role editing remains inside the embedded CreateUserForm (no duplicate Role select here).\r\n *\r\n * Full functionality preserved: fetching full profile, homepage editor, edit modal with CreateUserForm.\r\n */\r\n\r\nconst ROLE_OPTIONS = [\r\n  { value: 'super', label: 'Super' },\r\n  { value: 'admin', label: 'Admin' },\r\n  { value: 'moderator', label: 'Moderator' },\r\n  { value: 'beneficiary', label: 'Beneficiary' },\r\n  { value: 'guest', label: 'Guest' },\r\n] as const;\r\n\r\nexport default function SettingsSection({\r\n  currentUserId,\r\n  onOpenEdit,\r\n}: {\r\n  currentUserId?: string | number | null;\r\n  onOpenEdit?: (payload: {\r\n    id?: string | number | null;\r\n    forceChangePassword?: boolean;\r\n    forceChangeUsername?: boolean;\r\n  }) => void;\r\n}) {\r\n  const { data: session, status } = useSession();\r\n  const sessionUser = (session?.user as any) ?? null;\r\n  const sessionUserId = sessionUser?.id ?? null;\r\n\r\n  // prefer explicit prop id, otherwise session id\r\n  const id = currentUserId ?? sessionUserId;\r\n  const loading = status === 'loading';\r\n  const canEdit = !!sessionUser?.id;\r\n\r\n  // full user profile fetched from API (may include email/firstName/lastName/role/image)\r\n  const [currentUser, setCurrentUser] = useState<any | null>(null);\r\n  const [currentUserLoading, setCurrentUserLoading] = useState(false);\r\n  const [currentUserError, setCurrentUserError] = useState<string | null>(null);\r\n\r\n  // prefer displayUser (fetched) falling back to sessionUser\r\n  const displayUser = currentUser ?? sessionUser ?? null;\r\n\r\n  // Local state for Edit Profile modal\r\n  const [openLocalEditModal, setOpenLocalEditModal] = useState(false);\r\n  const [forceChangePassword, setForceChangePassword] = useState(false);\r\n  const [forceChangeUsername, setForceChangeUsername] = useState(false);\r\n\r\n  // delete account\r\n  const [deleteAccountLoading, setDeleteAccountLoading] = useState(false);\r\n  const [deleteAccountError, setDeleteAccountError] = useState<string | null>(null);\r\n  const [deleteAccountSuccess, setDeleteAccountSuccess] = useState<string | null>(null);\r\n\r\n  // homepage content\r\n  const [homeModalOpen, setHomeModalOpen] = useState(false);\r\n  const [homeLoading, setHomeLoading] = useState(false);\r\n  const [homeSaving, setHomeSaving] = useState(false);\r\n  const [homeError, setHomeError] = useState<string | null>(null);\r\n  const [homeSuccess, setHomeSuccess] = useState<string | null>(null);\r\n  const [homeData, setHomeData] = useState<{\r\n    id?: number | string;\r\n    heroVideo?: string;\r\n    vision?: string;\r\n    mission?: string;\r\n    focus?: string;\r\n    coreValues?: string;\r\n  } | null>(null);\r\n\r\n  // upload state (modal-only)\r\n  const [uploading, setUploading] = useState(false);\r\n  const [uploadProgress, setUploadProgress] = useState<number | null>(null);\r\n  const [uploadError, setUploadError] = useState<string | null>(null);\r\n\r\n  const homeDataRef = useRef(homeData);\r\n  useEffect(() => {\r\n    homeDataRef.current = homeData;\r\n  }, [homeData]);\r\n\r\n  // Helper to open local edit modal (used by user settings controls)\r\n  function openLocalEdit(forPassword = false, forUsername = false) {\r\n    if (onOpenEdit) {\r\n      try {\r\n        onOpenEdit({ id, forceChangePassword: forPassword, forceChangeUsername: forUsername });\r\n      } catch {}\r\n    }\r\n    setForceChangePassword(Boolean(forPassword));\r\n    setForceChangeUsername(Boolean(forUsername));\r\n    setOpenLocalEditModal(true);\r\n  }\r\n\r\n  // fetch full current user profile when we have an id\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n    async function loadUser() {\r\n      if (!id) {\r\n        setCurrentUser(null);\r\n        return;\r\n      }\r\n      setCurrentUserLoading(true);\r\n      setCurrentUserError(null);\r\n      try {\r\n        const res = await fetch(`/api/users/${encodeURIComponent(String(id))}`, {\r\n          credentials: 'same-origin',\r\n        });\r\n        if (!res.ok) {\r\n          const txt = await res.text().catch(() => '');\r\n          throw new Error(txt || `Failed to load user (${res.status})`);\r\n        }\r\n        const json = await res.json();\r\n        if (!cancelled) setCurrentUser(json);\r\n      } catch (err: any) {\r\n        console.error('Failed to fetch current user', err);\r\n        if (!cancelled) setCurrentUserError(err?.message || 'Failed to load user');\r\n      } finally {\r\n        if (!cancelled) setCurrentUserLoading(false);\r\n      }\r\n    }\r\n    loadUser();\r\n    return () => {\r\n      cancelled = true;\r\n    };\r\n  }, [id]);\r\n\r\n  // Use new endpoint base\r\n  const ENDPOINT_BASE = '/api/homepage';\r\n\r\n  // Helper to extract last path segment (filename) without extension\r\n  function getVideoNameFromUrl(url?: string | null) {\r\n    if (!url) return '';\r\n    try {\r\n      const pathPart = url.split('?')[0].split('#')[0];\r\n      const last = pathPart.split('/').filter(Boolean).pop() ?? '';\r\n      return last.replace(/\\.[^/.]+$/, '');\r\n    } catch {\r\n      return '';\r\n    }\r\n  }\r\n\r\n  // Field icons (smaller: h-6 w-6) with tonal primary colors\r\n  function getFieldIcon(label: 'Vision' | 'Mission' | 'Focus' | 'Core values') {\r\n    const base = 'h-6 w-6';\r\n    switch (label) {\r\n      case 'Vision':\r\n        return <Star className={`${base} text-primary-400`} aria-hidden />;\r\n      case 'Mission':\r\n        return <Target className={`${base} text-primary-500`} aria-hidden />;\r\n      case 'Focus':\r\n        return <Search className={`${base} text-primary-600`} aria-hidden />;\r\n      case 'Core values':\r\n        return <Gem className={`${base} text-primary-700`} aria-hidden />;\r\n      default:\r\n        return <Star className={`${base} text-primary-500`} aria-hidden />;\r\n    }\r\n  }\r\n\r\n  // Fetch latest homepage content\r\n  async function fetchHomeContent() {\r\n    setHomeLoading(true);\r\n    setHomeError(null);\r\n    try {\r\n      const res = await fetch(ENDPOINT_BASE, { credentials: 'same-origin' });\r\n      if (!res.ok) {\r\n        if (res.status === 404) {\r\n          setHomeData(null);\r\n        } else {\r\n          const txt = await res.text().catch(() => '');\r\n          throw new Error(txt || `Failed to load homepage (${res.status})`);\r\n        }\r\n      } else {\r\n        const json = await res.json();\r\n        setHomeData({\r\n          id: json?.id,\r\n          heroVideo: json?.heroVideo ?? '',\r\n          vision: json?.vision ?? '',\r\n          mission: json?.mission ?? '',\r\n          focus: json?.focus ?? '',\r\n          coreValues: json?.coreValues ?? '',\r\n        });\r\n      }\r\n    } catch (err: any) {\r\n      console.error('fetchHomeContent error:', err);\r\n      setHomeError(err?.message || 'Failed to load homepage content');\r\n    } finally {\r\n      setHomeLoading(false);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    fetchHomeContent();\r\n    function handleVisibility() {\r\n      if (document.visibilityState === 'visible') fetchHomeContent();\r\n    }\r\n    document.addEventListener('visibilitychange', handleVisibility);\r\n    return () => document.removeEventListener('visibilitychange', handleVisibility);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  function openHomeModal() {\r\n    setHomeError(null);\r\n    setHomeSuccess(null);\r\n    setHomeModalOpen(true);\r\n    fetchHomeContent();\r\n  }\r\n\r\n  function closeHomeModal() {\r\n    setHomeModalOpen(false);\r\n    setHomeError(null);\r\n    setHomeSuccess(null);\r\n    setUploadError(null);\r\n    setUploadProgress(null);\r\n  }\r\n\r\n  // Upload helper: upload file to POST /api/homepage (multipart/form-data)\r\n  async function uploadHeroVideoFile(file: File) {\r\n    setUploadError(null);\r\n\r\n    const maxSizeBytes = 50 * 1024 * 1024; // 50MB\r\n    if (file.size > maxSizeBytes) {\r\n      throw new Error('File is too large. Max 50MB allowed.');\r\n    }\r\n\r\n    const ext = file.name?.split('.').pop()?.toLowerCase() ?? '';\r\n    if (!['mov', 'mp4', 'gif'].includes(ext)) {\r\n      throw new Error('Unsupported file extension. Allowed: .mov, .mp4, .gif');\r\n    }\r\n    if (!file.type.startsWith('video/') && ext !== 'gif') {\r\n      throw new Error('Unsupported file type. Please select a video or gif file.');\r\n    }\r\n\r\n    setUploading(true);\r\n    setUploadProgress(0);\r\n\r\n    return await new Promise<string>((resolve, reject) => {\r\n      const xhr = new XMLHttpRequest();\r\n      xhr.open('POST', ENDPOINT_BASE, true);\r\n      xhr.withCredentials = true;\r\n      xhr.timeout = 120000; // 2 minutes\r\n\r\n      xhr.upload.onprogress = (ev) => {\r\n        if (ev.lengthComputable) {\r\n          const pct = Math.round((ev.loaded / ev.total) * 100);\r\n          setUploadProgress(pct);\r\n        }\r\n      };\r\n\r\n      xhr.onload = () => {\r\n        setUploading(false);\r\n        setUploadProgress(null);\r\n        const status = xhr.status;\r\n        const respText = xhr.responseText ?? '';\r\n\r\n        let json: any = null;\r\n        try {\r\n          json = respText ? JSON.parse(respText) : null;\r\n        } catch {\r\n          json = null;\r\n        }\r\n\r\n        if (status >= 200 && status < 300) {\r\n          if (json?.url) return resolve(json.url);\r\n          if (json?.heroVideo) return resolve(json.heroVideo);\r\n          if (typeof respText === 'string' && respText.startsWith('/')) return resolve(respText);\r\n          if (respText.trim().startsWith('<')) {\r\n            console.error('Server returned HTML during upload:', respText.slice(0, 300));\r\n            return reject(\r\n              new Error('Server error during upload (returned HTML). Check server logs.')\r\n            );\r\n          }\r\n          return reject(new Error('Upload succeeded but server did not return a usable url.'));\r\n        } else {\r\n          const serverMsg = json?.error || json?.message || respText || `Upload failed (${status})`;\r\n          if (typeof serverMsg === 'string' && serverMsg.trim().startsWith('<')) {\r\n            console.error('Server returned HTML on error:', serverMsg.slice(0, 400));\r\n            return reject(\r\n              new Error(`Upload failed (${status}). Server returned HTML — check server logs.`)\r\n            );\r\n          }\r\n          return reject(new Error(serverMsg));\r\n        }\r\n      };\r\n\r\n      xhr.onerror = () => {\r\n        setUploading(false);\r\n        setUploadProgress(null);\r\n        const respText = xhr.responseText ?? '';\r\n        if (respText.trim().startsWith('<')) {\r\n          console.error('XHR network error, server returned HTML:', respText.slice(0, 400));\r\n          return reject(\r\n            new Error('Network error during upload and server returned HTML. Check server logs.')\r\n          );\r\n        }\r\n        const status = xhr.status || 0;\r\n        return reject(new Error(respText || `Network error during upload (status ${status}).`));\r\n      };\r\n\r\n      xhr.ontimeout = () => {\r\n        setUploading(false);\r\n        setUploadProgress(null);\r\n        reject(new Error('Upload timed out. Try a smaller file or check your connection.'));\r\n      };\r\n\r\n      const form = new FormData();\r\n      form.append('file', file, file.name);\r\n      form.append('ownerId', String(id ?? ''));\r\n      xhr.send(form);\r\n    });\r\n  }\r\n\r\n  // Modal file input handler\r\n  async function handleHeroFileChange(e: React.ChangeEvent<HTMLInputElement>) {\r\n    setUploadError(null);\r\n    const file = e.target.files?.[0];\r\n    if (!file) return;\r\n    try {\r\n      const url = await uploadHeroVideoFile(file);\r\n      setHomeData((d) => ({ ...(d ?? {}), heroVideo: url }));\r\n      setUploadError(null);\r\n    } catch (err: any) {\r\n      console.error('handleHeroFileChange error:', err);\r\n      setUploadError(err?.message || 'Upload failed');\r\n    } finally {\r\n      try {\r\n        (e.target as HTMLInputElement).value = '';\r\n      } catch {}\r\n    }\r\n  }\r\n\r\n  // Save homepage content (create or update)\r\n  async function saveHomeContent(e?: React.FormEvent) {\r\n    if (e) e.preventDefault();\r\n    setHomeError(null);\r\n    setHomeSuccess(null);\r\n\r\n    const dataToSend = {\r\n      heroVideo: homeData?.heroVideo ?? '',\r\n      vision: homeData?.vision ?? '',\r\n      mission: homeData?.mission ?? '',\r\n      focus: homeData?.focus ?? '',\r\n      coreValues: homeData?.coreValues ?? '',\r\n    };\r\n\r\n    if (\r\n      !dataToSend.heroVideo.trim() ||\r\n      !dataToSend.vision.trim() ||\r\n      !dataToSend.mission.trim() ||\r\n      !dataToSend.focus.trim() ||\r\n      !dataToSend.coreValues.trim()\r\n    ) {\r\n      setHomeError('All fields are required');\r\n      return;\r\n    }\r\n\r\n    const previous = homeDataRef.current;\r\n    setHomeData((d) => ({ ...(d ?? {}), ...dataToSend }));\r\n\r\n    setHomeSaving(true);\r\n    try {\r\n      let res: Response;\r\n      if (homeData?.id) {\r\n        res = await fetch(`${ENDPOINT_BASE}/${homeData.id}`, {\r\n          method: 'PATCH',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          credentials: 'same-origin',\r\n          body: JSON.stringify(dataToSend),\r\n        });\r\n      } else {\r\n        res = await fetch(ENDPOINT_BASE, {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          credentials: 'same-origin',\r\n          body: JSON.stringify(dataToSend),\r\n        });\r\n      }\r\n\r\n      const text = await res.text().catch(() => '');\r\n      let payload: any = null;\r\n      try {\r\n        payload = text ? JSON.parse(text) : null;\r\n      } catch {\r\n        payload = null;\r\n      }\r\n\r\n      if (!res.ok) {\r\n        const serverMsg =\r\n          payload?.error || payload?.message || text || `Save failed (${res.status})`;\r\n        if (typeof serverMsg === 'string' && serverMsg.trim().startsWith('<')) {\r\n          console.error('Server returned HTML on save:', serverMsg.slice(0, 800));\r\n          throw new Error('Server error during save (returned HTML). Check server logs.');\r\n        }\r\n        throw new Error(serverMsg);\r\n      }\r\n\r\n      const body = payload ?? null;\r\n      setHomeData({\r\n        id: body?.id ?? homeData?.id,\r\n        heroVideo: body?.heroVideo ?? dataToSend.heroVideo,\r\n        vision: body?.vision ?? dataToSend.vision,\r\n        mission: body?.mission ?? dataToSend.mission,\r\n        focus: body?.focus ?? dataToSend.focus,\r\n        coreValues: body?.coreValues ?? dataToSend.coreValues,\r\n      });\r\n\r\n      setHomeSuccess('Homepage content saved');\r\n      try {\r\n        window.dispatchEvent(new CustomEvent('homepage:updated', { detail: { homepage: body } }));\r\n      } catch {}\r\n      setTimeout(() => {\r\n        setHomeSuccess(null);\r\n        setHomeModalOpen(false);\r\n      }, 900);\r\n    } catch (err: any) {\r\n      console.error('saveHomeContent error:', err);\r\n      setHomeError(err?.message || 'Failed to save homepage content');\r\n      try {\r\n        fetchHomeContent();\r\n      } catch {}\r\n    } finally {\r\n      setHomeSaving(false);\r\n    }\r\n  }\r\n\r\n  // Delete homepage content\r\n  async function deleteHomeContent() {\r\n    if (!homeData?.id) return;\r\n    if (!confirm('Are you sure you want to delete the homepage content?')) return;\r\n    setHomeSaving(true);\r\n    setHomeError(null);\r\n    const previous = homeDataRef.current;\r\n    setHomeData(null);\r\n    try {\r\n      const res = await fetch(`${ENDPOINT_BASE}/${homeData.id}`, {\r\n        method: 'DELETE',\r\n        credentials: 'same-origin',\r\n      });\r\n      const payload = await res.json().catch(() => null);\r\n      if (!res.ok) {\r\n        setHomeData(previous ?? null);\r\n        throw new Error((payload && payload.error) || `Delete failed (${res.status})`);\r\n      }\r\n      setHomeSuccess('Homepage content deleted');\r\n      try {\r\n        window.dispatchEvent(new CustomEvent('homepage:deleted', { detail: { id: homeData.id } }));\r\n      } catch {}\r\n      setTimeout(() => {\r\n        setHomeSuccess(null);\r\n        setHomeModalOpen(false);\r\n      }, 900);\r\n    } catch (err: any) {\r\n      console.error('deleteHomeContent error:', err);\r\n      setHomeError(err?.message || 'Failed to delete homepage content');\r\n      try {\r\n        fetchHomeContent();\r\n      } catch {}\r\n    } finally {\r\n      setHomeSaving(false);\r\n    }\r\n  }\r\n\r\n  // createDeletionRequest helper (POST /api/messages)\r\n  async function createDeletionRequest(payload: any) {\r\n    const res = await fetch('/api/messages', {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      credentials: 'same-origin',\r\n      body: JSON.stringify(payload),\r\n    });\r\n    const text = await res.text().catch(() => '');\r\n    let json: any = null;\r\n    try {\r\n      json = text ? JSON.parse(text) : null;\r\n    } catch {\r\n      json = null;\r\n    }\r\n    if (!res.ok) {\r\n      const serverMsg = json?.error || json?.message || text || `HTTP ${res.status}`;\r\n      const err = new Error(serverMsg);\r\n      (err as any).server = { status: res.status, bodyText: text, bodyJson: json };\r\n      throw err;\r\n    }\r\n    return json ?? { ok: true };\r\n  }\r\n\r\n  // Delete account handler\r\n  async function handleDeleteAccount() {\r\n    setDeleteAccountError(null);\r\n    setDeleteAccountSuccess(null);\r\n\r\n    if (!id) {\r\n      setDeleteAccountError('No user id available.');\r\n      return;\r\n    }\r\n\r\n    if (!confirm('Are you sure you want to delete your account? This action is permanent?')) {\r\n      return;\r\n    }\r\n\r\n    const role = (displayUser?.role ?? '').toString();\r\n\r\n    setDeleteAccountLoading(true);\r\n    try {\r\n      if (role === 'super') {\r\n        const res = await fetch(`/api/users/${id}`, {\r\n          method: 'DELETE',\r\n          credentials: 'same-origin',\r\n        });\r\n        if (!res.ok) {\r\n          const txt = await res.text().catch(() => '');\r\n          throw new Error(txt || 'Failed to delete account');\r\n        }\r\n        await signOut({ callbackUrl: '/' });\r\n        return;\r\n      } else {\r\n        const title = 'Account Deletion Request';\r\n        const content = `User ${\r\n          displayUser?.firstName || displayUser?.lastName\r\n            ? `${displayUser.firstName ?? ''} ${displayUser.lastName ?? ''}`.trim()\r\n            : displayUser?.username ?? displayUser?.email\r\n        } (id: ${id}) requests account deletion.`;\r\n        const payload: any = {\r\n          title,\r\n          content,\r\n          messageCategory: 'request',\r\n          allowResponses: true,\r\n          senderEmail: displayUser?.email ?? undefined,\r\n          meta: { type: 'account-deletion-request', requesterId: id },\r\n        };\r\n\r\n        await createDeletionRequest(payload);\r\n        setDeleteAccountSuccess('Deletion request submitted. Administrators have been notified.');\r\n      }\r\n    } catch (err: any) {\r\n      console.error('Delete account error:', err, (err as any)?.server);\r\n      setDeleteAccountError(err?.message || 'Failed to process request');\r\n    } finally {\r\n      setDeleteAccountLoading(false);\r\n    }\r\n  }\r\n\r\n  // UI helpers\r\n  const renderRich = (text?: string | null) => {\r\n    if (!text) return <span className=\"text-muted-foreground\">— not set —</span>;\r\n    const paragraphs = String(text).split(/\\n\\s*\\n/);\r\n    return (\r\n      <div>\r\n        {paragraphs.map((p, i) => (\r\n          <p key={i} className=\"mb-2 text-sm leading-relaxed\">\r\n            {p.split(/\\n/).map((line, idx) => (\r\n              <React.Fragment key={idx}>\r\n                {line}\r\n                {idx < p.split(/\\n/).length - 1 && <br />}\r\n              </React.Fragment>\r\n            ))}\r\n          </p>\r\n        ))}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderValue = (\r\n    label: 'Vision' | 'Mission' | 'Focus' | 'Core values',\r\n    value?: string | null\r\n  ) => (\r\n    <div className=\"mb-4\">\r\n      <div className=\"flex items-center gap-3\">\r\n        <div className=\"flex-shrink-0\">{getFieldIcon(label)}</div>\r\n        <div className=\"text-lg font-semibold\">{label}</div>\r\n      </div>\r\n      <div className=\"text-sm mt-2\">{renderRich(value)}</div>\r\n    </div>\r\n  );\r\n\r\n  const renderAvatar = (user: any) => {\r\n    const img = user?.image;\r\n    const first = user?.firstName ?? user?.name?.split(' ')?.[0] ?? '';\r\n    const last = user?.lastName ?? (user?.name ? user.name.split(' ').slice(1).join(' ') : '');\r\n    const initials = (first?.[0] ?? '') + ((last && last?.[0]) ?? user?.username?.[0] ?? '');\r\n\r\n    if (img) {\r\n      return (\r\n        <img\r\n          src={img}\r\n          alt={`${first} ${last}`.trim() || user?.username || 'avatar'}\r\n          className=\"w-14 h-14 rounded-full object-cover\"\r\n        />\r\n      );\r\n    }\r\n    return (\r\n      <div className=\"w-14 h-14 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-lg font-semibold text-gray-700 dark:text-gray-100\">\r\n        {initials.toUpperCase() || 'U'}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const fullName = () => {\r\n    const u = displayUser;\r\n    if (!u) return '';\r\n    if (u.firstName || u.lastName) {\r\n      return `${u.firstName ?? ''} ${u.lastName ?? ''}`.trim();\r\n    }\r\n    return u.name ?? u.username ?? '';\r\n  };\r\n\r\n  const videoName = getVideoNameFromUrl(homeData?.heroVideo);\r\n\r\n  // whether current session user can manage roles\r\n  const canManageRoles = sessionUser?.role === 'super' || sessionUser?.role === 'admin';\r\n\r\n  return (\r\n    <div className=\"w-full max-w-4xl mx-auto space-y-6\">\r\n      {/* Home Page Content (preview; upload only in modal) */}\r\n      <section className=\"p-6 bg-background rounded-xl shadow transition-shadow duration-200 hover:shadow-lg\">\r\n        <div className=\"flex items-center gap-3 mb-3\">\r\n          <Home className=\"h-8 w-8 text-primary-500\" aria-hidden />\r\n          <h2 className=\"font-semibold text-xl m-0\">Home Page Content</h2>\r\n        </div>\r\n\r\n        <p className=\"text-sm text-muted-foreground mb-3\">\r\n          Preview homepage content. Click \"Edit homepage content\" to upload a hero video or modify\r\n          fields.\r\n        </p>\r\n\r\n        {homeLoading ? (\r\n          <div className=\"text-sm text-muted-foreground\">Loading homepage content…</div>\r\n        ) : homeError ? (\r\n          <div className=\"text-sm text-red-500\">{homeError}</div>\r\n        ) : (\r\n          <div className=\"grid md:grid-cols-2 gap-4\">\r\n            <div>\r\n              <div className=\"text-xs text-muted-foreground mb-1\">Hero video URL / preview</div>\r\n              {homeData?.heroVideo ? (\r\n                <div className=\"mb-3\">\r\n                  <video controls className=\"w-full max-h-64 rounded\">\r\n                    <source src={homeData.heroVideo} />\r\n                    Your browser does not support the video tag.\r\n                  </video>\r\n                  <div className=\"text-sm mt-2 text-muted-foreground break-all\">\r\n                    {homeData.heroVideo}\r\n                  </div>\r\n                  {/* display video name (filename without extension) */}\r\n                  {videoName ? <div className=\"text-sm font-medium mt-1\">{videoName}</div> : null}\r\n                </div>\r\n              ) : (\r\n                <div className=\"mb-3 text-sm text-muted-foreground\">No hero video set.</div>\r\n              )}\r\n            </div>\r\n\r\n            <div>\r\n              {renderValue('Vision', homeData?.vision ?? null)}\r\n              {renderValue('Mission', homeData?.mission ?? null)}\r\n              {renderValue('Focus', homeData?.focus ?? null)}\r\n              {renderValue('Core values', homeData?.coreValues ?? null)}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"flex gap-2 mt-3\">\r\n          {canEdit ? (\r\n            <>\r\n              <Button onClick={openHomeModal} disabled={homeLoading || homeSaving}>\r\n                Edit homepage content\r\n              </Button>\r\n              <Button\r\n                onClick={fetchHomeContent}\r\n                variant=\"outline\"\r\n                disabled={homeLoading || homeSaving}\r\n              >\r\n                Refresh\r\n              </Button>\r\n              <Button\r\n                onClick={saveHomeContent}\r\n                disabled={homeSaving || uploading || !canEdit}\r\n                variant=\"secondary\"\r\n              >\r\n                {homeSaving ? 'Saving…' : 'Save homepage'}\r\n              </Button>\r\n            </>\r\n          ) : (\r\n            <Button\r\n              onClick={fetchHomeContent}\r\n              variant=\"outline\"\r\n              disabled={homeLoading || homeSaving}\r\n            >\r\n              Refresh\r\n            </Button>\r\n          )}\r\n        </div>\r\n      </section>\r\n\r\n      {/* User Settings header */}\r\n      <section className=\"p-6 bg-background rounded-xl shadow transition-shadow duration-200 hover:shadow-lg\">\r\n        <div className=\"flex items-center gap-3 mb-3\">\r\n          <User className=\"h-8 w-8 text-primary-500\" aria-hidden />\r\n          <h2 className=\"font-semibold text-xl m-0\">User Settings</h2>\r\n        </div>\r\n\r\n        {/* Profile block: avatar left, names/username/email to the right of the pic */}\r\n        <div className=\"flex items-center gap-4 mb-3\">\r\n          <div className=\"flex-shrink-0\">{renderAvatar(displayUser)}</div>\r\n          <div>\r\n            <div className=\"text-base font-semibold\">{fullName() || 'You'}</div>\r\n            <div className=\"text-sm text-muted-foreground\">\r\n              {displayUser?.username ? <span className=\"mr-2\">@{displayUser.username}</span> : null}\r\n              <span>{displayUser?.email ?? 'no email'}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <p className=\"text-sm text-muted-foreground mb-3\">\r\n          Edit your profile or change your password. The form opens in a modal.\r\n        </p>\r\n\r\n        {/* Buttons row below profile block */}\r\n        <div className=\"flex flex-wrap items-center gap-2\">\r\n          <Button onClick={() => openLocalEdit(false, false)} disabled={!id || loading}>\r\n            Edit my profile\r\n          </Button>\r\n          <Button\r\n            onClick={() => openLocalEdit(true, false)}\r\n            disabled={!id || loading}\r\n            variant=\"outline\"\r\n          >\r\n            Change my password\r\n          </Button>\r\n          <Button\r\n            onClick={() => openLocalEdit(false, true)}\r\n            disabled={!id || loading}\r\n            variant=\"outline\"\r\n          >\r\n            Change my username\r\n          </Button>\r\n          <Button\r\n            onClick={handleDeleteAccount}\r\n            disabled={!id || deleteAccountLoading}\r\n            className=\"bg-pink-700 text-white hover:bg-pink-800\"\r\n          >\r\n            {deleteAccountLoading ? 'Processing…' : 'Delete account'}\r\n          </Button>\r\n        </div>\r\n\r\n        {deleteAccountError && (\r\n          <div className=\"text-sm text-red-500 mt-2\">{deleteAccountError}</div>\r\n        )}\r\n        {deleteAccountSuccess && (\r\n          <div className=\"text-sm text-green-600 mt-2\">{deleteAccountSuccess}</div>\r\n        )}\r\n      </section>\r\n\r\n      {/* Edit profile modal */}\r\n      <Dialog\r\n        open={openLocalEditModal}\r\n        onOpenChange={(val) => !val && setOpenLocalEditModal(false)}\r\n      >\r\n        <DialogContent className=\"max-w-3xl w-full max-h-[85vh] p-0 sm:rounded-lg overflow-hidden\">\r\n          <DialogHeader>\r\n            <DialogTitle className=\"px-4 py-3 border-b\">Edit profile</DialogTitle>\r\n          </DialogHeader>\r\n\r\n          <div className=\"p-4 overflow-y-auto max-h-[72vh] space-y-4\">\r\n            <div>\r\n              {id ? (\r\n                // eslint-disable-next-line @typescript-eslint/no-var-requires\r\n                require('@/app/(admin)/admin/dashboard/createUserForm').default ? (\r\n                  // @ts-ignore - require used to avoid client-side import issues in some setups\r\n                  React.createElement(\r\n                    require('@/app/(admin)/admin/dashboard/createUserForm').default,\r\n                    {\r\n                      mode: 'edit',\r\n                      userId: String(id),\r\n                      forceChangePassword,\r\n                      forceChangeUsername,\r\n                      onSuccess: async () => {\r\n                        setOpenLocalEditModal(false);\r\n                        setForceChangePassword(false);\r\n                        setForceChangeUsername(false);\r\n                        // refresh current user profile after successful edit\r\n                        try {\r\n                          const r = await fetch(`/api/users/${id}`, { credentials: 'same-origin' });\r\n                          if (r.ok) {\r\n                            const j = await r.json();\r\n                            setCurrentUser(j);\r\n                          }\r\n                        } catch {}\r\n                      },\r\n                      onCancel: () => {\r\n                        setOpenLocalEditModal(false);\r\n                        setForceChangePassword(false);\r\n                        setForceChangeUsername(false);\r\n                      },\r\n                      canManageRoles,\r\n                    }\r\n                  )\r\n                ) : (\r\n                  <div className=\"text-sm text-red-500\">CreateUserForm not available</div>\r\n                )\r\n              ) : (\r\n                <div className=\"text-sm text-red-600\">No user id available for editing.</div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Homepage content modal (file input only in modal) */}\r\n      <Dialog open={homeModalOpen} onOpenChange={(val) => !val && closeHomeModal()}>\r\n        <DialogContent className=\"max-w-3xl w-full max-h-[85vh] p-0 sm:rounded-lg overflow-hidden\">\r\n          <DialogHeader>\r\n            <DialogTitle className=\"px-4 py-3 border-b\">\r\n              {homeData?.id ? 'Edit homepage content' : 'Create homepage content'}\r\n            </DialogTitle>\r\n          </DialogHeader>\r\n\r\n          <div className=\"p-4 overflow-y-auto max-h-[72vh]\">\r\n            {homeLoading ? (\r\n              <div className=\"p-6 text-center\">Loading…</div>\r\n            ) : (\r\n              <form onSubmit={saveHomeContent} className=\"space-y-4\">\r\n                {homeError && <div className=\"text-sm text-red-500\">{homeError}</div>}\r\n                {homeSuccess && <div className=\"text-sm text-green-600\">{homeSuccess}</div>}\r\n\r\n                <div>\r\n                  <label className=\"text-sm block mb-1\">Hero video URL</label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={homeData?.heroVideo ?? ''}\r\n                    onChange={(e) =>\r\n                      setHomeData((d) => ({ ...(d ?? {}), heroVideo: e.target.value }))\r\n                    }\r\n                    className=\"w-full border p-2 rounded\"\r\n                    placeholder=\"https://... (or upload a file below)\"\r\n                  />\r\n                </div>\r\n\r\n                {/* File input (modal-only) */}\r\n                <div>\r\n                  <label className=\"text-sm block mb-1\">Upload hero video (.mov, .mp4, .gif)</label>\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <input\r\n                      type=\"file\"\r\n                      accept=\".mov, .mp4, .gif, video/*, image/gif\"\r\n                      onChange={handleHeroFileChange}\r\n                      disabled={uploading || homeSaving || !canEdit}\r\n                      className=\"text-sm\"\r\n                    />\r\n                    {uploading && uploadProgress !== null && (\r\n                      <div className=\"text-sm text-muted-foreground\">\r\n                        Uploading: {uploadProgress}%\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  {uploadError && <div className=\"text-sm text-red-500 mt-1\">{uploadError}</div>}\r\n                  <div className=\"text-xs text-muted-foreground mt-1\">Max file size: 50MB.</div>\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"text-sm block mb-1\">Vision</label>\r\n                  <textarea\r\n                    value={homeData?.vision ?? ''}\r\n                    onChange={(e) => setHomeData((d) => ({ ...(d ?? {}), vision: e.target.value }))}\r\n                    className=\"w-full border p-2 rounded h-24\"\r\n                  />\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"text-sm block mb-1\">Mission</label>\r\n                  <textarea\r\n                    value={homeData?.mission ?? ''}\r\n                    onChange={(e) =>\r\n                      setHomeData((d) => ({ ...(d ?? {}), mission: e.target.value }))\r\n                    }\r\n                    className=\"w-full border p-2 rounded h-24\"\r\n                  />\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"text-sm block mb-1\">Focus</label>\r\n                  <textarea\r\n                    value={homeData?.focus ?? ''}\r\n                    onChange={(e) => setHomeData((d) => ({ ...(d ?? {}), focus: e.target.value }))}\r\n                    className=\"w-full border p-2 rounded h-20\"\r\n                  />\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"text-sm block mb-1\">Core values (comma separated)</label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={homeData?.coreValues ?? ''}\r\n                    onChange={(e) =>\r\n                      setHomeData((d) => ({ ...(d ?? {}), coreValues: e.target.value }))\r\n                    }\r\n                    className=\"w-full border p-2 rounded\"\r\n                    placeholder=\"Integrity, Inclusion, ... \"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"flex gap-2\">\r\n                  <Button type=\"submit\" disabled={homeSaving || !canEdit}>\r\n                    {homeSaving ? 'Saving…' : homeData?.id ? 'Save changes' : 'Create content'}\r\n                  </Button>\r\n                  <Button variant=\"outline\" onClick={closeHomeModal} disabled={homeSaving}>\r\n                    Cancel\r\n                  </Button>\r\n                  {homeData?.id && canEdit && (\r\n                    <Button variant=\"destructive\" onClick={deleteHomeContent} disabled={homeSaving}>\r\n                      Delete\r\n                    </Button>\r\n                  )}\r\n                </div>\r\n              </form>\r\n            )}\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4463, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/utils/styles/card-hover.ts"],"sourcesContent":["import clsx from 'clsx';\r\n\r\nexport const cardHoverClass = clsx(\r\n  'relative overflow-hidden rounded-xl transition-transform duration-300 perspective-[1200px]',\r\n  'cursor-pointer',\r\n  'bg-white text-gray-900 border border-gray-200 shadow-md shadow-gray-300/30',\r\n  'hover:shadow-2xl hover:scale-[1.02] hover:border-violet-700 hover:shadow-violet-700/60',\r\n  'dark:backdrop-blur-sm dark:bg-zinc-900/70 dark:text-white dark:border-card dark:shadow-md dark:shadow-black/30',\r\n  'dark:hover:shadow-2xl dark:hover:scale-[1.02] dark:hover:border-pink-700 dark:hover:shadow-pink-700/50',\r\n//   'hover:mb-8' \r\n);\r\n"],"names":[],"mappings":";;;AAAA;;AAEO,MAAM,iBAAiB,CAAA,GAAA,qIAAA,CAAA,UAAI,AAAD,EAC/B,8FACA,kBACA,8EACA,0FACA,kHACA","debugId":null}},
    {"offset": {"line": 4475, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/chart/animatedStats.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useRef, useState } from 'react';\r\nimport { usePathname } from 'next/navigation';\r\nimport { cardHoverClass } from '@/utils/styles/card-hover';\r\n\r\ntype Stat = {\r\n  label: string;\r\n  value: number;\r\n  color?: string;\r\n};\r\n\r\n// ---- Slightly reduced dimensions, animation untouched ----\r\nconst CARD_MIN_WIDTH = 160;\r\nconst CARD_PADDING_X = 10;\r\nconst CARD_PADDING_Y = 8;\r\nconst SVG_SIZE = 90;\r\nconst CIRCLE_RADIUS = 33;\r\nconst CIRCLE_STROKE_WIDTH = 9;\r\nconst CIRCLE_DASHARRAY = 2 * Math.PI * CIRCLE_RADIUS;\r\nconst FONT_SIZE = 38;\r\nconst ANIMATION_DURATION = 10; // seconds\r\nconst CIRCLE_DELAY_STEP = 0.32;\r\nconst STAT_LABEL_FONT_SIZE = 15;\r\n\r\nexport default function AnimatedStats() {\r\n  const pathname = usePathname();\r\n  const showUsers = pathname === '/admin' || pathname.startsWith('/admin/');\r\n\r\n  const [counts, setCounts] = useState<{\r\n    projects: number;\r\n    reports: number;\r\n    events: number;\r\n    users: number;\r\n    institutions: number;\r\n    beneficiaries: number;\r\n  }>({\r\n    projects: 0,\r\n    reports: 0,\r\n    events: 0,\r\n    users: 0,\r\n    institutions: 0,\r\n    beneficiaries: 0,\r\n  });\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    async function fetchCounts() {\r\n      setLoading(true);\r\n      try {\r\n        const [projectsRes, reportsRes, eventsRes, usersRes, institutionsRes, beneficiariesRes] =\r\n          await Promise.all([\r\n            fetch('/api/projects'),\r\n            fetch('/api/reports'),\r\n            fetch('/api/events'),\r\n            fetch('/api/users'),\r\n            fetch('/api/institutions'),\r\n            fetch('/api/beneficiaries'),\r\n          ]);\r\n        const [projects, reports, events, users, institutions, beneficiaries] = await Promise.all([\r\n          projectsRes.json(),\r\n          reportsRes.json(),\r\n          eventsRes.json(),\r\n          usersRes.json(),\r\n          institutionsRes.json(),\r\n          beneficiariesRes.json(),\r\n        ]);\r\n        setCounts({\r\n          projects: Array.isArray(projects) ? projects.length : projects.count ?? 0,\r\n          reports: Array.isArray(reports) ? reports.length : reports.count ?? 0,\r\n          events: Array.isArray(events) ? events.length : events.count ?? 0,\r\n          users: Array.isArray(users) ? users.length : users.count ?? 0,\r\n          institutions: Array.isArray(institutions) ? institutions.length : institutions.count ?? 0,\r\n          beneficiaries: Array.isArray(beneficiaries)\r\n            ? beneficiaries.length\r\n            : beneficiaries.count ?? 0,\r\n        });\r\n      } catch (err) {\r\n        setCounts({\r\n          projects: 0,\r\n          reports: 0,\r\n          events: 0,\r\n          users: 0,\r\n          institutions: 0,\r\n          beneficiaries: 0,\r\n        });\r\n      }\r\n      setLoading(false);\r\n    }\r\n    fetchCounts();\r\n  }, []);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex justify-center items-center py-8\">\r\n        <span className=\"text-muted-foreground\" style={{ fontSize: 24 }}>\r\n          Loading stats...\r\n        </span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Prepare stats to display\r\n  const stats: Stat[] = [\r\n    { label: 'Projects', value: counts.projects, color: '#7c3aed' },\r\n    { label: 'Reports', value: counts.reports, color: '#f59e42' },\r\n    { label: 'Events', value: counts.events, color: '#b87333' },\r\n    { label: 'Institutions', value: counts.institutions, color: '#7c482b' },\r\n    { label: 'Beneficiaries', value: counts.beneficiaries, color: '#059669' },\r\n  ];\r\n  if (showUsers) {\r\n    stats.push({ label: 'Users', value: counts.users, color: '#2563eb' });\r\n  }\r\n\r\n  return (\r\n    <div className=\"w-full\">\r\n      <div className=\"flex w-full gap-5 overflow-x-auto overflow-y-visible justify-center\">\r\n        <style>{`\r\n        @keyframes progressCircleDash {\r\n          0% {\r\n            stroke-dashoffset: ${CIRCLE_DASHARRAY};\r\n          }\r\n          60% {\r\n            stroke-dashoffset: 0;\r\n          }\r\n          100% {\r\n            stroke-dashoffset: ${CIRCLE_DASHARRAY};\r\n          }\r\n        }\r\n      `}</style>\r\n        {stats.map((stat, i) => (\r\n          <StatCard key={stat.label} stat={stat} index={i} />\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction StatCard({ stat, index }: { stat: Stat; index: number }) {\r\n  const ref = useRef<HTMLSpanElement>(null);\r\n\r\n  useEffect(() => {\r\n    if (!ref.current) return;\r\n    let start = 0;\r\n    const end = stat.value;\r\n    if (end === 0) {\r\n      ref.current.textContent = '0';\r\n      return;\r\n    }\r\n    const duration = 1800 + Math.random() * 800;\r\n    const startTimestamp = performance.now();\r\n    function animate(now: number) {\r\n      const progress = Math.min((now - startTimestamp) / duration, 1);\r\n      const value = Math.floor(progress * (end - start) + start);\r\n      if (ref.current) ref.current.textContent = value.toLocaleString();\r\n      if (progress < 1) requestAnimationFrame(animate);\r\n    }\r\n    requestAnimationFrame(animate);\r\n  }, [stat.value]);\r\n\r\n  // Stagger circle animation for each stat\r\n  const circleDelay = `${index * CIRCLE_DELAY_STEP}s`;\r\n\r\n  return (\r\n    <div\r\n      className={\r\n        cardHoverClass + ' flex flex-col items-center justify-center' // center everything in the card\r\n      }\r\n      style={{\r\n        borderTop: `7px solid ${stat.color || '#7c3aed'}`,\r\n        minWidth: CARD_MIN_WIDTH,\r\n        padding: `${CARD_PADDING_Y}px ${CARD_PADDING_X}px`,\r\n        height: 'auto',\r\n        marginBottom: '16px',\r\n      }}\r\n    >\r\n      <div\r\n        className=\"flex items-center justify-center relative mb-2\"\r\n        style={{\r\n          width: SVG_SIZE,\r\n          height: SVG_SIZE,\r\n          margin: '0 auto',\r\n        }}\r\n      >\r\n        {/* Animated SVG Circle */}\r\n        <svg\r\n          width={SVG_SIZE}\r\n          height={SVG_SIZE}\r\n          style={{\r\n            position: 'absolute',\r\n            left: 0,\r\n            top: 0,\r\n            zIndex: 0,\r\n            display: 'block',\r\n            margin: '0 auto',\r\n          }}\r\n        >\r\n          <circle\r\n            cx={SVG_SIZE / 2}\r\n            cy={SVG_SIZE / 2}\r\n            r={CIRCLE_RADIUS}\r\n            fill=\"none\"\r\n            stroke=\"#e5e7eb\"\r\n            strokeWidth={CIRCLE_STROKE_WIDTH}\r\n          />\r\n          <circle\r\n            cx={SVG_SIZE / 2}\r\n            cy={SVG_SIZE / 2}\r\n            r={CIRCLE_RADIUS}\r\n            fill=\"none\"\r\n            stroke={stat.color || '#7c3aed'}\r\n            strokeWidth={CIRCLE_STROKE_WIDTH}\r\n            strokeDasharray={CIRCLE_DASHARRAY}\r\n            strokeDashoffset={CIRCLE_DASHARRAY}\r\n            style={{\r\n              transition: 'none',\r\n              strokeLinecap: 'round',\r\n              filter: `drop-shadow(0 0 8px ${stat.color || '#7c3aed'}66)`,\r\n              transform: 'rotate(-90deg)',\r\n              transformOrigin: '50% 50%',\r\n              animation: `progressCircleDash ${ANIMATION_DURATION}s cubic-bezier(.56,1.84,.64,1) ${circleDelay} infinite`,\r\n            }}\r\n          />\r\n        </svg>\r\n        {/* The animated number */}\r\n        <span\r\n          ref={ref}\r\n          className=\"flex items-center justify-center\"\r\n          style={{\r\n            color: stat.color || '#7c3aed',\r\n            position: 'relative',\r\n            zIndex: 1,\r\n            width: SVG_SIZE,\r\n            height: SVG_SIZE,\r\n            fontVariantNumeric: 'tabular-nums',\r\n            letterSpacing: '-0.02em',\r\n            userSelect: 'none',\r\n            fontSize: FONT_SIZE,\r\n            fontWeight: 800,\r\n            textAlign: 'center',\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n          }}\r\n        >\r\n          0\r\n        </span>\r\n      </div>\r\n      <span\r\n        style={{\r\n          fontSize: STAT_LABEL_FONT_SIZE,\r\n          marginTop: 6,\r\n          textTransform: 'uppercase',\r\n          letterSpacing: '0.06em',\r\n          color: '#6b7280',\r\n          fontWeight: 600,\r\n          textAlign: 'center',\r\n          whiteSpace: 'nowrap',\r\n          overflow: 'hidden',\r\n          textOverflow: 'ellipsis',\r\n          maxWidth: CARD_MIN_WIDTH,\r\n        }}\r\n      >\r\n        {stat.label}\r\n      </span>\r\n    </div>\r\n  );\r\n}\r\n// This component displays animated stats cards with a progress circle animation.\r\n// It fetches counts for projects, reports, events, users, institutions, and beneficiaries from the API.\r\n// Each card shows a circular progress animation with the count value in the center."],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAJA;;;;;AAYA,6DAA6D;AAC7D,MAAM,iBAAiB;AACvB,MAAM,iBAAiB;AACvB,MAAM,iBAAiB;AACvB,MAAM,WAAW;AACjB,MAAM,gBAAgB;AACtB,MAAM,sBAAsB;AAC5B,MAAM,mBAAmB,IAAI,KAAK,EAAE,GAAG;AACvC,MAAM,YAAY;AAClB,MAAM,qBAAqB,IAAI,UAAU;AACzC,MAAM,oBAAoB;AAC1B,MAAM,uBAAuB;AAEd,SAAS;IACtB,MAAM,WAAW,CAAA,GAAA,kIAAA,CAAA,cAAW,AAAD;IAC3B,MAAM,YAAY,aAAa,YAAY,SAAS,UAAU,CAAC;IAE/D,MAAM,CAAC,QAAQ,UAAU,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAOhC;QACD,UAAU;QACV,SAAS;QACT,QAAQ;QACR,OAAO;QACP,cAAc;QACd,eAAe;IACjB;IACA,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAEvC,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,eAAe;YACb,WAAW;YACX,IAAI;gBACF,MAAM,CAAC,aAAa,YAAY,WAAW,UAAU,iBAAiB,iBAAiB,GACrF,MAAM,QAAQ,GAAG,CAAC;oBAChB,MAAM;oBACN,MAAM;oBACN,MAAM;oBACN,MAAM;oBACN,MAAM;oBACN,MAAM;iBACP;gBACH,MAAM,CAAC,UAAU,SAAS,QAAQ,OAAO,cAAc,cAAc,GAAG,MAAM,QAAQ,GAAG,CAAC;oBACxF,YAAY,IAAI;oBAChB,WAAW,IAAI;oBACf,UAAU,IAAI;oBACd,SAAS,IAAI;oBACb,gBAAgB,IAAI;oBACpB,iBAAiB,IAAI;iBACtB;gBACD,UAAU;oBACR,UAAU,MAAM,OAAO,CAAC,YAAY,SAAS,MAAM,GAAG,SAAS,KAAK,IAAI;oBACxE,SAAS,MAAM,OAAO,CAAC,WAAW,QAAQ,MAAM,GAAG,QAAQ,KAAK,IAAI;oBACpE,QAAQ,MAAM,OAAO,CAAC,UAAU,OAAO,MAAM,GAAG,OAAO,KAAK,IAAI;oBAChE,OAAO,MAAM,OAAO,CAAC,SAAS,MAAM,MAAM,GAAG,MAAM,KAAK,IAAI;oBAC5D,cAAc,MAAM,OAAO,CAAC,gBAAgB,aAAa,MAAM,GAAG,aAAa,KAAK,IAAI;oBACxF,eAAe,MAAM,OAAO,CAAC,iBACzB,cAAc,MAAM,GACpB,cAAc,KAAK,IAAI;gBAC7B;YACF,EAAE,OAAO,KAAK;gBACZ,UAAU;oBACR,UAAU;oBACV,SAAS;oBACT,QAAQ;oBACR,OAAO;oBACP,cAAc;oBACd,eAAe;gBACjB;YACF;YACA,WAAW;QACb;QACA;IACF,GAAG,EAAE;IAEL,IAAI,SAAS;QACX,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAK,WAAU;gBAAwB,OAAO;oBAAE,UAAU;gBAAG;0BAAG;;;;;;;;;;;IAKvE;IAEA,2BAA2B;IAC3B,MAAM,QAAgB;QACpB;YAAE,OAAO;YAAY,OAAO,OAAO,QAAQ;YAAE,OAAO;QAAU;QAC9D;YAAE,OAAO;YAAW,OAAO,OAAO,OAAO;YAAE,OAAO;QAAU;QAC5D;YAAE,OAAO;YAAU,OAAO,OAAO,MAAM;YAAE,OAAO;QAAU;QAC1D;YAAE,OAAO;YAAgB,OAAO,OAAO,YAAY;YAAE,OAAO;QAAU;QACtE;YAAE,OAAO;YAAiB,OAAO,OAAO,aAAa;YAAE,OAAO;QAAU;KACzE;IACD,IAAI,WAAW;QACb,MAAM,IAAI,CAAC;YAAE,OAAO;YAAS,OAAO,OAAO,KAAK;YAAE,OAAO;QAAU;IACrE;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;8BAAO,CAAC;;;+BAGc,EAAE,iBAAiB;;;;;;+BAMnB,EAAE,iBAAiB;;;MAG5C,CAAC;;;;;;gBACE,MAAM,GAAG,CAAC,CAAC,MAAM,kBAChB,8OAAC;wBAA0B,MAAM;wBAAM,OAAO;uBAA/B,KAAK,KAAK;;;;;;;;;;;;;;;;AAKnC;AAEA,SAAS,SAAS,EAAE,IAAI,EAAE,KAAK,EAAiC;IAC9D,MAAM,MAAM,CAAA,GAAA,qMAAA,CAAA,SAAM,AAAD,EAAmB;IAEpC,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,IAAI,CAAC,IAAI,OAAO,EAAE;QAClB,IAAI,QAAQ;QACZ,MAAM,MAAM,KAAK,KAAK;QACtB,IAAI,QAAQ,GAAG;YACb,IAAI,OAAO,CAAC,WAAW,GAAG;YAC1B;QACF;QACA,MAAM,WAAW,OAAO,KAAK,MAAM,KAAK;QACxC,MAAM,iBAAiB,YAAY,GAAG;QACtC,SAAS,QAAQ,GAAW;YAC1B,MAAM,WAAW,KAAK,GAAG,CAAC,CAAC,MAAM,cAAc,IAAI,UAAU;YAC7D,MAAM,QAAQ,KAAK,KAAK,CAAC,WAAW,CAAC,MAAM,KAAK,IAAI;YACpD,IAAI,IAAI,OAAO,EAAE,IAAI,OAAO,CAAC,WAAW,GAAG,MAAM,cAAc;YAC/D,IAAI,WAAW,GAAG,sBAAsB;QAC1C;QACA,sBAAsB;IACxB,GAAG;QAAC,KAAK,KAAK;KAAC;IAEf,yCAAyC;IACzC,MAAM,cAAc,GAAG,QAAQ,kBAAkB,CAAC,CAAC;IAEnD,qBACE,8OAAC;QACC,WACE,gIAAA,CAAA,iBAAc,GAAG,6CAA6C,gCAAgC;;QAEhG,OAAO;YACL,WAAW,CAAC,UAAU,EAAE,KAAK,KAAK,IAAI,WAAW;YACjD,UAAU;YACV,SAAS,GAAG,eAAe,GAAG,EAAE,eAAe,EAAE,CAAC;YAClD,QAAQ;YACR,cAAc;QAChB;;0BAEA,8OAAC;gBACC,WAAU;gBACV,OAAO;oBACL,OAAO;oBACP,QAAQ;oBACR,QAAQ;gBACV;;kCAGA,8OAAC;wBACC,OAAO;wBACP,QAAQ;wBACR,OAAO;4BACL,UAAU;4BACV,MAAM;4BACN,KAAK;4BACL,QAAQ;4BACR,SAAS;4BACT,QAAQ;wBACV;;0CAEA,8OAAC;gCACC,IAAI,WAAW;gCACf,IAAI,WAAW;gCACf,GAAG;gCACH,MAAK;gCACL,QAAO;gCACP,aAAa;;;;;;0CAEf,8OAAC;gCACC,IAAI,WAAW;gCACf,IAAI,WAAW;gCACf,GAAG;gCACH,MAAK;gCACL,QAAQ,KAAK,KAAK,IAAI;gCACtB,aAAa;gCACb,iBAAiB;gCACjB,kBAAkB;gCAClB,OAAO;oCACL,YAAY;oCACZ,eAAe;oCACf,QAAQ,CAAC,oBAAoB,EAAE,KAAK,KAAK,IAAI,UAAU,GAAG,CAAC;oCAC3D,WAAW;oCACX,iBAAiB;oCACjB,WAAW,CAAC,mBAAmB,EAAE,mBAAmB,+BAA+B,EAAE,YAAY,SAAS,CAAC;gCAC7G;;;;;;;;;;;;kCAIJ,8OAAC;wBACC,KAAK;wBACL,WAAU;wBACV,OAAO;4BACL,OAAO,KAAK,KAAK,IAAI;4BACrB,UAAU;4BACV,QAAQ;4BACR,OAAO;4BACP,QAAQ;4BACR,oBAAoB;4BACpB,eAAe;4BACf,YAAY;4BACZ,UAAU;4BACV,YAAY;4BACZ,WAAW;4BACX,SAAS;4BACT,YAAY;4BACZ,gBAAgB;wBAClB;kCACD;;;;;;;;;;;;0BAIH,8OAAC;gBACC,OAAO;oBACL,UAAU;oBACV,WAAW;oBACX,eAAe;oBACf,eAAe;oBACf,OAAO;oBACP,YAAY;oBACZ,WAAW;oBACX,YAAY;oBACZ,UAAU;oBACV,cAAc;oBACd,UAAU;gBACZ;0BAEC,KAAK,KAAK;;;;;;;;;;;;AAInB,EACA,iFAAiF;CACjF,wGAAwG;CACxG,oFAAoF","debugId":null}},
    {"offset": {"line": 4813, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EACV,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EACV,8JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EAAE,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EACV,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EAAE,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EAAE,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 4910, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/chart/components/animatedPieceBarChart.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useRef, useState } from 'react';\r\nimport { Bar } from 'react-chartjs-2';\r\nimport {\r\n  Chart as ChartJS,\r\n  CategoryScale,\r\n  LinearScale,\r\n  BarElement,\r\n  Title,\r\n  Tooltip,\r\n  Legend,\r\n  ChartOptions,\r\n} from 'chart.js';\r\nimport { cardHoverClass } from '@/utils/styles/card-hover';\r\n\r\nChartJS.register(CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend);\r\n\r\n// Added color for Beneficiaries. Institutions uses same as before.\r\nconst defaultColors = [\r\n  '#7c3aed', // Projects\r\n  '#f59e42', // Reports\r\n  '#059669', // Events\r\n  '#7c482b', // Institutions (same as in stats)\r\n  '#2563eb', // Users\r\n  '#eab308', // Beneficiaries (matches stats)\r\n];\r\n\r\nexport default function AnimatedPieceBarChart({\r\n  values = [7, 4, 9, 3, 6, 12],\r\n  labels = ['Projects', 'Reports', 'Events', 'Institutions', 'Users', 'Beneficiaries'],\r\n  colors = defaultColors,\r\n  animationDuration = 1600, // ms for one fill\r\n  loopPause = 800, // ms to show the full bar before restarting animation\r\n}: {\r\n  values?: number[];\r\n  labels?: string[];\r\n  colors?: string[];\r\n  animationDuration?: number;\r\n  loopPause?: number;\r\n}) {\r\n  const [progress, setProgress] = useState(0); // 0 to 1\r\n  const [loopKey, setLoopKey] = useState(0); // change to restart animation\r\n  const chartRef = useRef<any>(null);\r\n\r\n  // Looping fill animation\r\n  useEffect(() => {\r\n    let frame: number;\r\n    let start: number | null = null;\r\n    let stopped = false;\r\n\r\n    function animate(ts: number) {\r\n      if (stopped) return;\r\n      if (start === null) start = ts;\r\n      const elapsed = ts - start;\r\n      let pct = Math.min(elapsed / animationDuration, 1);\r\n      setProgress(pct);\r\n\r\n      if (pct < 1) {\r\n        frame = requestAnimationFrame(animate);\r\n      } else {\r\n        // Pause with full bar, then restart\r\n        setTimeout(() => {\r\n          if (!stopped) {\r\n            setProgress(0);\r\n            setLoopKey((k) => k + 1);\r\n          }\r\n        }, loopPause);\r\n      }\r\n    }\r\n    frame = requestAnimationFrame(animate);\r\n\r\n    return () => {\r\n      stopped = true;\r\n      cancelAnimationFrame(frame);\r\n    };\r\n    // eslint-disable-next-line\r\n  }, [loopKey, animationDuration, loopPause, values.join(',')]);\r\n\r\n  // Force chart update on each progress step\r\n  useEffect(() => {\r\n    if (chartRef.current) {\r\n      chartRef.current.update();\r\n    }\r\n  }, [progress, values]);\r\n\r\n  // Animate values from 0 to target value based on progress\r\n  const animatedData = values.map((v) => Math.round(v * progress * 100) / 100);\r\n\r\n  const barData = {\r\n    labels,\r\n    datasets: [\r\n      {\r\n        label: 'Count',\r\n        data: animatedData,\r\n        backgroundColor: colors.slice(0, labels.length),\r\n        borderRadius: 7,\r\n        borderWidth: 0,\r\n        maxBarThickness: 80,\r\n      },\r\n    ],\r\n  };\r\n\r\n  const yMax = Math.max(1, ...values);\r\n\r\n  const barOptions: ChartOptions<'bar'> = {\r\n    responsive: true,\r\n    maintainAspectRatio: false,\r\n    plugins: {\r\n      legend: { display: false },\r\n      title: { display: false },\r\n      tooltip: { enabled: true },\r\n    },\r\n    animation: false, // we control animation manually\r\n    scales: {\r\n      y: {\r\n        beginAtZero: true,\r\n        suggestedMax: yMax,\r\n        ticks: {\r\n          font: { size: 14 },\r\n          stepSize: 1,\r\n        },\r\n      },\r\n      x: {\r\n        ticks: {\r\n          font: { size: 14 },\r\n        },\r\n      },\r\n    },\r\n  };\r\n\r\n  return (\r\n    <div className=\"w-full h-[250px]\">\r\n      <Bar ref={chartRef} data={barData} options={barOptions} />\r\n    </div>\r\n  );\r\n}\r\n// This component displays a bar chart with animated filling bars based on provided values and labels, including Institutions and Beneficiaries.\r\n// It uses Chart.js for rendering and supports custom colors, animation duration, and loop pause."],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 5069, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/utils/useHybridCachedData.ts"],"sourcesContent":["import { useEffect, useState } from 'react';\r\n\r\ntype Fetcher<T> = () => Promise<T>;\r\ntype Options<T> = {\r\n  initialData?: T;\r\n  staleTime?: number; // ms\r\n};\r\n\r\nexport function useHybridCachedData<T>(\r\n  key: string,\r\n  fetcher: Fetcher<T>,\r\n  options: Options<T> = {}\r\n): { data: T | undefined; isLoading: boolean; refresh: () => void } {\r\n  const { initialData, staleTime = 60 * 60 * 1000 } = options;\r\n  const [data, setData] = useState<T | undefined>(initialData);\r\n  const [isLoading, setIsLoading] = useState(!initialData);\r\n\r\n  // Always show cached data if available, but always fetch in background for freshness\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n    async function load() {\r\n      // Try localStorage first\r\n      let usedCache = false;\r\n      try {\r\n        const raw = localStorage.getItem(key);\r\n        if (raw) {\r\n          const parsed = JSON.parse(raw);\r\n          setData(parsed.value);\r\n          setIsLoading(false);\r\n          usedCache = true;\r\n        }\r\n      } catch {}\r\n      // Use initialData if provided and nothing in cache\r\n      if (!usedCache && initialData !== undefined) {\r\n        setData(initialData);\r\n        setIsLoading(false);\r\n      }\r\n      // Always fetch in background\r\n      setIsLoading(true);\r\n      const fresh = await fetcher();\r\n      if (!cancelled) {\r\n        setData(fresh);\r\n        setIsLoading(false);\r\n        try {\r\n          localStorage.setItem(key, JSON.stringify({ value: fresh, ts: Date.now() }));\r\n        } catch {}\r\n      }\r\n    }\r\n    load();\r\n    return () => {\r\n      cancelled = true;\r\n    };\r\n    // eslint-disable-next-line\r\n  }, [key]);\r\n\r\n  // Manual refresh\r\n  const refresh = async () => {\r\n    setIsLoading(true);\r\n    const fresh = await fetcher();\r\n    setData(fresh);\r\n    setIsLoading(false);\r\n    try {\r\n      localStorage.setItem(key, JSON.stringify({ value: fresh, ts: Date.now() }));\r\n    } catch {}\r\n  };\r\n\r\n  return { data, isLoading, refresh };\r\n}\r\n"],"names":[],"mappings":";;;AAAA;;AAQO,SAAS,oBACd,GAAW,EACX,OAAmB,EACnB,UAAsB,CAAC,CAAC;IAExB,MAAM,EAAE,WAAW,EAAE,YAAY,KAAK,KAAK,IAAI,EAAE,GAAG;IACpD,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAiB;IAChD,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE,CAAC;IAE5C,qFAAqF;IACrF,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,IAAI,YAAY;QAChB,eAAe;YACb,yBAAyB;YACzB,IAAI,YAAY;YAChB,IAAI;gBACF,MAAM,MAAM,aAAa,OAAO,CAAC;gBACjC,IAAI,KAAK;oBACP,MAAM,SAAS,KAAK,KAAK,CAAC;oBAC1B,QAAQ,OAAO,KAAK;oBACpB,aAAa;oBACb,YAAY;gBACd;YACF,EAAE,OAAM,CAAC;YACT,mDAAmD;YACnD,IAAI,CAAC,aAAa,gBAAgB,WAAW;gBAC3C,QAAQ;gBACR,aAAa;YACf;YACA,6BAA6B;YAC7B,aAAa;YACb,MAAM,QAAQ,MAAM;YACpB,IAAI,CAAC,WAAW;gBACd,QAAQ;gBACR,aAAa;gBACb,IAAI;oBACF,aAAa,OAAO,CAAC,KAAK,KAAK,SAAS,CAAC;wBAAE,OAAO;wBAAO,IAAI,KAAK,GAAG;oBAAG;gBAC1E,EAAE,OAAM,CAAC;YACX;QACF;QACA;QACA,OAAO;YACL,YAAY;QACd;IACA,2BAA2B;IAC7B,GAAG;QAAC;KAAI;IAER,iBAAiB;IACjB,MAAM,UAAU;QACd,aAAa;QACb,MAAM,QAAQ,MAAM;QACpB,QAAQ;QACR,aAAa;QACb,IAAI;YACF,aAAa,OAAO,CAAC,KAAK,KAAK,SAAS,CAAC;gBAAE,OAAO;gBAAO,IAAI,KAAK,GAAG;YAAG;QAC1E,EAAE,OAAM,CAAC;IACX;IAEA,OAAO;QAAE;QAAM;QAAW;IAAQ;AACpC","debugId":null}},
    {"offset": {"line": 5145, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/chart/dashboardChart.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { usePathname } from 'next/navigation';\r\nimport { Pie } from 'react-chartjs-2';\r\nimport { CardContent } from '@/components/ui/card';\r\nimport {\r\n  Chart as ChartJS,\r\n  CategoryScale,\r\n  LinearScale,\r\n  BarElement,\r\n  Title,\r\n  Tooltip,\r\n  Legend,\r\n  ArcElement,\r\n  ChartOptions,\r\n  Plugin,\r\n} from 'chart.js';\r\nimport AnimatedPieceBarChart from './components/animatedPieceBarChart';\r\nimport { cardHoverClass } from '@/utils/styles/card-hover';\r\nimport { useHybridCachedData } from '@/utils/useHybridCachedData';\r\n\r\nChartJS.register(CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend, ArcElement);\r\n\r\ntype CountData = {\r\n  projects: number;\r\n  reports: number;\r\n  events: number;\r\n  users: number;\r\n  institutions: number;\r\n  beneficiaries: number;\r\n};\r\n\r\nconst ANIMATION_DURATION = 4.2;\r\n\r\n// Centralized fetcher that combines all counts in one API call\r\nasync function fetchDashboardCounts(): Promise<CountData> {\r\n  const [projectsRes, reportsRes, eventsRes, usersRes, institutionsRes, beneficiariesRes] =\r\n    await Promise.all([\r\n      fetch('/api/projects'),\r\n      fetch('/api/reports'),\r\n      fetch('/api/events'),\r\n      fetch('/api/users'),\r\n      fetch('/api/institutions'),\r\n      fetch('/api/beneficiaries'),\r\n    ]);\r\n  const [projects, reports, events, users, institutions, beneficiaries] = await Promise.all([\r\n    projectsRes.json(),\r\n    reportsRes.json(),\r\n    eventsRes.json(),\r\n    usersRes.json(),\r\n    institutionsRes.json(),\r\n    beneficiariesRes.json(),\r\n  ]);\r\n  return {\r\n    projects: Array.isArray(projects) ? projects.length : projects.count ?? 0,\r\n    reports: Array.isArray(reports) ? reports.length : reports.count ?? 0,\r\n    events: Array.isArray(events) ? events.length : events.count ?? 0,\r\n    users: Array.isArray(users) ? users.length : users.count ?? 0,\r\n    institutions: Array.isArray(institutions) ? institutions.length : institutions.count ?? 0,\r\n    beneficiaries: Array.isArray(beneficiaries) ? beneficiaries.length : beneficiaries.count ?? 0,\r\n  };\r\n}\r\n\r\nexport default function DashboardChart() {\r\n  const pathname = usePathname();\r\n  const isAdmin = pathname === '/admin/dashboard';\r\n\r\n  // Use the hybrid cache with a unique key and a 30min stale time\r\n  const {\r\n    data: counts,\r\n    isLoading,\r\n    refresh,\r\n  } = useHybridCachedData<CountData>('dashboard-counts-v1', fetchDashboardCounts, {\r\n    staleTime: 1000 * 60 * 30,\r\n  });\r\n\r\n  const [loop, setLoop] = useState(0);\r\n  useEffect(() => {\r\n    const interval = setInterval(() => setLoop((v) => v + 1), (ANIMATION_DURATION + 0.7) * 1000);\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  const safeCounts: CountData = counts ?? {\r\n    projects: 0,\r\n    reports: 0,\r\n    events: 0,\r\n    users: 0,\r\n    institutions: 0,\r\n    beneficiaries: 0,\r\n  };\r\n\r\n  // Updated: Labels, values, and colors to include Institutions and Beneficiaries, and match animatedStats.tsx\r\n  const labels = ['Projects', 'Reports', 'Events', 'Institutions', 'Beneficiaries'].concat(\r\n    isAdmin ? ['Users'] : []\r\n  );\r\n  const dataValues = [\r\n    safeCounts.projects,\r\n    safeCounts.reports,\r\n    safeCounts.events,\r\n    safeCounts.institutions,\r\n    safeCounts.beneficiaries,\r\n    ...(isAdmin ? [safeCounts.users] : []),\r\n  ];\r\n  const backgroundColors = [\r\n    '#7c3aed', // Projects\r\n    '#f59e42', // Reports\r\n    '#059669', // Events\r\n    '#7c482b', // Institutions (brown, matches animatedStats)\r\n    '#eab308', // Beneficiaries (yellow, matches animatedStats)\r\n    ...(isAdmin ? ['#2563eb'] : []), // Users (blue)\r\n  ];\r\n  const total = dataValues.reduce((a, b) => a + b, 0);\r\n\r\n  const pieData = {\r\n    labels,\r\n    datasets: [\r\n      {\r\n        data: total > 0 ? dataValues : [1, 1, 1, 1, 1, 1].slice(0, labels.length),\r\n        backgroundColor: backgroundColors,\r\n        borderWidth: 1,\r\n      },\r\n    ],\r\n  };\r\n\r\n  const pieOptions: ChartOptions<'pie'> = {\r\n    responsive: true,\r\n    maintainAspectRatio: false,\r\n    animation: {\r\n      animateRotate: true,\r\n      animateScale: true,\r\n      duration: 1000,\r\n      easing: 'easeOutQuart',\r\n    },\r\n    plugins: {\r\n      legend: { display: false },\r\n      tooltip: { enabled: true },\r\n      title: { display: false },\r\n    },\r\n  };\r\n\r\n  const piePercentPlugin: Plugin<'pie'> = {\r\n    id: 'piePercentPlugin',\r\n    afterDraw(chart) {\r\n      const ctx = chart.ctx;\r\n      const dataset = chart.data.datasets[0];\r\n      const total = dataset.data.reduce((sum: number, val: any) => sum + val, 0);\r\n      dataset.data.forEach((value: any, index: number) => {\r\n        const meta = chart.getDatasetMeta(0);\r\n        const arc = meta.data[index];\r\n        const angle = (arc.startAngle + arc.endAngle) / 2;\r\n        const radius = (arc.outerRadius + arc.innerRadius) / 2;\r\n        const x = arc.x + Math.cos(angle) * radius;\r\n        const y = arc.y + Math.sin(angle) * radius;\r\n        const percent = total > 0 ? ((value / total) * 100).toFixed(1) + '%' : '';\r\n        ctx.fillStyle = '#fff';\r\n        ctx.font = 'bold 14px Arial';\r\n        ctx.textAlign = 'center';\r\n        ctx.fillText(percent, x, y);\r\n      });\r\n    },\r\n  };\r\n\r\n  const PieLegend = ({\r\n    labels,\r\n    data,\r\n    colors,\r\n  }: {\r\n    labels: string[];\r\n    data: number[];\r\n    colors: string[];\r\n  }) => {\r\n    const total = data.reduce((a, b) => a + b, 0);\r\n    return (\r\n      <ul className=\"text-sm space-y-1\">\r\n        {labels.map((label, i) => (\r\n          <li key={i} className=\"flex items-center gap-2\">\r\n            <span className=\"block w-3 h-3 rounded\" style={{ backgroundColor: colors[i] }}></span>\r\n            {label} ({data[i]}) - {total ? ((data[i] / total) * 100).toFixed(1) : 0}%\r\n          </li>\r\n        ))}\r\n      </ul>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"w-full\">\r\n      <div className=\"w-full pb-2\">\r\n        <CardContent className=\"flex flex-col items-center justify-center\">\r\n          {isLoading ? (\r\n            <div className=\"text-center text-muted-foreground\">Loading...</div>\r\n          ) : (\r\n            <div className=\"flex flex-col gap-6\">\r\n              {/* Charts Row */}\r\n              <div className=\"flex flex-col md:flex-row gap-6 p-4\">\r\n                {/* Animated Piece Bar Chart */}\r\n                <div className={`${cardHoverClass} w-full md:w-7/12`}>\r\n                  <AnimatedPieceBarChart\r\n                    values={dataValues}\r\n                    labels={labels}\r\n                    colors={backgroundColors}\r\n                    animationDuration={1600}\r\n                    loopPause={1000}\r\n                  />\r\n                </div>\r\n\r\n                {/* Pie Chart + Legend */}\r\n                <div\r\n                  className={`${cardHoverClass} w-full md:w-5/12 flex items-center justify-center md:flex-row gap-6 p-4`}\r\n                >\r\n                  <div className=\"flex flex-col md:flex-row items-center justify-center gap-6\">\r\n                    {/* Pie Chart */}\r\n                    <div className=\"w-48 h-48\">\r\n                      <Pie\r\n                        key={loop}\r\n                        data={pieData}\r\n                        options={pieOptions}\r\n                        plugins={[piePercentPlugin]}\r\n                      />\r\n                    </div>\r\n\r\n                    {/* Legend */}\r\n                    <div className=\"md:w-40\">\r\n                      <PieLegend labels={labels} data={dataValues} colors={backgroundColors} />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              {/* Optional: Add a refresh button */}\r\n              <div className=\"flex justify-center\">\r\n                <button\r\n                  className=\"px-3 py-1 text-xs rounded bg-violet-700 text-white hover:bg-violet-800\"\r\n                  onClick={refresh}\r\n                >\r\n                  Refresh Data\r\n                </button>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n// Note: This component assumes you have the necessary API endpoints set up to fetch the counts."],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 5478, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/chart/fileStartsCharts.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { Bar, Pie } from 'react-chartjs-2';\r\nimport { Card, CardHeader, CardContent } from '@/components/ui/card';\r\nimport {\r\n  Chart as ChartJS,\r\n  CategoryScale,\r\n  LinearScale,\r\n  BarElement,\r\n  Title,\r\n  Tooltip,\r\n  Legend,\r\n  ArcElement,\r\n  ChartOptions,\r\n  Plugin,\r\n} from 'chart.js';\r\n\r\nChartJS.register(CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend, ArcElement);\r\n\r\nfunction formatSize(bytes: number) {\r\n  if (bytes >= 1024 * 1024) return (bytes / (1024 * 1024)).toFixed(2) + ' MB';\r\n  if (bytes >= 1024) return (bytes / 1024).toFixed(2) + ' KB';\r\n  return bytes + ' B';\r\n}\r\n\r\nconst pieModuleLabels = ['Projects', 'Events', 'Reports', 'Institutions'];\r\n\r\nexport default function FilesStatsCharts() {\r\n  const [loading, setLoading] = useState(true);\r\n  const [counts, setCounts] = useState({\r\n    'Project Images': 0,\r\n    'Project PDFs': 0,\r\n    'Event Images': 0,\r\n    'Event PDFs': 0,\r\n    'Report Images': 0,\r\n    'Report PDFs': 0,\r\n    'Institution Images': 0,\r\n  });\r\n  const [sizes, setSizes] = useState({\r\n    'Project Images': 0,\r\n    'Project PDFs': 0,\r\n    'Event Images': 0,\r\n    'Event PDFs': 0,\r\n    'Report Images': 0,\r\n    'Report PDFs': 0,\r\n    'Institution Images': 0,\r\n  });\r\n\r\n  useEffect(() => {\r\n    fetch('/api/file-stats')\r\n      .then((res) => res.json())\r\n      .then((data) => {\r\n        setCounts({\r\n          ...data.counts,\r\n          'Institution Images': data.counts['Institution Images'] ?? 0,\r\n        });\r\n        setSizes({\r\n          ...data.sizes,\r\n          'Institution Images': data.sizes['Institution Images'] ?? 0,\r\n        });\r\n        setLoading(false);\r\n      });\r\n  }, []);\r\n\r\n  const barLabels = [\r\n    'Project Images',\r\n    'Project PDFs',\r\n    'Event Images',\r\n    'Event PDFs',\r\n    'Report Images',\r\n    'Report PDFs',\r\n    'Institution Images',\r\n  ];\r\n\r\n  const barColors = [\r\n    '#7c3aed', // Projects\r\n    '#a78bfa', // Project PDFs\r\n    '#059669', // Events\r\n    '#34d399', // Event PDFs\r\n    '#f59e42', // Reports\r\n    '#fdba74', // Report PDFs\r\n    '#eab308', // Institutions (yellow)\r\n  ];\r\n\r\n  const chartBackgroundPlugin = {\r\n    id: 'chartBackgroundPlugin',\r\n    beforeDraw: (chart: any) => {\r\n      const { ctx, chartArea } = chart;\r\n      ctx.save();\r\n      ctx.fillStyle = '#f3f4f6'; // light gray\r\n      ctx.fillRect(\r\n        chartArea.left,\r\n        chartArea.top,\r\n        chartArea.right - chartArea.left,\r\n        chartArea.bottom - chartArea.top\r\n      );\r\n      ctx.strokeStyle = '#fff'; // outline color\r\n      ctx.lineWidth = 2;\r\n      ctx.strokeRect(\r\n        chartArea.left,\r\n        chartArea.top,\r\n        chartArea.right - chartArea.left,\r\n        chartArea.bottom - chartArea.top\r\n      );\r\n      ctx.restore();\r\n    },\r\n  };\r\n\r\n  const piePercentPlugin: Plugin<'pie'> = {\r\n    id: 'piePercentPlugin',\r\n    afterDraw(chart) {\r\n      const ctx = chart.ctx;\r\n      const dataset = chart.data.datasets[0];\r\n      const total = dataset.data.reduce((sum: number, val: any) => sum + val, 0);\r\n      dataset.data.forEach((value: any, index: number) => {\r\n        const meta = chart.getDatasetMeta(0);\r\n        const arc = meta.data[index];\r\n        const angle = (arc.startAngle + arc.endAngle) / 2;\r\n        const radius = (arc.outerRadius + arc.innerRadius) / 2;\r\n        const x = arc.x + Math.cos(angle) * radius;\r\n        const y = arc.y + Math.sin(angle) * radius;\r\n        const percent = ((value / total) * 100).toFixed(1) + '%';\r\n        ctx.fillStyle = '#fff';\r\n        ctx.font = 'bold 14px Arial';\r\n        ctx.textAlign = 'center';\r\n        ctx.fillText(percent, x, y);\r\n      });\r\n    },\r\n  };\r\n\r\n  const pieImagesData = {\r\n    labels: pieModuleLabels,\r\n    datasets: [\r\n      {\r\n        label: 'Images Count',\r\n        data: [\r\n          counts['Project Images'],\r\n          counts['Event Images'],\r\n          counts['Report Images'],\r\n          counts['Institution Images'],\r\n        ],\r\n        backgroundColor: ['#7c3aed', '#059669', '#f59e42', '#eab308'],\r\n      },\r\n    ],\r\n  };\r\n\r\n  const piePdfsData = {\r\n    labels: pieModuleLabels.slice(0, 3), // Only Projects, Events, Reports have PDFs\r\n    datasets: [\r\n      {\r\n        label: 'PDFs Count',\r\n        data: [counts['Project PDFs'], counts['Event PDFs'], counts['Report PDFs']],\r\n        backgroundColor: ['#a78bfa', '#34d399', '#fdba74'],\r\n      },\r\n    ],\r\n  };\r\n\r\n  const pieImagesSizeData = {\r\n    labels: pieModuleLabels,\r\n    datasets: [\r\n      {\r\n        label: 'Images Size (MB)',\r\n        data: [\r\n          +(sizes['Project Images'] / 1048576).toFixed(2),\r\n          +(sizes['Event Images'] / 1048576).toFixed(2),\r\n          +(sizes['Report Images'] / 1048576).toFixed(2),\r\n          +(sizes['Institution Images'] / 1048576).toFixed(2),\r\n        ],\r\n        backgroundColor: ['#7c3aed', '#059669', '#f59e42', '#eab308'],\r\n      },\r\n    ],\r\n  };\r\n\r\n  const piePdfsSizeData = {\r\n    labels: pieModuleLabels.slice(0, 3),\r\n    datasets: [\r\n      {\r\n        label: 'PDFs Size (MB)',\r\n        data: [\r\n          +(sizes['Project PDFs'] / 1048576).toFixed(2),\r\n          +(sizes['Event PDFs'] / 1048576).toFixed(2),\r\n          +(sizes['Report PDFs'] / 1048576).toFixed(2),\r\n        ],\r\n        backgroundColor: ['#a78bfa', '#34d399', '#fdba74'],\r\n      },\r\n    ],\r\n  };\r\n\r\n  const barDataCounts = {\r\n    labels: barLabels,\r\n    datasets: [\r\n      {\r\n        label: 'Count',\r\n        data: [\r\n          counts['Project Images'],\r\n          counts['Project PDFs'],\r\n          counts['Event Images'],\r\n          counts['Event PDFs'],\r\n          counts['Report Images'],\r\n          counts['Report PDFs'],\r\n          counts['Institution Images'],\r\n        ],\r\n        backgroundColor: barColors,\r\n      },\r\n    ],\r\n  };\r\n\r\n  const barDataSizes = {\r\n    labels: barLabels,\r\n    datasets: [\r\n      {\r\n        label: 'Size (MB)',\r\n        data: [\r\n          +(sizes['Project Images'] / 1048576).toFixed(2),\r\n          +(sizes['Project PDFs'] / 1048576).toFixed(2),\r\n          +(sizes['Event Images'] / 1048576).toFixed(2),\r\n          +(sizes['Event PDFs'] / 1048576).toFixed(2),\r\n          +(sizes['Report Images'] / 1048576).toFixed(2),\r\n          +(sizes['Report PDFs'] / 1048576).toFixed(2),\r\n          +(sizes['Institution Images'] / 1048576).toFixed(2),\r\n        ],\r\n        backgroundColor: barColors,\r\n      },\r\n    ],\r\n  };\r\n\r\n  const barOptions: ChartOptions<'bar'> = {\r\n    responsive: true,\r\n    plugins: {\r\n      legend: { display: false },\r\n    },\r\n    scales: {\r\n      x: {\r\n        ticks: {\r\n          font: { size: 16, weight: 'bold' },\r\n        },\r\n      },\r\n      y: {\r\n        beginAtZero: true,\r\n        ticks: {\r\n          font: { size: 16, weight: 'bold' },\r\n          precision: 0,\r\n        },\r\n      },\r\n    },\r\n  };\r\n\r\n  const pieOptions: ChartOptions<'pie'> = {\r\n    responsive: true,\r\n    plugins: {\r\n      legend: { display: false },\r\n      tooltip: { enabled: true },\r\n    },\r\n  };\r\n\r\n  const PieLegend = ({ labels, data, colors }: any) => {\r\n    const total = data.reduce((a: number, b: number) => a + b, 0);\r\n    return (\r\n      <ul className=\"text-sm\">\r\n        {labels.map((label: string, i: number) => (\r\n          <li key={i} className=\"flex items-center gap-2\">\r\n            <span className=\"block w-4 h-4 rounded\" style={{ backgroundColor: colors[i] }}></span>\r\n            {label} ({data[i]}) - {total ? ((data[i] / total) * 100).toFixed(1) : 0}%\r\n          </li>\r\n        ))}\r\n      </ul>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex justify-center\">\r\n      {/* File Size overview charts */}\r\n      <Card className=\"w-full max-w-6xl\">\r\n        <CardHeader className=\"font-bold text-lg text-center\">File Statistics</CardHeader>\r\n        <CardContent>\r\n          {loading ? (\r\n            <div className=\"py-8 text-center text-muted-foreground\">Loading...</div>\r\n          ) : (\r\n            <div className=\"flex flex-col gap-12\">\r\n              {/* --- Count Charts --- */}\r\n              <div className=\"flex flex-col md:flex-row gap-6\">\r\n                {/* Bar chart */}\r\n                <div className=\"w-full md:w-2/3 h-[350px]\">\r\n                  <div className=\"font-semibold mb-2\">Image & PDF Count</div>\r\n                  <Bar\r\n                    data={barDataCounts}\r\n                    options={barOptions}\r\n                    plugins={[chartBackgroundPlugin]}\r\n                  />\r\n                </div>\r\n\r\n                {/* Pie charts */}\r\n                <div className=\"w-full md:w-1/3 flex flex-col gap-6\">\r\n                  <div>\r\n                    <div className=\"font-semibold text-center mb-2\">Images File Stats</div>\r\n                    <div className=\"flex justify-center gap-4 items-center\">\r\n                      <div className=\"w-40 h-40\">\r\n                        <Pie\r\n                          data={pieImagesData}\r\n                          options={pieOptions}\r\n                          plugins={[piePercentPlugin]}\r\n                        />\r\n                      </div>\r\n                      <PieLegend\r\n                        labels={pieImagesData.labels}\r\n                        data={pieImagesData.datasets[0].data}\r\n                        colors={pieImagesData.datasets[0].backgroundColor}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div>\r\n                    <div className=\"font-semibold text-center mb-2\">PDF File Stats</div>\r\n                    <div className=\"flex justify-center gap-4 items-center\">\r\n                      <div className=\"w-40 h-40\">\r\n                        <Pie data={piePdfsData} options={pieOptions} plugins={[piePercentPlugin]} />\r\n                      </div>\r\n                      <PieLegend\r\n                        labels={piePdfsData.labels}\r\n                        data={piePdfsData.datasets[0].data}\r\n                        colors={piePdfsData.datasets[0].backgroundColor}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* --- Size Charts --- */}\r\n              <div className=\"flex flex-col md:flex-row gap-6\">\r\n                {/* Bar chart */}\r\n                <div className=\"w-full md:w-2/3 h-[350px]\">\r\n                  <div className=\"font-semibold mb-2 text-center\">Image & PDF Sizes (MB)</div>\r\n                  <Bar data={barDataSizes} options={barOptions} plugins={[chartBackgroundPlugin]} />\r\n                  <div className=\"text-sm mt-2\">\r\n                    Total Images Size:{' '}\r\n                    {formatSize(\r\n                      sizes['Project Images'] +\r\n                        sizes['Event Images'] +\r\n                        sizes['Report Images'] +\r\n                        sizes['Institution Images']\r\n                    )}\r\n                    , Total PDFs Size:{' '}\r\n                    {formatSize(sizes['Project PDFs'] + sizes['Event PDFs'] + sizes['Report PDFs'])}\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Pie charts */}\r\n                <div className=\"w-full md:w-1/3 flex flex-col gap-6\">\r\n                  <div>\r\n                    <div className=\"font-semibold text-center mb-2\">Images Size Stats</div>\r\n                    <div className=\"flex justify-center gap-4 items-center\">\r\n                      <div className=\"w-40 h-40\">\r\n                        <Pie\r\n                          data={pieImagesSizeData}\r\n                          options={pieOptions}\r\n                          plugins={[piePercentPlugin]}\r\n                        />\r\n                      </div>\r\n                      <PieLegend\r\n                        labels={pieImagesSizeData.labels}\r\n                        data={pieImagesSizeData.datasets[0].data}\r\n                        colors={pieImagesSizeData.datasets[0].backgroundColor}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div>\r\n                    <div className=\"font-semibold text-center mb-2\">PDF Size Stats</div>\r\n                    <div className=\"flex justify-center gap-4 items-center\">\r\n                      <div className=\"w-40 h-40\">\r\n                        <Pie\r\n                          data={piePdfsSizeData}\r\n                          options={pieOptions}\r\n                          plugins={[piePercentPlugin]}\r\n                        />\r\n                      </div>\r\n                      <PieLegend\r\n                        labels={piePdfsSizeData.labels}\r\n                        data={piePdfsSizeData.datasets[0].data}\r\n                        colors={piePdfsSizeData.datasets[0].backgroundColor}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n// This file is responsible for displaying file statistics charts in the admin dashboard.\r\n// It fetches file counts and sizes from the API and renders bar and pie charts using Chart.js.\r\n// The charts include:    "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 6145, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/chartSection.tsx"],"sourcesContent":["'use client';\r\n\r\nimport AnimatedStats from './chart/animatedStats';\r\nimport DashboardChart from './chart/dashboardChart';\r\nimport FilesStatsCharts from './chart/fileStartsCharts';\r\n\r\nexport default function ChartSection() {\r\n  return (\r\n    <div className=\"flex flex-col gap-4\">\r\n      <AnimatedStats />\r\n      <DashboardChart />\r\n      <FilesStatsCharts />\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAJA;;;;;AAMe,SAAS;IACtB,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC,iKAAA,CAAA,UAAa;;;;;0BACd,8OAAC,kKAAA,CAAA,UAAc;;;;;0BACf,8OAAC,oKAAA,CAAA,UAAgB;;;;;;;;;;;AAGvB","debugId":null}},
    {"offset": {"line": 6189, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/data-table/columns/projects.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { ColumnDef } from \"@tanstack/react-table\";\r\nimport { Project } from \"@/lib/generated/prisma\";\r\nimport { Button } from '@/components/ui/button';\r\n\r\ntype ProjectWithUser = Project & {\r\n  createdBy: {\r\n    firstName: string;\r\n    lastName: string;\r\n  };\r\n};\r\n\r\n// Accept props for custom handlers\r\nexport function projectColumns({\r\n  onEdit,\r\n  onDelete,\r\n}: {\r\n  onEdit: (project: ProjectWithUser) => void;\r\n  onDelete: (id: number) => void;\r\n}): ColumnDef<ProjectWithUser>[] {\r\n  return [\r\n    {\r\n      accessorKey: 'title',\r\n      header: 'Title',\r\n      cell: ({ row }) => (\r\n        <div className=\"whitespace-normal break-words max-w-xs\">{row.getValue('title')}</div>\r\n      ),\r\n    },\r\n    {\r\n      accessorKey: 'createdAt',\r\n      header: 'Created At',\r\n      cell: ({ row }) => new Date(row.getValue('createdAt')).toLocaleDateString(),\r\n    },\r\n    {\r\n      accessorKey: 'updatedAt',\r\n      header: 'Updated At',\r\n      cell: ({ row }) => new Date(row.getValue('updatedAt')).toLocaleDateString(),\r\n    },\r\n    {\r\n      id: 'createdBy',\r\n      header: 'Created By',\r\n      cell: ({ row }) => {\r\n        const createdBy = row.original.createdBy;\r\n        if (!createdBy) return '--';\r\n        return `${createdBy.firstName} ${createdBy.lastName}`;\r\n      },\r\n    },\r\n    {\r\n      accessorKey: 'projectStatus',\r\n      header: 'Status',\r\n    },\r\n    {\r\n      accessorKey: 'publishStatus',\r\n      header: 'Publish',\r\n    },\r\n    {\r\n      id: 'actions',\r\n      header: 'Actions',\r\n      cell: ({ row }) => (\r\n        <Button type=\"button\" size=\"sm\" variant=\"outline\" onClick={() => onEdit(row.original)}>\r\n          Edit\r\n        </Button>\r\n      ),\r\n    },\r\n    {\r\n      id: 'delete',\r\n      header: 'Delete',\r\n      cell: ({ row }) => (\r\n        <Button\r\n          type=\"button\"\r\n          size=\"sm\"\r\n          variant=\"destructive\"\r\n          onClick={() => onDelete(row.original.id)}\r\n        >\r\n          Delete\r\n        </Button>\r\n      ),\r\n    },\r\n  ];\r\n}"],"names":[],"mappings":";;;;AAIA;AAJA;;;AAcO,SAAS,eAAe,EAC7B,MAAM,EACN,QAAQ,EAIT;IACC,OAAO;QACL;YACE,aAAa;YACb,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,iBACZ,8OAAC;oBAAI,WAAU;8BAA0C,IAAI,QAAQ,CAAC;;;;;;QAE1E;QACA;YACE,aAAa;YACb,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAI,KAAK,IAAI,QAAQ,CAAC,cAAc,kBAAkB;QAC3E;QACA;YACE,aAAa;YACb,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAI,KAAK,IAAI,QAAQ,CAAC,cAAc,kBAAkB;QAC3E;QACA;YACE,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE;gBACZ,MAAM,YAAY,IAAI,QAAQ,CAAC,SAAS;gBACxC,IAAI,CAAC,WAAW,OAAO;gBACvB,OAAO,GAAG,UAAU,SAAS,CAAC,CAAC,EAAE,UAAU,QAAQ,EAAE;YACvD;QACF;QACA;YACE,aAAa;YACb,QAAQ;QACV;QACA;YACE,aAAa;YACb,QAAQ;QACV;QACA;YACE,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,iBACZ,8OAAC,2HAAA,CAAA,SAAM;oBAAC,MAAK;oBAAS,MAAK;oBAAK,SAAQ;oBAAU,SAAS,IAAM,OAAO,IAAI,QAAQ;8BAAG;;;;;;QAI3F;QACA;YACE,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,iBACZ,8OAAC,2HAAA,CAAA,SAAM;oBACL,MAAK;oBACL,MAAK;oBACL,SAAQ;oBACR,SAAS,IAAM,SAAS,IAAI,QAAQ,CAAC,EAAE;8BACxC;;;;;;QAIL;KACD;AACH","debugId":null}},
    {"offset": {"line": 6276, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/views/projectView.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport dynamic from 'next/dynamic';\r\nimport { Button } from '@/components/ui/button';\r\nimport '@/assets/styles/tiptap-editor.css';\r\n\r\nconst TiptapJsonViewer = dynamic(() => import('@/components/editor/tiptap-json-viewer'), {\r\n  ssr: false,\r\n});\r\n\r\ntype ProjectType = {\r\n  id?: number | string;\r\n  title?: string | null;\r\n  slug?: string | null;\r\n  content?: unknown;\r\n  images?: string[] | null;\r\n  projectStatus?: string | null;\r\n  publishStatus?: string | null;\r\n  createdAt?: string | Date | null;\r\n  updatedAt?: string | Date | null;\r\n  createdBy?: {\r\n    firstName?: string | null;\r\n    lastName?: string | null;\r\n    username?: string | null;\r\n  } | null;\r\n};\r\n\r\n/**\r\n * ProjectView - display a single project's details inside a modal/dialog\r\n */\r\nexport default function ProjectView({\r\n  data,\r\n  onClose,\r\n}: {\r\n  data: ProjectType | null | undefined;\r\n  onClose?: () => void;\r\n}) {\r\n  if (!data) return null;\r\n\r\n  const renderContent = (c: unknown) => {\r\n    if (c === undefined || c === null) return <span className=\"text-sm text-muted\">-</span>;\r\n    if (typeof c === 'object') {\r\n      return (\r\n        <div className=\"rounded border bg-white dark:bg-gray-900 p-3\">\r\n          <TiptapJsonViewer content={c} className=\"tiptap tiptap-view-only\" />\r\n        </div>\r\n      );\r\n    }\r\n    return <div className=\"whitespace-pre-line\">{String(c)}</div>;\r\n  };\r\n\r\n  const created = data.createdAt ? new Date(data.createdAt).toLocaleString() : '-';\r\n  const updated = data.updatedAt ? new Date(data.updatedAt).toLocaleString() : '-';\r\n\r\n  return (\r\n    <div className=\"w-full max-w-4xl mx-auto p-4 space-y-4\">\r\n      <div className=\"flex items-start justify-between gap-4\">\r\n        <div>\r\n          <h2 className=\"text-xl font-semibold\">{data.title}</h2>\r\n          <div className=\"text-sm text-gray-600 dark:text-gray-300 mt-1\">\r\n            {data.createdBy\r\n              ? `${data.createdBy.firstName ?? ''} ${data.createdBy.lastName ?? ''}`\r\n              : 'System'}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"text-sm text-gray-500 text-right\">\r\n          <div>\r\n            Status: <span className=\"font-medium\">{data.projectStatus ?? '-'}</span>\r\n          </div>\r\n          <div>\r\n            Publish: <span className=\"font-medium\">{data.publishStatus ?? '-'}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div>\r\n        <div className=\"text-sm text-gray-500\">Content</div>\r\n        <div className=\"mt-2\">{renderContent(data.content)}</div>\r\n      </div>\r\n\r\n      {Array.isArray(data.images) && data.images.length > 0 && (\r\n        <div>\r\n          <div className=\"text-sm text-gray-500 mb-2\">Images</div>\r\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\r\n            {data.images.map((img) => (\r\n              <img\r\n                key={img}\r\n                src={img}\r\n                alt=\"project\"\r\n                className=\"w-full h-28 object-cover rounded border\"\r\n              />\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"flex justify-between items-center\">\r\n        <div className=\"text-xs text-gray-500\">\r\n          Created: {created} · Updated: {updated}\r\n        </div>\r\n\r\n        <div className=\"flex gap-2\">\r\n          {onClose && (\r\n            <Button variant=\"outline\" onClick={onClose}>\r\n              Close\r\n            </Button>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAGA;AACA;;AAJA;;;;;AAOA,MAAM,mBAAmB,CAAA,GAAA,+JAAA,CAAA,UAAO,AAAD;;;;;;IAC7B,KAAK;;AAuBQ,SAAS,YAAY,EAClC,IAAI,EACJ,OAAO,EAIR;IACC,IAAI,CAAC,MAAM,OAAO;IAElB,MAAM,gBAAgB,CAAC;QACrB,IAAI,MAAM,aAAa,MAAM,MAAM,qBAAO,8OAAC;YAAK,WAAU;sBAAqB;;;;;;QAC/E,IAAI,OAAO,MAAM,UAAU;YACzB,qBACE,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAiB,SAAS;oBAAG,WAAU;;;;;;;;;;;QAG9C;QACA,qBAAO,8OAAC;YAAI,WAAU;sBAAuB,OAAO;;;;;;IACtD;IAEA,MAAM,UAAU,KAAK,SAAS,GAAG,IAAI,KAAK,KAAK,SAAS,EAAE,cAAc,KAAK;IAC7E,MAAM,UAAU,KAAK,SAAS,GAAG,IAAI,KAAK,KAAK,SAAS,EAAE,cAAc,KAAK;IAE7E,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;;0CACC,8OAAC;gCAAG,WAAU;0CAAyB,KAAK,KAAK;;;;;;0CACjD,8OAAC;gCAAI,WAAU;0CACZ,KAAK,SAAS,GACX,GAAG,KAAK,SAAS,CAAC,SAAS,IAAI,GAAG,CAAC,EAAE,KAAK,SAAS,CAAC,QAAQ,IAAI,IAAI,GACpE;;;;;;;;;;;;kCAIR,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;;oCAAI;kDACK,8OAAC;wCAAK,WAAU;kDAAe,KAAK,aAAa,IAAI;;;;;;;;;;;;0CAE/D,8OAAC;;oCAAI;kDACM,8OAAC;wCAAK,WAAU;kDAAe,KAAK,aAAa,IAAI;;;;;;;;;;;;;;;;;;;;;;;;0BAKpE,8OAAC;;kCACC,8OAAC;wBAAI,WAAU;kCAAwB;;;;;;kCACvC,8OAAC;wBAAI,WAAU;kCAAQ,cAAc,KAAK,OAAO;;;;;;;;;;;;YAGlD,MAAM,OAAO,CAAC,KAAK,MAAM,KAAK,KAAK,MAAM,CAAC,MAAM,GAAG,mBAClD,8OAAC;;kCACC,8OAAC;wBAAI,WAAU;kCAA6B;;;;;;kCAC5C,8OAAC;wBAAI,WAAU;kCACZ,KAAK,MAAM,CAAC,GAAG,CAAC,CAAC,oBAChB,8OAAC;gCAEC,KAAK;gCACL,KAAI;gCACJ,WAAU;+BAHL;;;;;;;;;;;;;;;;0BAUf,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;4BAAwB;4BAC3B;4BAAQ;4BAAa;;;;;;;kCAGjC,8OAAC;wBAAI,WAAU;kCACZ,yBACC,8OAAC,2HAAA,CAAA,SAAM;4BAAC,SAAQ;4BAAU,SAAS;sCAAS;;;;;;;;;;;;;;;;;;;;;;;AAQxD","debugId":null}},
    {"offset": {"line": 6521, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/components/ui/input.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Input({ className, type, ...props }: React.ComponentProps<\"input\">) {\n  return (\n    <input\n      type={type}\n      data-slot=\"input\"\n      className={cn(\n        \"file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        \"focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]\",\n        \"aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Input }\n"],"names":[],"mappings":";;;;AAEA;;;AAEA,SAAS,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAsC;IACzE,qBACE,8OAAC;QACC,MAAM;QACN,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EACV,mcACA,iFACA,0GACA;QAED,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 6547, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/components/ui/label.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Label({\n  className,\n  ...props\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\n  return (\n    <LabelPrimitive.Root\n      data-slot=\"label\"\n      className={cn(\n        \"flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Label }\n"],"names":[],"mappings":";;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,MAAM,EACb,SAAS,EACT,GAAG,OAC8C;IACjD,qBACE,8OAAC,iKAAA,CAAA,OAAmB;QAClB,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EACV,uNACA;QAED,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 6575, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/createProjectForm.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport dynamic from \"next/dynamic\";\r\nimport \"@/assets/styles/tiptap-editor.css\";\r\n\r\nconst EditorClient = dynamic(() => import(\"@/components/editor/editor-client\"), {\r\n  ssr: false,\r\n});\r\n\r\nconst projectStatusOptions = [\"active\", \"completed\", \"paused\"] as const;\r\nconst publishOptions = [\"draft\", \"published\"] as const;\r\n\r\ntype ProjectStatus = (typeof projectStatusOptions)[number];\r\ntype PublishStatus = (typeof publishOptions)[number];\r\n\r\ntype ProjectFormProps = {\r\n  mode?: \"create\" | \"edit\";\r\n  initialData?: {\r\n    id?: string;\r\n    title: string;\r\n    content: object;\r\n    projectStatus: ProjectStatus;\r\n    publishStatus: PublishStatus;\r\n    images?: string[];\r\n  };\r\n  onSuccess?: () => void;\r\n  onCancel?: () => void;\r\n};\r\n\r\nexport default function CreateProjectForm({\r\n  mode = \"create\",\r\n  initialData,\r\n  onSuccess,\r\n  onCancel,\r\n}: ProjectFormProps) {\r\n  const router = useRouter();\r\n  const [form, setForm] = useState({\r\n    title: \"\",\r\n    content: {},\r\n    files: null as FileList | null,\r\n    projectStatus: \"active\" as ProjectStatus,\r\n    publishStatus: \"draft\" as PublishStatus,\r\n    images: [] as string[],\r\n  });\r\n  const [imagesToRemove, setImagesToRemove] = useState<string[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [deleting, setDeleting] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (initialData) {\r\n      setForm((prev) => ({\r\n        ...prev,\r\n        title: initialData.title || \"\",\r\n        content: initialData.content || {},\r\n        projectStatus: initialData.projectStatus || \"active\",\r\n        publishStatus: initialData.publishStatus || \"draft\",\r\n        images: initialData.images || [],\r\n      }));\r\n    }\r\n  }, [initialData]);\r\n\r\n  const handleChange = (\r\n    e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>\r\n  ) => {\r\n    const { name, value, files } = e.target as (HTMLInputElement & HTMLSelectElement);\r\n    if (name === \"files\" && files) {\r\n      setForm((prev) => ({ ...prev, files }));\r\n    } else {\r\n      setForm((prev) => ({ ...prev, [name]: value }));\r\n    }\r\n  };\r\n\r\n  const handleEditorChange = (json: object) => {\r\n    setForm((prev) => ({ ...prev, content: json }));\r\n  };\r\n\r\n  const handleRemoveImage = (url: string) => {\r\n    setImagesToRemove((prev) => [...prev, url]);\r\n    setForm((prev) => ({\r\n      ...prev,\r\n      images: prev.images.filter((img) => img !== url),\r\n    }));\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n\r\n    if (mode === \"create\" && (!form.files || form.files.length === 0)) {\r\n      alert(\"Please upload at least one image.\");\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    const formData = new FormData();\r\n    formData.append(\"title\", form.title.trim());\r\n    formData.append(\"content\", JSON.stringify(form.content));\r\n    formData.append(\"projectStatus\", form.projectStatus);\r\n    formData.append(\"publishStatus\", form.publishStatus);\r\n\r\n    if (mode === \"edit\") {\r\n      formData.append(\"images\", JSON.stringify(form.images));\r\n      formData.append(\"imagesToRemove\", JSON.stringify(imagesToRemove));\r\n    }\r\n\r\n    if (form.files && form.files.length > 0) {\r\n      Array.from(form.files).forEach((file) => {\r\n        formData.append(\"files\", file);\r\n      });\r\n    }\r\n\r\n    try {\r\n      let res;\r\n      if (mode === \"edit\" && initialData?.id) {\r\n        res = await fetch(`/api/projects/${initialData.id}`, {\r\n          method: \"PATCH\",\r\n          body: formData,\r\n        });\r\n      } else {\r\n        res = await fetch(\"/api/projects/upload\", {\r\n          method: \"POST\",\r\n          body: formData,\r\n        });\r\n      }\r\n\r\n      if (!res.ok) {\r\n        const errorData = await res.json().catch(() => null);\r\n        const errorMessage = errorData?.error || `Failed to ${mode} project`;\r\n        throw new Error(errorMessage);\r\n      }\r\n\r\n      if (onSuccess) onSuccess();\r\n      router.refresh();\r\n      router.push(\"/admin/dashboard\");\r\n\r\n    } catch (err) {\r\n      alert(`There was an error ${mode === \"edit\" ? \"updating\" : \"creating\"} the project. Please try again.`);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // --- DELETE HANDLER ---\r\n  const handleDelete = async () => {\r\n    if (!initialData?.id) return;\r\n    if (!window.confirm(\"Are you sure you want to delete this project? This action cannot be undone.\")) return;\r\n\r\n    setDeleting(true);\r\n    try {\r\n      const res = await fetch(`/api/projects/${initialData.id}`, {\r\n        method: \"DELETE\",\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const errorData = await res.json().catch(() => null);\r\n        const errorMessage = errorData?.error || \"Failed to delete project\";\r\n        throw new Error(errorMessage);\r\n      }\r\n\r\n      if (onSuccess) onSuccess();\r\n      router.refresh();\r\n      router.push(\"/admin/dashboard\");\r\n    } catch (err) {\r\n      alert(\"There was an error deleting the project. Please try again.\");\r\n    } finally {\r\n      setDeleting(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <form\r\n      onSubmit={handleSubmit}\r\n      className=\"w-full max-w-4xl mx-auto mt-4 space-y-6 p-6 bg-background rounded-xl shadow\"\r\n      encType=\"multipart/form-data\"\r\n    >\r\n      <div className=\"text-2xl font-bold mb-4 text-center\">\r\n        {mode === \"edit\" ? \"Edit Project\" : \"Create New Project\"}\r\n      </div>\r\n      {/* Title */}\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"title\">Title</Label>\r\n        <Input\r\n          id=\"title\"\r\n          name=\"title\"\r\n          value={form.title}\r\n          onChange={handleChange}\r\n          required\r\n        />\r\n      </div>\r\n      {/* Content (Tiptap JSON) */}\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"content\">Content</Label>\r\n        <EditorClient\r\n          key={form.title}\r\n          content={form.content}\r\n          onChange={handleEditorChange}\r\n          showLinkUnlink\r\n        />\r\n      </div>\r\n      {/* Existing Images (edit mode) */}\r\n      {mode === \"edit\" && form.images && form.images.length > 0 && (\r\n        <div className=\"space-y-2\">\r\n          <Label>Current Images</Label>\r\n          <div className=\"flex flex-wrap gap-4\">\r\n            {form.images.map((img) => (\r\n              <div key={img} className=\"relative\">\r\n                <img\r\n                  src={img}\r\n                  alt=\"Project\"\r\n                  className=\"w-24 h-24 object-cover rounded border\"\r\n                />\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"absolute top-0 right-0 bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center\"\r\n                  onClick={() => handleRemoveImage(img)}\r\n                >\r\n                  &times;\r\n                </button>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n      {/* Image Upload */}\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"files\">\r\n          {mode === \"edit\"\r\n            ? \"Image Upload (optional, will replace/add to current images)\"\r\n            : \"Image Upload (required)\"}\r\n        </Label>\r\n        <Input\r\n          id=\"files\"\r\n          name=\"files\"\r\n          type=\"file\"\r\n          accept=\"image/png,image/jpeg\"\r\n          multiple\r\n          onChange={handleChange}\r\n          required={mode === \"create\"}\r\n        />\r\n      </div>\r\n      {/* Publish Status */}\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"publishStatus\">Publish Status</Label>\r\n        <select\r\n          id=\"publishStatus\"\r\n          name=\"publishStatus\"\r\n          value={form.publishStatus}\r\n          onChange={handleChange}\r\n          className=\"w-full border border-input rounded-md p-2 text-sm bg-background text-foreground\"\r\n        >\r\n          {publishOptions.map((status) => (\r\n            <option key={status} value={status}>\r\n              {status}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n      {/* Project Status */}\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"projectStatus\">Project Status</Label>\r\n        <select\r\n          id=\"projectStatus\"\r\n          name=\"projectStatus\"\r\n          value={form.projectStatus}\r\n          onChange={handleChange}\r\n          className=\"w-full border border-input rounded-md p-2 text-sm bg-background text-foreground\"\r\n        >\r\n          {projectStatusOptions.map((status) => (\r\n            <option key={status} value={status}>\r\n              {status}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n      <div className=\"flex gap-4 w-full\">\r\n        <Button\r\n          type=\"submit\"\r\n          disabled={loading}\r\n          className=\"w-1/2 bg-[#9f004d]\">\r\n          {loading\r\n            ? mode === \"edit\"\r\n              ? \"Updating...\"\r\n              : \"Creating...\"\r\n            : mode === \"edit\"\r\n              ? \"Update Project\"\r\n              : \"Create Project\"}\r\n        </Button>\r\n        <Button\r\n          type=\"button\"\r\n          onClick={onCancel}\r\n          disabled={loading}\r\n          className=\"w-1/2 bg-black\">\r\n          Cancel\r\n        </Button>\r\n       \r\n      </div>\r\n    </form>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 7004, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/sections/ProjectsSection.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useMemo, useState, useEffect } from 'react';\r\nimport { DataTable } from '@/app/(admin)/admin/dashboard/data-table/data-table/data-table';\r\nimport { projectColumns } from '@/app/(admin)/admin/dashboard/data-table/columns/projects';\r\nimport ProjectView from '@/app/(admin)/admin/dashboard/components/views/projectView';\r\nimport CreateProjectForm from '@/app/(admin)/admin/dashboard/createProjectForm';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\n\r\nexport default function ProjectsSection({\r\n  paginatedData,\r\n  page,\r\n  rowsPerPage,\r\n  handleEdit,\r\n  handleDelete,\r\n  currentUserRole,\r\n  TableActions,\r\n}: {\r\n  paginatedData: any[];\r\n  page: number;\r\n  rowsPerPage: number;\r\n  handleEdit: (record: any) => void;\r\n  handleDelete: (id: string | number) => void;\r\n  currentUserRole: string;\r\n  TableActions: React.FC<any>;\r\n}) {\r\n  const [viewing, setViewing] = useState<any | null>(null);\r\n  const [openCreate, setOpenCreate] = useState(false);\r\n  const [data, setData] = useState<any[]>(paginatedData ?? []);\r\n\r\n  useEffect(() => {\r\n    setData(paginatedData ?? []);\r\n  }, [paginatedData]);\r\n\r\n  const baseCols = useMemo(\r\n    () =>\r\n      projectColumns({\r\n        onEdit: handleEdit,\r\n        onDelete: (id: number) => handleDelete(id),\r\n      }),\r\n    [handleEdit, handleDelete]\r\n  );\r\n\r\n  const viewColumn = {\r\n    id: 'view',\r\n    header: 'View',\r\n    cell: ({ row }: any) => (\r\n      <Button size=\"sm\" onClick={() => setViewing(row.original)}>\r\n        View\r\n      </Button>\r\n    ),\r\n  };\r\n\r\n  const cols = useMemo(() => {\r\n    return [...baseCols.slice(0, -3), viewColumn, ...baseCols.slice(-3)];\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [baseCols]);\r\n\r\n  return (\r\n    <>\r\n      <div className=\"flex items-center justify-between mb-4\">\r\n        <div />\r\n        <div className=\"flex items-center gap-2\">\r\n          <Button onClick={() => setOpenCreate(true)} className=\"bg-green-600 text-white\">\r\n            Create Project\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      <DataTable columns={cols} data={data} />\r\n      <TableActions data={data} columns={cols} tableRef={React.createRef()} />\r\n\r\n      {/* View dialog */}\r\n      <Dialog open={!!viewing} onOpenChange={(val) => !val && setViewing(null)}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>Project details</DialogTitle>\r\n          </DialogHeader>\r\n          {viewing && <ProjectView data={viewing} onClose={() => setViewing(null)} />}\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Create dialog */}\r\n      <Dialog open={openCreate} onOpenChange={(val) => !val && setOpenCreate(false)}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>Create Project</DialogTitle>\r\n          </DialogHeader>\r\n          <div className=\"p-4\">\r\n            <CreateProjectForm\r\n              mode=\"create\"\r\n              onSuccess={() => {\r\n                setOpenCreate(false);\r\n              }}\r\n              onCancel={() => setOpenCreate(false)}\r\n            />\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;;;;;;;;AAUe,SAAS,gBAAgB,EACtC,aAAa,EACb,IAAI,EACJ,WAAW,EACX,UAAU,EACV,YAAY,EACZ,eAAe,EACf,YAAY,EASb;IACC,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAc;IACnD,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC7C,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAS,iBAAiB,EAAE;IAE3D,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,QAAQ,iBAAiB,EAAE;IAC7B,GAAG;QAAC;KAAc;IAElB,MAAM,WAAW,CAAA,GAAA,qMAAA,CAAA,UAAO,AAAD,EACrB,IACE,CAAA,GAAA,+KAAA,CAAA,iBAAc,AAAD,EAAE;YACb,QAAQ;YACR,UAAU,CAAC,KAAe,aAAa;QACzC,IACF;QAAC;QAAY;KAAa;IAG5B,MAAM,aAAa;QACjB,IAAI;QACJ,QAAQ;QACR,MAAM,CAAC,EAAE,GAAG,EAAO,iBACjB,8OAAC,2HAAA,CAAA,SAAM;gBAAC,MAAK;gBAAK,SAAS,IAAM,WAAW,IAAI,QAAQ;0BAAG;;;;;;IAI/D;IAEA,MAAM,OAAO,CAAA,GAAA,qMAAA,CAAA,UAAO,AAAD,EAAE;QACnB,OAAO;eAAI,SAAS,KAAK,CAAC,GAAG,CAAC;YAAI;eAAe,SAAS,KAAK,CAAC,CAAC;SAAG;IACpE,uDAAuD;IACzD,GAAG;QAAC;KAAS;IAEb,qBACE;;0BACE,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;;;;;kCACD,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC,2HAAA,CAAA,SAAM;4BAAC,SAAS,IAAM,cAAc;4BAAO,WAAU;sCAA0B;;;;;;;;;;;;;;;;;0BAMpF,8OAAC,0LAAA,CAAA,YAAS;gBAAC,SAAS;gBAAM,MAAM;;;;;;0BAChC,8OAAC;gBAAa,MAAM;gBAAM,SAAS;gBAAM,wBAAU,qMAAA,CAAA,UAAK,CAAC,SAAS;;;;;;0BAGlE,8OAAC,2HAAA,CAAA,SAAM;gBAAC,MAAM,CAAC,CAAC;gBAAS,cAAc,CAAC,MAAQ,CAAC,OAAO,WAAW;0BACjE,cAAA,8OAAC,2HAAA,CAAA,gBAAa;;sCACZ,8OAAC,2HAAA,CAAA,eAAY;sCACX,cAAA,8OAAC,2HAAA,CAAA,cAAW;0CAAC;;;;;;;;;;;wBAEd,yBAAW,8OAAC,6KAAA,CAAA,UAAW;4BAAC,MAAM;4BAAS,SAAS,IAAM,WAAW;;;;;;;;;;;;;;;;;0BAKtE,8OAAC,2HAAA,CAAA,SAAM;gBAAC,MAAM;gBAAY,cAAc,CAAC,MAAQ,CAAC,OAAO,cAAc;0BACrE,cAAA,8OAAC,2HAAA,CAAA,gBAAa;;sCACZ,8OAAC,2HAAA,CAAA,eAAY;sCACX,cAAA,8OAAC,2HAAA,CAAA,cAAW;0CAAC;;;;;;;;;;;sCAEf,8OAAC;4BAAI,WAAU;sCACb,cAAA,8OAAC,4JAAA,CAAA,UAAiB;gCAChB,MAAK;gCACL,WAAW;oCACT,cAAc;gCAChB;gCACA,UAAU,IAAM,cAAc;;;;;;;;;;;;;;;;;;;;;;;;AAO5C","debugId":null}},
    {"offset": {"line": 7205, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/data-table/columns/events.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { ColumnDef } from \"@tanstack/react-table\";\r\nimport { Event } from \"@/lib/generated/prisma\";\r\nimport { Button } from \"@/components/ui/button\";\r\n\r\ntype EventWithUser = Event & {\r\n    createdBy: {\r\n        firstName: string;\r\n        lastName: string;\r\n    };\r\n};\r\n\r\n// Accept props for custom handlers\r\nexport function eventColumns({\r\n  onEdit,\r\n  onDelete,\r\n}: {\r\n  onEdit: (event: EventWithUser) => void;\r\n  onDelete: (eventId: number) => void;\r\n}): ColumnDef<EventWithUser>[] {\r\n  return [\r\n    {\r\n      accessorKey: \"eventTitle\",\r\n      header: \"Title\",\r\n      cell: ({ row }) => (\r\n        <div className=\"whitespace-normal break-words max-w-xs\">\r\n          {row.getValue(\"eventTitle\")}\r\n        </div>\r\n      ),\r\n    },\r\n    {\r\n      accessorKey: \"eventStartDate\",\r\n      header: \"Start Date\",\r\n      cell: ({ row }) =>\r\n        row.getValue(\"eventStartDate\")\r\n          ? new Date(row.getValue(\"eventStartDate\")).toLocaleDateString()\r\n          : \"\",\r\n    },\r\n    {\r\n      accessorKey: \"eventEndDate\",\r\n      header: \"End Date\",\r\n      cell: ({ row }) =>\r\n        row.getValue(\"eventEndDate\")\r\n          ? new Date(row.getValue(\"eventEndDate\")).toLocaleDateString()\r\n          : \"\",\r\n    },\r\n    {\r\n      accessorKey: \"createdAt\",\r\n      header: \"Created At\",\r\n      cell: ({ row }) =>\r\n        new Date(row.getValue(\"createdAt\")).toLocaleDateString(),\r\n    },\r\n    {\r\n      accessorKey: \"updatedAt\",\r\n      header: \"Updated At\",\r\n      cell: ({ row }) =>\r\n        new Date(row.getValue(\"updatedAt\")).toLocaleDateString(),\r\n    },\r\n    {\r\n      id: \"createdBy\",\r\n      header: \"Created By\",\r\n      cell: ({ row }) => {\r\n        const createdBy = row.original.createdBy;\r\n        if (!createdBy) return \"-\";\r\n        return `${createdBy.firstName} ${createdBy.lastName}`;\r\n      },\r\n      \r\n    },\r\n    {\r\n      accessorKey: \"eventStatus\",\r\n      header: \"Status\",\r\n    },\r\n    {\r\n      accessorKey: \"publishStatus\",\r\n      header: \"Publish\",\r\n    },\r\n    {\r\n      id: \"actions\",\r\n      header: \"Actions\",\r\n      cell: ({ row }) => (\r\n        <Button\r\n          type=\"button\"\r\n          size=\"sm\"\r\n          variant=\"outline\"\r\n          onClick={() => onEdit(row.original)}\r\n        >\r\n          Edit\r\n        </Button>\r\n      ),\r\n    },\r\n    {\r\n      id: \"delete\",\r\n      header: \"Delete\",\r\n      cell: ({ row }) => (\r\n        <Button\r\n          type=\"button\"\r\n          size=\"sm\"\r\n          variant=\"destructive\"\r\n          onClick={() => onDelete(row.original.id)}\r\n        >\r\n          Delete\r\n        </Button>\r\n      ),\r\n    },\r\n  ];\r\n}"],"names":[],"mappings":";;;;AAIA;AAJA;;;AAcO,SAAS,aAAa,EAC3B,MAAM,EACN,QAAQ,EAIT;IACC,OAAO;QACL;YACE,aAAa;YACb,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,iBACZ,8OAAC;oBAAI,WAAU;8BACZ,IAAI,QAAQ,CAAC;;;;;;QAGpB;QACA;YACE,aAAa;YACb,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,GACZ,IAAI,QAAQ,CAAC,oBACT,IAAI,KAAK,IAAI,QAAQ,CAAC,mBAAmB,kBAAkB,KAC3D;QACR;QACA;YACE,aAAa;YACb,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,GACZ,IAAI,QAAQ,CAAC,kBACT,IAAI,KAAK,IAAI,QAAQ,CAAC,iBAAiB,kBAAkB,KACzD;QACR;QACA;YACE,aAAa;YACb,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,GACZ,IAAI,KAAK,IAAI,QAAQ,CAAC,cAAc,kBAAkB;QAC1D;QACA;YACE,aAAa;YACb,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,GACZ,IAAI,KAAK,IAAI,QAAQ,CAAC,cAAc,kBAAkB;QAC1D;QACA;YACE,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE;gBACZ,MAAM,YAAY,IAAI,QAAQ,CAAC,SAAS;gBACxC,IAAI,CAAC,WAAW,OAAO;gBACvB,OAAO,GAAG,UAAU,SAAS,CAAC,CAAC,EAAE,UAAU,QAAQ,EAAE;YACvD;QAEF;QACA;YACE,aAAa;YACb,QAAQ;QACV;QACA;YACE,aAAa;YACb,QAAQ;QACV;QACA;YACE,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,iBACZ,8OAAC,2HAAA,CAAA,SAAM;oBACL,MAAK;oBACL,MAAK;oBACL,SAAQ;oBACR,SAAS,IAAM,OAAO,IAAI,QAAQ;8BACnC;;;;;;QAIL;QACA;YACE,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,iBACZ,8OAAC,2HAAA,CAAA,SAAM;oBACL,MAAK;oBACL,MAAK;oBACL,SAAQ;oBACR,SAAS,IAAM,SAAS,IAAI,QAAQ,CAAC,EAAE;8BACxC;;;;;;QAIL;KACD;AACH","debugId":null}},
    {"offset": {"line": 7302, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/views/eventView.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport dynamic from 'next/dynamic';\r\nimport { Button } from '@/components/ui/button';\r\nimport '@/assets/styles/tiptap-editor.css';\r\n\r\nconst TiptapJsonViewer = dynamic(() => import('@/components/editor/tiptap-json-viewer'), {\r\n  ssr: false,\r\n});\r\n\r\ntype EventType = {\r\n  id?: number | string;\r\n  slug?: string;\r\n  eventTitle?: string | null;\r\n  eventDescription?: unknown;\r\n  eventDetails?: unknown;\r\n  eventLocation?: string | null;\r\n  eventBanner?: string | null;\r\n  eventImages?: string[] | null;\r\n  eventFile?: string | null;\r\n  eventStartDate?: string | Date | null;\r\n  eventEndDate?: string | Date | null;\r\n  eventTags?: string[] | null;\r\n  eventStatus?: string | null;\r\n  publishStatus?: string | null;\r\n  eventAttendance?: string | null;\r\n  maxAttendees?: number | null;\r\n  createdAt?: string | Date | null;\r\n  updatedAt?: string | Date | null;\r\n  createdBy?: {\r\n    firstName?: string | null;\r\n    lastName?: string | null;\r\n    username?: string | null;\r\n  } | null;\r\n  project?: { id?: number; title?: string } | null;\r\n  report?: { id?: number; title?: string } | null;\r\n};\r\n\r\n/**\r\n * EventView\r\n * Renders a detailed view of a single event (used inside a dialog/modal).\r\n */\r\nexport default function EventView({\r\n  data,\r\n  onClose,\r\n}: {\r\n  data: EventType | null | undefined;\r\n  onClose?: () => void;\r\n}) {\r\n  if (!data) return null;\r\n\r\n  const renderJson = (c: unknown) => {\r\n    if (c === undefined || c === null) return <span className=\"text-sm text-muted\">-</span>;\r\n    if (typeof c === 'object') {\r\n      return (\r\n        <div className=\"rounded border bg-white dark:bg-gray-900 p-3\">\r\n          <TiptapJsonViewer content={c} className=\"tiptap tiptap-view-only\" />\r\n        </div>\r\n      );\r\n    }\r\n    return <div className=\"whitespace-pre-line\">{String(c)}</div>;\r\n  };\r\n\r\n  const start = data.eventStartDate ? new Date(data.eventStartDate).toLocaleString() : '-';\r\n  const end = data.eventEndDate ? new Date(data.eventEndDate).toLocaleString() : '-';\r\n  const created = data.createdAt ? new Date(data.createdAt).toLocaleString() : '-';\r\n  const updated = data.updatedAt ? new Date(data.updatedAt).toLocaleString() : '-';\r\n\r\n  return (\r\n    <div className=\"w-full max-w-4xl mx-auto p-4 space-y-4\">\r\n      {/* Banner */}\r\n      {data.eventBanner ? (\r\n        <div className=\"w-full rounded overflow-hidden border\">\r\n          <img\r\n            src={data.eventBanner}\r\n            alt={data.eventTitle ?? 'Event banner'}\r\n            className=\"w-full object-cover\"\r\n          />\r\n        </div>\r\n      ) : null}\r\n\r\n      <div className=\"flex items-start justify-between gap-4\">\r\n        <div>\r\n          <h2 className=\"text-xl font-semibold\">{data.eventTitle}</h2>\r\n          <div className=\"text-sm text-gray-600 dark:text-gray-300 mt-1\">\r\n            {data.createdBy\r\n              ? `${data.createdBy.firstName ?? ''} ${data.createdBy.lastName ?? ''}`\r\n              : 'System'}\r\n            {data.project ? <span className=\"ml-3\">· Project: {data.project.title}</span> : null}\r\n            {data.report ? <span className=\"ml-3\">· Report: {data.report.title}</span> : null}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"text-sm text-gray-500 text-right\">\r\n          <div>Start: {start}</div>\r\n          <div>End: {end}</div>\r\n          <div className=\"mt-2\">\r\n            Status: <span className=\"font-medium\">{data.eventStatus ?? '-'}</span>\r\n          </div>\r\n          <div>\r\n            Publish: <span className=\"font-medium\">{data.publishStatus ?? '-'}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Location / tags / attendance */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3\">\r\n        <div>\r\n          <div className=\"text-xs text-gray-500\">Location</div>\r\n          <div className=\"font-medium\">{data.eventLocation ?? '-'}</div>\r\n        </div>\r\n\r\n        <div>\r\n          <div className=\"text-xs text-gray-500\">Attendance</div>\r\n          <div className=\"font-medium\">{data.eventAttendance ?? '-'}</div>\r\n          {typeof data.maxAttendees === 'number' && (\r\n            <div className=\"text-xs text-gray-500 mt-1\">Max attendees: {data.maxAttendees}</div>\r\n          )}\r\n        </div>\r\n\r\n        <div>\r\n          <div className=\"text-xs text-gray-500\">Tags</div>\r\n          <div className=\"flex flex-wrap gap-2 mt-1\">\r\n            {Array.isArray(data.eventTags) && data.eventTags.length > 0 ? (\r\n              data.eventTags.map((t) => (\r\n                <span key={t} className=\"text-xs px-2 py-0.5 rounded bg-gray-100 dark:bg-gray-800\">\r\n                  {t}\r\n                </span>\r\n              ))\r\n            ) : (\r\n              <span className=\"text-sm text-muted\">-</span>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Description */}\r\n      <div>\r\n        <div className=\"text-sm text-gray-500\">Description</div>\r\n        <div className=\"mt-2\">{renderJson(data.eventDescription)}</div>\r\n      </div>\r\n\r\n      {/* Additional details */}\r\n      {data.eventDetails && (\r\n        <div>\r\n          <div className=\"text-sm text-gray-500\">Details</div>\r\n          <div className=\"mt-2\">{renderJson(data.eventDetails)}</div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Images gallery */}\r\n      {Array.isArray(data.eventImages) && data.eventImages.length > 0 && (\r\n        <div>\r\n          <div className=\"text-sm text-gray-500 mb-2\">Images</div>\r\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\r\n            {data.eventImages.map((img) => (\r\n              <img\r\n                key={img}\r\n                src={img}\r\n                alt=\"event\"\r\n                className=\"w-full h-28 object-cover rounded border\"\r\n              />\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Attached file */}\r\n      {data.eventFile ? (\r\n        <div>\r\n          <div className=\"text-sm text-gray-500\">Attached File</div>\r\n          <div className=\"mt-2\">\r\n            <a\r\n              href={data.eventFile}\r\n              target=\"_blank\"\r\n              rel=\"noopener noreferrer\"\r\n              className=\"underline text-blue-600\"\r\n            >\r\n              {data.eventFile.split('/').pop()}\r\n            </a>\r\n          </div>\r\n        </div>\r\n      ) : null}\r\n\r\n      <div className=\"flex justify-between items-center\">\r\n        <div className=\"text-xs text-gray-500\">\r\n          Created: {created} · Updated: {updated}\r\n        </div>\r\n\r\n        <div className=\"flex gap-2\">\r\n          {onClose && (\r\n            <Button variant=\"outline\" onClick={onClose}>\r\n              Close\r\n            </Button>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 7774, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/createEventForm.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Label } from '@/components/ui/label';\r\nimport dynamic from 'next/dynamic';\r\nimport '@/assets/styles/tiptap-editor.css';\r\n\r\nconst EditorClient = dynamic(() => import('@/components/editor/editor-client'), {\r\n  ssr: false,\r\n});\r\n\r\nconst eventStatusOptions = ['pending', 'ongoing', 'completed', 'paused'] as const;\r\nconst publishOptions = ['draft', 'published'] as const;\r\nconst attendanceOptions = ['public', 'registration_required'] as const;\r\n\r\ntype EventStatus = (typeof eventStatusOptions)[number];\r\ntype PublishStatus = (typeof publishOptions)[number];\r\ntype AttendanceType = (typeof attendanceOptions)[number];\r\n\r\ntype EventFormProps = {\r\n  mode?: 'create' | 'edit';\r\n  initialData?: {\r\n    id?: string;\r\n    eventTitle: string;\r\n    eventDescription: object;\r\n    eventDetails?: object;\r\n    eventLocation?: string;\r\n    eventBanner: string; // string (URL or empty)\r\n    eventImages: string[];\r\n    eventFile: string;\r\n    eventStartDate: string;\r\n    eventEndDate: string;\r\n    eventTags: string[];\r\n    eventStatus: EventStatus;\r\n    publishStatus: PublishStatus;\r\n    eventAttendance: AttendanceType;\r\n    maxAttendees?: number;\r\n  };\r\n  onSuccess?: () => void;\r\n  onCancel?: () => void;\r\n  currentUserId?: string;\r\n};\r\n\r\nexport default function CreateEventForm({\r\n  mode = 'create',\r\n  initialData,\r\n  onSuccess,\r\n  onCancel,\r\n  currentUserId,\r\n}: EventFormProps) {\r\n  const router = useRouter();\r\n\r\n  const [form, setForm] = useState({\r\n    eventTitle: '',\r\n    eventDescription: {},\r\n    eventDetails: {},\r\n    eventLocation: '',\r\n    eventBanner: '', // string (URL or empty)\r\n    eventImages: [] as string[],\r\n    eventFile: '',\r\n    eventStartDate: '',\r\n    eventEndDate: '',\r\n    eventTags: [] as string[],\r\n    eventStatus: 'pending' as EventStatus,\r\n    publishStatus: 'draft' as PublishStatus,\r\n    eventAttendance: 'public' as AttendanceType,\r\n    maxAttendees: '',\r\n    files: null as FileList | null,\r\n    bannerFile: null as File | null,\r\n    eventFileUpload: null as File | null,\r\n  });\r\n  const [imagesToRemove, setImagesToRemove] = useState<string[]>([]);\r\n  const [fileToRemove, setFileToRemove] = useState<string | null>(null);\r\n  const [removeBanner, setRemoveBanner] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const [deleting, setDeleting] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (initialData) {\r\n      console.log('initialData.eventBanner:', initialData.eventBanner);\r\n      const toDatetimeLocal = (s: string | undefined) =>\r\n        s ? new Date(s).toISOString().slice(0, 16) : '';\r\n      setForm({\r\n        eventTitle: initialData.eventTitle ?? '',\r\n        eventDescription: initialData.eventDescription ?? {},\r\n        eventDetails: initialData.eventDetails ?? {},\r\n        eventLocation: initialData.eventLocation ?? '',\r\n        eventBanner: initialData.eventBanner ?? '',\r\n        eventImages: Array.isArray(initialData.eventImages) ? initialData.eventImages : [],\r\n        eventFile: initialData.eventFile ?? '',\r\n        eventStartDate: toDatetimeLocal(initialData.eventStartDate),\r\n        eventEndDate: toDatetimeLocal(initialData.eventEndDate),\r\n        eventTags: Array.isArray(initialData.eventTags) ? initialData.eventTags : [],\r\n        eventStatus: initialData.eventStatus ?? 'pending',\r\n        publishStatus: initialData.publishStatus ?? 'draft',\r\n        eventAttendance: initialData.eventAttendance ?? 'public',\r\n        maxAttendees:\r\n          typeof initialData.maxAttendees === 'number'\r\n            ? initialData.maxAttendees.toString()\r\n            : initialData.maxAttendees ?? '',\r\n        files: null,\r\n        bannerFile: null,\r\n        eventFileUpload: null,\r\n      });\r\n      setFileToRemove(null);\r\n      setImagesToRemove([]);\r\n      setRemoveBanner(false);\r\n    }\r\n  }, [initialData]);\r\n\r\n  const handleChange = (\r\n    e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement>\r\n  ) => {\r\n    const { name, value, files } = e.target as HTMLInputElement & HTMLSelectElement;\r\n    if (name === 'files' && files) {\r\n      setForm((prev) => ({ ...prev, files }));\r\n    } else if (name === 'bannerFile' && files && files[0]) {\r\n      setForm((prev) => ({ ...prev, bannerFile: files[0] }));\r\n    } else if (name === 'eventFileUpload' && files && files[0]) {\r\n      setForm((prev) => ({ ...prev, eventFileUpload: files[0] }));\r\n    } else if (name === 'eventTags') {\r\n      setForm((prev) => ({ ...prev, eventTags: value.split(',').map((t) => t.trim()) }));\r\n    } else {\r\n      setForm((prev) => ({ ...prev, [name]: value }));\r\n    }\r\n  };\r\n\r\n  const handleEditorChange = (json: object) => {\r\n    setForm((prev) => ({ ...prev, eventDescription: json }));\r\n  };\r\n\r\n  const handleDetailsEditorChange = (json: object) => {\r\n    setForm((prev) => ({ ...prev, eventDetails: json }));\r\n  };\r\n\r\n  const handleRemoveImage = (url: string) => {\r\n    setImagesToRemove((prev) => [...prev, url]);\r\n    setForm((prev) => ({\r\n      ...prev,\r\n      eventImages: prev.eventImages.filter((img) => img !== url),\r\n    }));\r\n  };\r\n\r\n  const handleRemoveBanner = () => {\r\n    setRemoveBanner(true);\r\n    setForm((prev) => ({\r\n      ...prev,\r\n      eventBanner: '',\r\n    }));\r\n  };\r\n\r\n  const handleRemoveFile = () => {\r\n    setFileToRemove(form.eventFile);\r\n    setForm((prev) => ({\r\n      ...prev,\r\n      eventFile: '',\r\n    }));\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n\r\n    if (mode === 'create' && !form.bannerFile) {\r\n      alert('Please upload an event banner image.');\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    if (!form.eventStartDate || !form.eventEndDate) {\r\n      alert('Please provide both event start and end dates.');\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    const formData = new FormData();\r\n    formData.append('eventTitle', form.eventTitle.trim());\r\n    formData.append('eventDescription', JSON.stringify(form.eventDescription));\r\n    formData.append('eventDetails', JSON.stringify(form.eventDetails));\r\n    formData.append('eventLocation', form.eventLocation);\r\n    formData.append('eventStartDate', form.eventStartDate);\r\n    formData.append('eventEndDate', form.eventEndDate);\r\n    formData.append('eventTags', JSON.stringify(form.eventTags));\r\n    formData.append('eventStatus', form.eventStatus);\r\n    formData.append('publishStatus', form.publishStatus);\r\n    formData.append('eventAttendance', form.eventAttendance);\r\n    formData.append('maxAttendees', form.maxAttendees);\r\n\r\n    if (mode === 'edit') {\r\n      formData.append('eventImages', JSON.stringify(form.eventImages));\r\n      formData.append('imagesToRemove', JSON.stringify(imagesToRemove));\r\n      if (fileToRemove) {\r\n        formData.append('fileToRemove', fileToRemove);\r\n      }\r\n      formData.append('eventBanner', removeBanner ? '' : form.eventBanner);\r\n    }\r\n\r\n    if (form.bannerFile) {\r\n      formData.append('bannerFile', form.bannerFile);\r\n    }\r\n    if (form.files && form.files.length > 0) {\r\n      Array.from(form.files).forEach((file) => {\r\n        formData.append('files', file);\r\n      });\r\n    }\r\n    if (form.eventFileUpload) {\r\n      formData.append('eventFileUpload', form.eventFileUpload);\r\n    }\r\n\r\n    try {\r\n      let res;\r\n      if (mode === 'edit' && initialData?.id) {\r\n        res = await fetch(`/api/events/${initialData.id}`, {\r\n          method: 'PUT',\r\n          body: formData,\r\n        });\r\n      } else {\r\n        res = await fetch('/api/events/upload', {\r\n          method: 'POST',\r\n          body: formData,\r\n        });\r\n      }\r\n\r\n      if (!res.ok) {\r\n        const errorData = await res.json().catch(() => null);\r\n        const errorMessage = errorData?.error || `Failed to ${mode} event`;\r\n        throw new Error(errorMessage);\r\n      }\r\n\r\n      if (onSuccess) onSuccess();\r\n      router.refresh();\r\n      router.push('/admin/dashboard');\r\n    } catch (err) {\r\n      alert(\r\n        `There was an error ${\r\n          mode === 'edit' ? 'updating' : 'creating'\r\n        } the event. Please try again.`\r\n      );\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async () => {\r\n    if (!initialData?.id) return;\r\n    if (\r\n      !window.confirm('Are you sure you want to delete this event? This action cannot be undone.')\r\n    )\r\n      return;\r\n\r\n    setDeleting(true);\r\n    try {\r\n      const res = await fetch(`/api/events/${initialData.id}`, {\r\n        method: 'DELETE',\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const errorData = await res.json().catch(() => null);\r\n        const errorMessage = errorData?.error || 'Failed to delete event';\r\n        throw new Error(errorMessage);\r\n      }\r\n\r\n      if (onSuccess) onSuccess();\r\n      router.refresh();\r\n      router.push('/admin/dashboard');\r\n    } catch (err) {\r\n      alert('There was an error deleting the event. Please try again.');\r\n    } finally {\r\n      setDeleting(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <form\r\n      onSubmit={handleSubmit}\r\n      className=\"w-full max-w-4xl mx-auto mt-4 space-y-6 p-6 bg-background rounded-xl shadow\"\r\n      encType=\"multipart/form-data\"\r\n    >\r\n      <div className=\"text-2xl font-bold mb-4 text-center\">\r\n        {mode === 'edit' ? 'Edit Event' : 'Create New Event'}\r\n      </div>\r\n      {/* Event Title */}\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"eventTitle\">Title</Label>\r\n        <Input\r\n          id=\"eventTitle\"\r\n          name=\"eventTitle\"\r\n          value={form.eventTitle}\r\n          onChange={handleChange}\r\n          required\r\n        />\r\n      </div>\r\n      {/* Event Description (Tiptap JSON) */}\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"eventDescription\">Description</Label>\r\n        <EditorClient\r\n          key={form.eventTitle + '_desc'}\r\n          content={form.eventDescription}\r\n          onChange={handleEditorChange}\r\n          showLinkUnlink\r\n        />\r\n      </div>\r\n      {/* Event Details (optional Tiptap JSON) */}\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"eventDetails\">Additional Details</Label>\r\n        <EditorClient\r\n          key={form.eventTitle + '_details'}\r\n          content={form.eventDetails}\r\n          onChange={handleDetailsEditorChange}\r\n          showLinkUnlink\r\n        />\r\n      </div>\r\n      {/* Event Location */}\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"eventLocation\">Location</Label>\r\n        <Input\r\n          id=\"eventLocation\"\r\n          name=\"eventLocation\"\r\n          value={form.eventLocation}\r\n          onChange={handleChange}\r\n          required\r\n        />\r\n      </div>\r\n      {/* Banner Upload */}\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"bannerFile\">\r\n          {mode === 'edit'\r\n            ? 'Banner Image (optional, will replace current)'\r\n            : 'Banner Image (required)'}\r\n        </Label>\r\n        <Input\r\n          id=\"bannerFile\"\r\n          name=\"bannerFile\"\r\n          type=\"file\"\r\n          accept=\"image/*\"\r\n          onChange={handleChange}\r\n          required={mode === 'create'}\r\n        />\r\n      </div>\r\n      {/* Current Banner (edit mode) */}\r\n      {mode === 'edit' && form.eventBanner && !removeBanner && (\r\n        <div className=\"space-y-2\">\r\n          <Label>Current Banner Image</Label>\r\n          <div className=\"relative w-fit\">\r\n            <img\r\n              src={form.eventBanner}\r\n              alt=\"Current Event Banner\"\r\n              className=\"w-full max-w-xs object-cover rounded border\"\r\n            />\r\n            <button\r\n              type=\"button\"\r\n              className=\"absolute top-0 right-0 bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center\"\r\n              onClick={handleRemoveBanner}\r\n              title=\"Remove banner\"\r\n            >\r\n              &times;\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {/* Existing Images (edit mode) */}\r\n      {mode === 'edit' && form.eventImages && form.eventImages.length > 0 && (\r\n        <div className=\"space-y-2\">\r\n          <Label>Current Images</Label>\r\n          <div className=\"flex flex-wrap gap-4\">\r\n            {form.eventImages.map((img) => (\r\n              <div key={img} className=\"relative\">\r\n                <img src={img} alt=\"Event\" className=\"w-24 h-24 object-cover rounded border\" />\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"absolute top-0 right-0 bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center\"\r\n                  onClick={() => handleRemoveImage(img)}\r\n                >\r\n                  &times;\r\n                </button>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n      {/* Upload event images */}\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"files\">\r\n          {mode === 'edit'\r\n            ? 'Event Images (optional, will add/replace)'\r\n            : 'Event Images (optional)'}\r\n        </Label>\r\n        <Input\r\n          id=\"files\"\r\n          name=\"files\"\r\n          type=\"file\"\r\n          accept=\"image/*\"\r\n          multiple\r\n          onChange={handleChange}\r\n        />\r\n      </div>\r\n      {/* Existing Event File (edit mode) */}\r\n      {mode === 'edit' && form.eventFile && (\r\n        <div className=\"space-y-2\">\r\n          <Label>Current Event File</Label>\r\n          <div className=\"flex items-center gap-2\">\r\n            <a\r\n              href={form.eventFile}\r\n              target=\"_blank\"\r\n              rel=\"noopener noreferrer\"\r\n              className=\"underline text-blue-600\"\r\n            >\r\n              {form.eventFile.split('/').pop()}\r\n            </a>\r\n            <button\r\n              type=\"button\"\r\n              className=\"bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center\"\r\n              onClick={handleRemoveFile}\r\n              title=\"Remove file\"\r\n            >\r\n              &times;\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {/* Event File Upload */}\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"eventFileUpload\">Event File (optional, e.g. PDF, DOCX)</Label>\r\n        <Input\r\n          id=\"eventFileUpload\"\r\n          name=\"eventFileUpload\"\r\n          type=\"file\"\r\n          accept=\".pdf,.doc,.docx\"\r\n          onChange={handleChange}\r\n        />\r\n      </div>\r\n      {/* Start Date */}\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"eventStartDate\">Start Date</Label>\r\n        <Input\r\n          id=\"eventStartDate\"\r\n          name=\"eventStartDate\"\r\n          type=\"datetime-local\"\r\n          value={form.eventStartDate}\r\n          onChange={handleChange}\r\n          required\r\n        />\r\n      </div>\r\n      {/* End Date */}\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"eventEndDate\">End Date</Label>\r\n        <Input\r\n          id=\"eventEndDate\"\r\n          name=\"eventEndDate\"\r\n          type=\"datetime-local\"\r\n          value={form.eventEndDate}\r\n          onChange={handleChange}\r\n          required\r\n        />\r\n      </div>\r\n      {/* Event Tags */}\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"eventTags\">Event Tags (comma separated)</Label>\r\n        <Input\r\n          id=\"eventTags\"\r\n          name=\"eventTags\"\r\n          value={form.eventTags.join(',')}\r\n          onChange={handleChange}\r\n          placeholder=\"e.g. tech, leadership, youth\"\r\n        />\r\n      </div>\r\n      {/* Publish Status */}\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"publishStatus\">Publish Status</Label>\r\n        <select\r\n          id=\"publishStatus\"\r\n          name=\"publishStatus\"\r\n          value={form.publishStatus}\r\n          onChange={handleChange}\r\n          className=\"w-full border border-input rounded-md p-2 text-sm bg-background text-foreground\"\r\n        >\r\n          {publishOptions.map((status) => (\r\n            <option key={status} value={status}>\r\n              {status}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n      {/* Event Status */}\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"eventStatus\">Event Status</Label>\r\n        <select\r\n          id=\"eventStatus\"\r\n          name=\"eventStatus\"\r\n          value={form.eventStatus}\r\n          onChange={handleChange}\r\n          className=\"w-full border border-input rounded-md p-2 text-sm bg-background text-foreground\"\r\n        >\r\n          {eventStatusOptions.map((status) => (\r\n            <option key={status} value={status}>\r\n              {status}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n      {/* Attendance */}\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"eventAttendance\">Attendance Type</Label>\r\n        <select\r\n          id=\"eventAttendance\"\r\n          name=\"eventAttendance\"\r\n          value={form.eventAttendance}\r\n          onChange={handleChange}\r\n          className=\"w-full border border-input rounded-md p-2 text-sm bg-background text-foreground\"\r\n        >\r\n          {attendanceOptions.map((status) => (\r\n            <option key={status} value={status}>\r\n              {status.replace('_', ' ')}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n      {/* Max Attendees */}\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"maxAttendees\">Maximum Attendees (optional)</Label>\r\n        <Input\r\n          id=\"maxAttendees\"\r\n          name=\"maxAttendees\"\r\n          type=\"number\"\r\n          min={1}\r\n          value={form.maxAttendees}\r\n          onChange={handleChange}\r\n        />\r\n      </div>\r\n      {/* Form actions */}\r\n      <div className=\"flex flex-center gap-2 w-full\">\r\n        <Button type=\"submit\" disabled={loading} className=\"w-1/3 bg-[#9f004d]\">\r\n          {loading\r\n            ? mode === 'edit'\r\n              ? 'Updating...'\r\n              : 'Creating...'\r\n            : mode === 'edit'\r\n            ? 'Update Event'\r\n            : 'Create Event'}\r\n        </Button>\r\n        <Button type=\"button\" onClick={onCancel} disabled={loading} className=\"w-1/3 bg-black\">\r\n          Cancel\r\n        </Button>\r\n        {mode === 'edit' && (\r\n          <Button\r\n            type=\"button\"\r\n            onClick={handleDelete}\r\n            disabled={deleting}\r\n            className=\"w-1/3 bg-red-700\"\r\n          >\r\n            {deleting ? 'Deleting Event...' : 'Delete Event'}\r\n          </Button>\r\n        )}\r\n      </div>\r\n    </form>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 8657, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/sections/EventsSection.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useMemo, useState, useEffect } from 'react';\r\nimport { DataTable } from '@/app/(admin)/admin/dashboard/data-table/data-table/data-table';\r\nimport { eventColumns } from '@/app/(admin)/admin/dashboard/data-table/columns/events';\r\nimport EventView from '@/app/(admin)/admin/dashboard/components/views/eventView';\r\nimport CreateEventForm from '@/app/(admin)/admin/dashboard/createEventForm';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\n\r\nexport default function EventsSection({\r\n  paginatedData,\r\n  page,\r\n  rowsPerPage,\r\n  handleEdit,\r\n  handleDelete,\r\n  currentUserRole,\r\n  TableActions,\r\n}: {\r\n  paginatedData: any[];\r\n  page: number;\r\n  rowsPerPage: number;\r\n  handleEdit: (record: any) => void;\r\n  handleDelete: (id: string | number) => void;\r\n  currentUserRole: string;\r\n  TableActions: React.FC<any>;\r\n}) {\r\n  const [viewingEvent, setViewingEvent] = useState<any | null>(null);\r\n  const [openCreate, setOpenCreate] = useState(false);\r\n\r\n  // Keep a local copy of paginatedData for the table; merge server-provided values if needed\r\n  const [data, setData] = useState<any[]>(paginatedData ?? []);\r\n\r\n  useEffect(() => {\r\n    setData(paginatedData ?? []);\r\n  }, [paginatedData]);\r\n\r\n  const baseCols = useMemo(\r\n    () =>\r\n      eventColumns({\r\n        onEdit: handleEdit,\r\n        onDelete: (id: number) => handleDelete(id),\r\n      }),\r\n    [handleEdit, handleDelete]\r\n  );\r\n\r\n  // Add a \"View\" column so users can open the EventView dialog\r\n  const viewColumn = {\r\n    id: 'view',\r\n    header: 'View',\r\n    cell: ({ row }: any) => (\r\n      <Button size=\"sm\" onClick={() => setViewingEvent(row.original)}>\r\n        View\r\n      </Button>\r\n    ),\r\n  };\r\n\r\n  const cols = useMemo(() => {\r\n    // append view column before actions for convenience\r\n    return [...baseCols.slice(0, -3), viewColumn, ...baseCols.slice(-3)];\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [baseCols]);\r\n\r\n  return (\r\n    <>\r\n      <div className=\"flex items-center justify-between mb-4\">\r\n        <div />\r\n        <div className=\"flex items-center gap-2\">\r\n          <Button onClick={() => setOpenCreate(true)} className=\"bg-green-600 text-white\">\r\n            Create Event\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      <DataTable columns={cols} data={data} />\r\n      <TableActions data={data} columns={cols} tableRef={React.createRef()} />\r\n\r\n      {/* View dialog */}\r\n      <Dialog open={!!viewingEvent} onOpenChange={(val) => !val && setViewingEvent(null)}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>Event details</DialogTitle>\r\n          </DialogHeader>\r\n          {viewingEvent && (\r\n            <EventView\r\n              data={viewingEvent}\r\n              onClose={() => {\r\n                setViewingEvent(null);\r\n              }}\r\n            />\r\n          )}\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Create dialog */}\r\n      <Dialog open={openCreate} onOpenChange={(val) => !val && setOpenCreate(false)}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>Create Event</DialogTitle>\r\n          </DialogHeader>\r\n          <div className=\"p-4\">\r\n            <CreateEventForm\r\n              mode=\"create\"\r\n              onSuccess={() => {\r\n                setOpenCreate(false);\r\n                // parent page should refresh; we do a soft update by removing nothing here\r\n              }}\r\n              onCancel={() => setOpenCreate(false)}\r\n            />\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;;;;;;;;AAUe,SAAS,cAAc,EACpC,aAAa,EACb,IAAI,EACJ,WAAW,EACX,UAAU,EACV,YAAY,EACZ,eAAe,EACf,YAAY,EASb;IACC,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAc;IAC7D,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAE7C,2FAA2F;IAC3F,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAS,iBAAiB,EAAE;IAE3D,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,QAAQ,iBAAiB,EAAE;IAC7B,GAAG;QAAC;KAAc;IAElB,MAAM,WAAW,CAAA,GAAA,qMAAA,CAAA,UAAO,AAAD,EACrB,IACE,CAAA,GAAA,6KAAA,CAAA,eAAY,AAAD,EAAE;YACX,QAAQ;YACR,UAAU,CAAC,KAAe,aAAa;QACzC,IACF;QAAC;QAAY;KAAa;IAG5B,6DAA6D;IAC7D,MAAM,aAAa;QACjB,IAAI;QACJ,QAAQ;QACR,MAAM,CAAC,EAAE,GAAG,EAAO,iBACjB,8OAAC,2HAAA,CAAA,SAAM;gBAAC,MAAK;gBAAK,SAAS,IAAM,gBAAgB,IAAI,QAAQ;0BAAG;;;;;;IAIpE;IAEA,MAAM,OAAO,CAAA,GAAA,qMAAA,CAAA,UAAO,AAAD,EAAE;QACnB,oDAAoD;QACpD,OAAO;eAAI,SAAS,KAAK,CAAC,GAAG,CAAC;YAAI;eAAe,SAAS,KAAK,CAAC,CAAC;SAAG;IACpE,uDAAuD;IACzD,GAAG;QAAC;KAAS;IAEb,qBACE;;0BACE,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;;;;;kCACD,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC,2HAAA,CAAA,SAAM;4BAAC,SAAS,IAAM,cAAc;4BAAO,WAAU;sCAA0B;;;;;;;;;;;;;;;;;0BAMpF,8OAAC,0LAAA,CAAA,YAAS;gBAAC,SAAS;gBAAM,MAAM;;;;;;0BAChC,8OAAC;gBAAa,MAAM;gBAAM,SAAS;gBAAM,wBAAU,qMAAA,CAAA,UAAK,CAAC,SAAS;;;;;;0BAGlE,8OAAC,2HAAA,CAAA,SAAM;gBAAC,MAAM,CAAC,CAAC;gBAAc,cAAc,CAAC,MAAQ,CAAC,OAAO,gBAAgB;0BAC3E,cAAA,8OAAC,2HAAA,CAAA,gBAAa;;sCACZ,8OAAC,2HAAA,CAAA,eAAY;sCACX,cAAA,8OAAC,2HAAA,CAAA,cAAW;0CAAC;;;;;;;;;;;wBAEd,8BACC,8OAAC,2KAAA,CAAA,UAAS;4BACR,MAAM;4BACN,SAAS;gCACP,gBAAgB;4BAClB;;;;;;;;;;;;;;;;;0BAOR,8OAAC,2HAAA,CAAA,SAAM;gBAAC,MAAM;gBAAY,cAAc,CAAC,MAAQ,CAAC,OAAO,cAAc;0BACrE,cAAA,8OAAC,2HAAA,CAAA,gBAAa;;sCACZ,8OAAC,2HAAA,CAAA,eAAY;sCACX,cAAA,8OAAC,2HAAA,CAAA,cAAW;0CAAC;;;;;;;;;;;sCAEf,8OAAC;4BAAI,WAAU;sCACb,cAAA,8OAAC,0JAAA,CAAA,UAAe;gCACd,MAAK;gCACL,WAAW;oCACT,cAAc;gCACd,2EAA2E;gCAC7E;gCACA,UAAU,IAAM,cAAc;;;;;;;;;;;;;;;;;;;;;;;;AAO5C","debugId":null}},
    {"offset": {"line": 8864, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/data-table/columns/reports.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { ColumnDef } from \"@tanstack/react-table\";\r\nimport { Report } from \"@/lib/generated/prisma\";\r\nimport { Button } from '@/components/ui/button';\r\n\r\ntype ReportWithUser = Report & {\r\n  createdBy: {\r\n    firstName: string;\r\n    lastName: string;\r\n  };\r\n};\r\n\r\nexport function reportColumns({\r\n  onEdit,\r\n  onDelete,\r\n}: {\r\n  onEdit: (report: ReportWithUser) => void;\r\n  onDelete: (id: number) => void;\r\n}): ColumnDef<ReportWithUser>[] {\r\n  return [\r\n    {\r\n      accessorKey: 'title',\r\n      header: 'Title',\r\n      cell: ({ row }) => (\r\n        <div className=\"whitespace-normal break-words max-w-xs\">{row.getValue('title')}</div>\r\n      ),\r\n    },\r\n    {\r\n      accessorKey: 'createdAt',\r\n      header: 'Created At',\r\n      cell: ({ row }) => new Date(row.getValue('createdAt')).toLocaleDateString(),\r\n    },\r\n    {\r\n      accessorKey: 'updatedAt',\r\n      header: 'Updated At',\r\n      cell: ({ row }) => new Date(row.getValue('updatedAt')).toLocaleDateString(),\r\n    },\r\n    {\r\n      id: 'createdBy',\r\n      header: 'Created By',\r\n      cell: ({ row }) => {\r\n        const createdBy = row.original.createdBy;\r\n        if (!createdBy) return '--';\r\n        return `${createdBy.firstName} ${createdBy.lastName}`;\r\n      },\r\n    },\r\n    {\r\n      accessorKey: 'publishStatus',\r\n      header: 'Publish',\r\n    },\r\n    {\r\n      id: 'actions',\r\n      header: 'Actions',\r\n      cell: ({ row }) => (\r\n        <Button type=\"button\" size=\"sm\" variant=\"outline\" onClick={() => onEdit(row.original)}>\r\n          Edit\r\n        </Button>\r\n      ),\r\n    },\r\n    {\r\n      id: 'delete',\r\n      header: 'Delete',\r\n      cell: ({ row }) => (\r\n        <Button\r\n          type=\"button\"\r\n          size=\"sm\"\r\n          variant=\"destructive\"\r\n          onClick={() => onDelete(row.original.id)}\r\n        >\r\n          Delete\r\n        </Button>\r\n      ),\r\n    },\r\n  ];\r\n}"],"names":[],"mappings":";;;;AAIA;AAJA;;;AAaO,SAAS,cAAc,EAC5B,MAAM,EACN,QAAQ,EAIT;IACC,OAAO;QACL;YACE,aAAa;YACb,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,iBACZ,8OAAC;oBAAI,WAAU;8BAA0C,IAAI,QAAQ,CAAC;;;;;;QAE1E;QACA;YACE,aAAa;YACb,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAI,KAAK,IAAI,QAAQ,CAAC,cAAc,kBAAkB;QAC3E;QACA;YACE,aAAa;YACb,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAI,KAAK,IAAI,QAAQ,CAAC,cAAc,kBAAkB;QAC3E;QACA;YACE,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE;gBACZ,MAAM,YAAY,IAAI,QAAQ,CAAC,SAAS;gBACxC,IAAI,CAAC,WAAW,OAAO;gBACvB,OAAO,GAAG,UAAU,SAAS,CAAC,CAAC,EAAE,UAAU,QAAQ,EAAE;YACvD;QACF;QACA;YACE,aAAa;YACb,QAAQ;QACV;QACA;YACE,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,iBACZ,8OAAC,2HAAA,CAAA,SAAM;oBAAC,MAAK;oBAAS,MAAK;oBAAK,SAAQ;oBAAU,SAAS,IAAM,OAAO,IAAI,QAAQ;8BAAG;;;;;;QAI3F;QACA;YACE,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,iBACZ,8OAAC,2HAAA,CAAA,SAAM;oBACL,MAAK;oBACL,MAAK;oBACL,SAAQ;oBACR,SAAS,IAAM,SAAS,IAAI,QAAQ,CAAC,EAAE;8BACxC;;;;;;QAIL;KACD;AACH","debugId":null}},
    {"offset": {"line": 8947, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/views/reportView.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport dynamic from 'next/dynamic';\r\nimport { Button } from '@/components/ui/button';\r\nimport '@/assets/styles/tiptap-editor.css';\r\n\r\nconst TiptapJsonViewer = dynamic(() => import('@/components/editor/tiptap-json-viewer'), {\r\n  ssr: false,\r\n});\r\n\r\ntype ReportType = {\r\n  id?: number | string;\r\n  title?: string | null;\r\n  slug?: string | null;\r\n  images?: string[] | null;\r\n  files?: string[] | null;\r\n  publishStatus?: string | null;\r\n  createdAt?: string | Date | null;\r\n  updatedAt?: string | Date | null;\r\n  createdBy?: { firstName?: string | null; lastName?: string | null } | null;\r\n  project?: { id?: number; title?: string } | null;\r\n};\r\n\r\n/**\r\n * ReportView - present a detailed view of a report\r\n */\r\nexport default function ReportView({\r\n  data,\r\n  onClose,\r\n}: {\r\n  data: ReportType | null | undefined;\r\n  onClose?: () => void;\r\n}) {\r\n  if (!data) return null;\r\n\r\n  const created = data.createdAt ? new Date(data.createdAt).toLocaleString() : '-';\r\n  const updated = data.updatedAt ? new Date(data.updatedAt).toLocaleString() : '-';\r\n\r\n  return (\r\n    <div className=\"w-full max-w-4xl mx-auto p-4 space-y-4\">\r\n      <div className=\"flex items-start justify-between gap-4\">\r\n        <div>\r\n          <h2 className=\"text-xl font-semibold\">{data.title}</h2>\r\n          <div className=\"text-sm text-gray-600 dark:text-gray-300 mt-1\">\r\n            {data.createdBy\r\n              ? `${data.createdBy.firstName ?? ''} ${data.createdBy.lastName ?? ''}`\r\n              : 'System'}\r\n            {data.project ? <span className=\"ml-3\">· Project: {data.project.title}</span> : null}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"text-sm text-gray-500 text-right\">\r\n          <div>\r\n            Publish: <span className=\"font-medium\">{data.publishStatus ?? '-'}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Images */}\r\n      {Array.isArray(data.images) && data.images.length > 0 && (\r\n        <div>\r\n          <div className=\"text-sm text-gray-500 mb-2\">Images</div>\r\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\r\n            {data.images.map((img) => (\r\n              <img\r\n                key={img}\r\n                src={img}\r\n                alt=\"report\"\r\n                className=\"w-full h-28 object-cover rounded border\"\r\n              />\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Files */}\r\n      {Array.isArray(data.files) && data.files.length > 0 && (\r\n        <div>\r\n          <div className=\"text-sm text-gray-500 mb-2\">Files</div>\r\n          <ul className=\"list-disc pl-5\">\r\n            {data.files.map((f) => (\r\n              <li key={f}>\r\n                <a\r\n                  href={f}\r\n                  target=\"_blank\"\r\n                  rel=\"noopener noreferrer\"\r\n                  className=\"text-blue-600 underline\"\r\n                >\r\n                  {f.split('/').pop()}\r\n                </a>\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"flex justify-between items-center\">\r\n        <div className=\"text-xs text-gray-500\">\r\n          Created: {created} · Updated: {updated}\r\n        </div>\r\n\r\n        <div className=\"flex gap-2\">\r\n          {onClose && (\r\n            <Button variant=\"outline\" onClick={onClose}>\r\n              Close\r\n            </Button>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAGA;AACA;;AAJA;;;;;AAOA,MAAM,mBAAmB,CAAA,GAAA,+JAAA,CAAA,UAAO,AAAD;;;;;;IAC7B,KAAK;;AAmBQ,SAAS,WAAW,EACjC,IAAI,EACJ,OAAO,EAIR;IACC,IAAI,CAAC,MAAM,OAAO;IAElB,MAAM,UAAU,KAAK,SAAS,GAAG,IAAI,KAAK,KAAK,SAAS,EAAE,cAAc,KAAK;IAC7E,MAAM,UAAU,KAAK,SAAS,GAAG,IAAI,KAAK,KAAK,SAAS,EAAE,cAAc,KAAK;IAE7E,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;;0CACC,8OAAC;gCAAG,WAAU;0CAAyB,KAAK,KAAK;;;;;;0CACjD,8OAAC;gCAAI,WAAU;;oCACZ,KAAK,SAAS,GACX,GAAG,KAAK,SAAS,CAAC,SAAS,IAAI,GAAG,CAAC,EAAE,KAAK,SAAS,CAAC,QAAQ,IAAI,IAAI,GACpE;oCACH,KAAK,OAAO,iBAAG,8OAAC;wCAAK,WAAU;;4CAAO;4CAAY,KAAK,OAAO,CAAC,KAAK;;;;;;+CAAW;;;;;;;;;;;;;kCAIpF,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;;gCAAI;8CACM,8OAAC;oCAAK,WAAU;8CAAe,KAAK,aAAa,IAAI;;;;;;;;;;;;;;;;;;;;;;;YAMnE,MAAM,OAAO,CAAC,KAAK,MAAM,KAAK,KAAK,MAAM,CAAC,MAAM,GAAG,mBAClD,8OAAC;;kCACC,8OAAC;wBAAI,WAAU;kCAA6B;;;;;;kCAC5C,8OAAC;wBAAI,WAAU;kCACZ,KAAK,MAAM,CAAC,GAAG,CAAC,CAAC,oBAChB,8OAAC;gCAEC,KAAK;gCACL,KAAI;gCACJ,WAAU;+BAHL;;;;;;;;;;;;;;;;YAWd,MAAM,OAAO,CAAC,KAAK,KAAK,KAAK,KAAK,KAAK,CAAC,MAAM,GAAG,mBAChD,8OAAC;;kCACC,8OAAC;wBAAI,WAAU;kCAA6B;;;;;;kCAC5C,8OAAC;wBAAG,WAAU;kCACX,KAAK,KAAK,CAAC,GAAG,CAAC,CAAC,kBACf,8OAAC;0CACC,cAAA,8OAAC;oCACC,MAAM;oCACN,QAAO;oCACP,KAAI;oCACJ,WAAU;8CAET,EAAE,KAAK,CAAC,KAAK,GAAG;;;;;;+BAPZ;;;;;;;;;;;;;;;;0BAejB,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;4BAAwB;4BAC3B;4BAAQ;4BAAa;;;;;;;kCAGjC,8OAAC;wBAAI,WAAU;kCACZ,yBACC,8OAAC,2HAAA,CAAA,SAAM;4BAAC,SAAQ;4BAAU,SAAS;sCAAS;;;;;;;;;;;;;;;;;;;;;;;AAQxD","debugId":null}},
    {"offset": {"line": 9167, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/createReportForm.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect, ChangeEvent } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Label } from \"@/components/ui/label\";\r\n\r\nconst publishOptions = [\"draft\", \"published\"] as const;\r\ntype PublishStatus = (typeof publishOptions)[number];\r\ntype Mode = \"create\" | \"edit\";\r\ninterface ReportData {\r\n  id?: string;\r\n  title: string;\r\n  images?: string[];\r\n  files?: string[];\r\n  publishStatus: PublishStatus;\r\n  accessCount?: number;\r\n  downloadCount?: number;\r\n}\r\n\r\ninterface CreateReportFormProps {\r\n  mode: Mode;\r\n  initialData?: ReportData;\r\n  onSuccess?: () => void;\r\n  onCancel?: () => void;\r\n}\r\n\r\nasync function uploadFile(file: File): Promise<string> {\r\n  const formData = new FormData();\r\n  formData.append(\"file\", file);\r\n\r\n  const res = await fetch(\"/api/reports/upload\", {\r\n    method: \"POST\",\r\n    body: formData,\r\n  });\r\n\r\n  if (!res.ok) {\r\n    throw new Error(\"File upload failed\");\r\n  }\r\n\r\n  const { path } = await res.json();\r\n  return path as string;\r\n}\r\n\r\nexport default function CreateReportForm({\r\n  mode,\r\n  initialData,\r\n  onSuccess,\r\n  onCancel,\r\n}: CreateReportFormProps) {\r\n  const router = useRouter();\r\n\r\n  const [form, setForm] = useState<ReportData>({\r\n    title: initialData?.title || \"\",\r\n    publishStatus: initialData?.publishStatus || \"draft\",\r\n  });\r\n  // Store which existing images/files are marked for deletion\r\n  const [existingImages, setExistingImages] = useState<string[]>(initialData?.images || []);\r\n  const [existingFiles, setExistingFiles] = useState<string[]>(initialData?.files || []);\r\n  const [imageFiles, setImageFiles] = useState<File[]>([]);\r\n  const [pdfFiles, setPdfFiles] = useState<File[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (mode === \"edit\" && initialData) {\r\n      setForm({\r\n        title: initialData.title || \"\",\r\n        publishStatus: initialData.publishStatus || \"draft\",\r\n      });\r\n      setExistingImages(initialData.images || []);\r\n      setExistingFiles(initialData.files || []);\r\n    }\r\n  }, [mode, initialData]);\r\n\r\n  const handleChange = (\r\n    e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>\r\n  ) => {\r\n    const { name, value } = e.target;\r\n    setForm((prev) => ({ ...prev, [name]: value }));\r\n  };\r\n\r\n  const handleImageChange = (e: ChangeEvent<HTMLInputElement>) => {\r\n    if (e.target.files) {\r\n      setImageFiles(Array.from(e.target.files));\r\n    }\r\n  };\r\n\r\n  const handlePdfChange = (e: ChangeEvent<HTMLInputElement>) => {\r\n    if (e.target.files) {\r\n      setPdfFiles(Array.from(e.target.files));\r\n    }\r\n  };\r\n\r\n  const handleRemoveExistingImage = (path: string) => {\r\n    setExistingImages((prev) => prev.filter((img) => img !== path));\r\n  };\r\n\r\n  const handleRemoveExistingFile = (path: string) => {\r\n    setExistingFiles((prev) => prev.filter((file) => file !== path));\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n\r\n    try {\r\n      // Upload new images\r\n      const imagePaths = await Promise.all(\r\n        imageFiles.map(file => uploadFile(file))\r\n      );\r\n      // Upload new PDFs\r\n      const pdfPaths = await Promise.all(\r\n        pdfFiles.map(file => uploadFile(file))\r\n      );\r\n\r\n      // Compose images/files: keep those not deleted (existing), add new ones\r\n      const imagesToSubmit = [...existingImages, ...imagePaths];\r\n      const filesToSubmit = [...existingFiles, ...pdfPaths];\r\n\r\n      const payload: ReportData = {\r\n        title: form.title.trim(),\r\n        images: imagesToSubmit,\r\n        files: filesToSubmit,\r\n        publishStatus: form.publishStatus,\r\n        accessCount: initialData?.accessCount || 0,\r\n        downloadCount: initialData?.downloadCount || 0,\r\n      };\r\n\r\n      let res;\r\n      if (mode === \"edit\" && initialData?.id) {\r\n        res = await fetch(`/api/reports/${initialData.id}`, {\r\n          method: \"PUT\",\r\n          headers: { \"Content-Type\": \"application/json\" },\r\n          body: JSON.stringify(payload),\r\n        });\r\n      } else {\r\n        res = await fetch(\"/api/reports\", {\r\n          method: \"POST\",\r\n          headers: { \"Content-Type\": \"application/json\" },\r\n          body: JSON.stringify(payload),\r\n        });\r\n      }\r\n\r\n      if (!res.ok) {\r\n        const errorData = await res.json().catch(() => null);\r\n        const errorMessage = errorData?.error || (mode === \"edit\" ? \"Failed to update report\" : \"Failed to create report\");\r\n        throw new Error(errorMessage);\r\n      }\r\n\r\n      if (onSuccess) {\r\n        onSuccess();\r\n      } else {\r\n        router.refresh();\r\n        router.push(\"/admin\");\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Error saving report:\", err);\r\n      alert(`There was an error ${mode === \"edit\" ? \"updating\" : \"creating\"} the report. Please try again.`);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <form\r\n      onSubmit={handleSubmit}\r\n      className=\"max-w-2xl mx-auto space-y-6 p-6 bg-background rounded-xl shadow\"\r\n    >\r\n      <h2 className=\"font-semibold text-xl mb-4\">\r\n        {mode === \"edit\" ? \"Edit Report\" : \"Create New Report\"}\r\n      </h2>\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"title\">Title</Label>\r\n        <Input\r\n          id=\"title\"\r\n          name=\"title\"\r\n          value={form.title}\r\n          onChange={handleChange}\r\n          required\r\n        />\r\n      </div>\r\n\r\n      {/* Existing images (for edit) */}\r\n      {mode === \"edit\" && initialData?.images && initialData.images.length > 0 && (\r\n        <div className=\"space-y-2\">\r\n          <Label>Existing Images</Label>\r\n          <div className=\"flex flex-wrap gap-2\">\r\n            {existingImages.map((img, idx) => (\r\n              <div key={img+idx} className=\"flex items-center gap-1\">\r\n                <a href={img} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-600 underline text-xs\">{img.split(\"/\").pop()}</a>\r\n                <Button\r\n                  type=\"button\"\r\n                  size=\"sm\"\r\n                  variant=\"destructive\"\r\n                  className=\"ml-1 px-2 py-0 text-xs\"\r\n                  onClick={() => handleRemoveExistingImage(img)}\r\n                >\r\n                  Remove\r\n                </Button>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"images\">Images (PNG, JPG, JPEG)</Label>\r\n        <Input\r\n          id=\"images\"\r\n          name=\"images\"\r\n          type=\"file\"\r\n          accept=\".png,.jpg,.jpeg\"\r\n          multiple\r\n          onChange={handleImageChange}\r\n        />\r\n        <div className=\"text-xs text-muted-foreground\">\r\n          {imageFiles.map((file) => file.name).join(\", \")}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Existing PDF files (for edit) */}\r\n      {mode === \"edit\" && initialData?.files && initialData.files.length > 0 && (\r\n        <div className=\"space-y-2\">\r\n          <Label>Existing PDF Files</Label>\r\n          <div className=\"flex flex-wrap gap-2\">\r\n            {existingFiles.map((file, idx) => (\r\n              <div key={file+idx} className=\"flex items-center gap-1\">\r\n                <a href={file} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-600 underline text-xs\">{file.split(\"/\").pop()}</a>\r\n                <Button\r\n                  type=\"button\"\r\n                  size=\"sm\"\r\n                  variant=\"destructive\"\r\n                  className=\"ml-1 px-2 py-0 text-xs\"\r\n                  onClick={() => handleRemoveExistingFile(file)}\r\n                >\r\n                  Remove\r\n                </Button>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"files\">PDF Files</Label>\r\n        <Input\r\n          id=\"files\"\r\n          name=\"files\"\r\n          type=\"file\"\r\n          accept=\".pdf\"\r\n          multiple\r\n          onChange={handlePdfChange}\r\n        />\r\n        <div className=\"text-xs text-muted-foreground\">\r\n          {pdfFiles.map((file) => file.name).join(\", \")}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"publishStatus\">Publish Status</Label>\r\n        <select\r\n          id=\"publishStatus\"\r\n          name=\"publishStatus\"\r\n          value={form.publishStatus}\r\n          onChange={handleChange}\r\n          className=\"w-full border border-input rounded-md p-2 text-sm bg-background text-foreground\"\r\n        >\r\n          {publishOptions.map((status) => (\r\n            <option key={status} value={status}>\r\n              {status}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      <div className=\"flex gap-3\">\r\n        <Button\r\n          type=\"submit\"\r\n          disabled={loading}\r\n          className=\"flex-1 bg-[#9f004d] hover:bg-[#7c003c] text-white\"\r\n        >\r\n          {loading\r\n            ? mode === \"edit\"\r\n              ? \"Updating...\"\r\n              : \"Creating...\"\r\n            : mode === \"edit\"\r\n            ? \"Update Report\"\r\n            : \"Create Report\"}\r\n        </Button>\r\n        {onCancel && (\r\n          <Button\r\n            type=\"button\"\r\n            variant=\"outline\"\r\n            className=\"flex-1 border-[#9f004d] text-[#9f004d] hover:bg-[#f5e3ec]\"\r\n            onClick={onCancel}\r\n            disabled={loading}\r\n          >\r\n            Cancel\r\n          </Button>\r\n        )}\r\n      </div>\r\n    </form>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 9613, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/sections/ReportsSection.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useMemo, useState, useEffect } from 'react';\r\nimport { DataTable } from '@/app/(admin)/admin/dashboard/data-table/data-table/data-table';\r\nimport { reportColumns } from '@/app/(admin)/admin/dashboard/data-table/columns/reports';\r\nimport ReportView from '@/app/(admin)/admin/dashboard/components/views/reportView';\r\nimport CreateReportForm from '@/app/(admin)/admin/dashboard/createReportForm';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\n\r\nexport default function ReportsSection({\r\n  paginatedData,\r\n  page,\r\n  rowsPerPage,\r\n  handleEdit,\r\n  handleDelete,\r\n  currentUserRole,\r\n  TableActions,\r\n}: {\r\n  paginatedData: any[];\r\n  page: number;\r\n  rowsPerPage: number;\r\n  handleEdit: (record: any) => void;\r\n  handleDelete: (id: string | number) => void;\r\n  currentUserRole: string;\r\n  TableActions: React.FC<any>;\r\n}) {\r\n  const [viewing, setViewing] = useState<any | null>(null);\r\n  const [openCreate, setOpenCreate] = useState(false);\r\n  const [data, setData] = useState<any[]>(paginatedData ?? []);\r\n\r\n  useEffect(() => {\r\n    setData(paginatedData ?? []);\r\n  }, [paginatedData]);\r\n\r\n  const baseCols = useMemo(\r\n    () =>\r\n      reportColumns({\r\n        onEdit: handleEdit,\r\n        onDelete: (id: number) => handleDelete(id),\r\n      }),\r\n    [handleEdit, handleDelete]\r\n  );\r\n\r\n  const viewColumn = {\r\n    id: 'view',\r\n    header: 'View',\r\n    cell: ({ row }: any) => (\r\n      <Button size=\"sm\" onClick={() => setViewing(row.original)}>\r\n        View\r\n      </Button>\r\n    ),\r\n  };\r\n\r\n  const cols = useMemo(() => {\r\n    return [...baseCols.slice(0, -3), viewColumn, ...baseCols.slice(-3)];\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [baseCols]);\r\n\r\n  return (\r\n    <>\r\n      <div className=\"flex items-center justify-between mb-4\">\r\n        <div />\r\n        <div className=\"flex items-center gap-2\">\r\n          <Button onClick={() => setOpenCreate(true)} className=\"bg-green-600 text-white\">\r\n            Create Report\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      <DataTable columns={cols} data={data} />\r\n      <TableActions data={data} columns={cols} tableRef={React.createRef()} />\r\n\r\n      {/* View dialog */}\r\n      <Dialog open={!!viewing} onOpenChange={(val) => !val && setViewing(null)}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>Report details</DialogTitle>\r\n          </DialogHeader>\r\n          {viewing && <ReportView data={viewing} onClose={() => setViewing(null)} />}\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Create dialog */}\r\n      <Dialog open={openCreate} onOpenChange={(val) => !val && setOpenCreate(false)}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>Create Report</DialogTitle>\r\n          </DialogHeader>\r\n          <div className=\"p-4\">\r\n            <CreateReportForm\r\n              mode=\"create\"\r\n              onSuccess={() => setOpenCreate(false)}\r\n              onCancel={() => setOpenCreate(false)}\r\n            />\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;;;;;;;;AAUe,SAAS,eAAe,EACrC,aAAa,EACb,IAAI,EACJ,WAAW,EACX,UAAU,EACV,YAAY,EACZ,eAAe,EACf,YAAY,EASb;IACC,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAc;IACnD,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC7C,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAS,iBAAiB,EAAE;IAE3D,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,QAAQ,iBAAiB,EAAE;IAC7B,GAAG;QAAC;KAAc;IAElB,MAAM,WAAW,CAAA,GAAA,qMAAA,CAAA,UAAO,AAAD,EACrB,IACE,CAAA,GAAA,8KAAA,CAAA,gBAAa,AAAD,EAAE;YACZ,QAAQ;YACR,UAAU,CAAC,KAAe,aAAa;QACzC,IACF;QAAC;QAAY;KAAa;IAG5B,MAAM,aAAa;QACjB,IAAI;QACJ,QAAQ;QACR,MAAM,CAAC,EAAE,GAAG,EAAO,iBACjB,8OAAC,2HAAA,CAAA,SAAM;gBAAC,MAAK;gBAAK,SAAS,IAAM,WAAW,IAAI,QAAQ;0BAAG;;;;;;IAI/D;IAEA,MAAM,OAAO,CAAA,GAAA,qMAAA,CAAA,UAAO,AAAD,EAAE;QACnB,OAAO;eAAI,SAAS,KAAK,CAAC,GAAG,CAAC;YAAI;eAAe,SAAS,KAAK,CAAC,CAAC;SAAG;IACpE,uDAAuD;IACzD,GAAG;QAAC;KAAS;IAEb,qBACE;;0BACE,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;;;;;kCACD,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC,2HAAA,CAAA,SAAM;4BAAC,SAAS,IAAM,cAAc;4BAAO,WAAU;sCAA0B;;;;;;;;;;;;;;;;;0BAMpF,8OAAC,0LAAA,CAAA,YAAS;gBAAC,SAAS;gBAAM,MAAM;;;;;;0BAChC,8OAAC;gBAAa,MAAM;gBAAM,SAAS;gBAAM,wBAAU,qMAAA,CAAA,UAAK,CAAC,SAAS;;;;;;0BAGlE,8OAAC,2HAAA,CAAA,SAAM;gBAAC,MAAM,CAAC,CAAC;gBAAS,cAAc,CAAC,MAAQ,CAAC,OAAO,WAAW;0BACjE,cAAA,8OAAC,2HAAA,CAAA,gBAAa;;sCACZ,8OAAC,2HAAA,CAAA,eAAY;sCACX,cAAA,8OAAC,2HAAA,CAAA,cAAW;0CAAC;;;;;;;;;;;wBAEd,yBAAW,8OAAC,4KAAA,CAAA,UAAU;4BAAC,MAAM;4BAAS,SAAS,IAAM,WAAW;;;;;;;;;;;;;;;;;0BAKrE,8OAAC,2HAAA,CAAA,SAAM;gBAAC,MAAM;gBAAY,cAAc,CAAC,MAAQ,CAAC,OAAO,cAAc;0BACrE,cAAA,8OAAC,2HAAA,CAAA,gBAAa;;sCACZ,8OAAC,2HAAA,CAAA,eAAY;sCACX,cAAA,8OAAC,2HAAA,CAAA,cAAW;0CAAC;;;;;;;;;;;sCAEf,8OAAC;4BAAI,WAAU;sCACb,cAAA,8OAAC,2JAAA,CAAA,UAAgB;gCACf,MAAK;gCACL,WAAW,IAAM,cAAc;gCAC/B,UAAU,IAAM,cAAc;;;;;;;;;;;;;;;;;;;;;;;;AAO5C","debugId":null}},
    {"offset": {"line": 9812, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/data-table/columns/institutions.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { ColumnDef } from '@tanstack/react-table';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Institution } from '@/lib/generated/prisma';\r\n\r\n// Types for Institution and Location with nested relations\r\nexport type Location = {\r\n  id: string;\r\n  locationName?: string;\r\n  latitude?: number | null;\r\n  longitude?: number | null;\r\n};\r\n\r\nexport type InstitutionWithRelations = {\r\n  id: string;\r\n  name: string;\r\n  email?: string | null;\r\n  phone?: string | null;\r\n  logo?: string | null;\r\n  institutionImages: string[];\r\n  headName?: string | null;\r\n  institutionType: string;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n  createdBy?: { firstName: string; lastName: string } | null;\r\n  locations: Location[];\r\n};\r\n\r\nexport function institutionColumns({\r\n  onEdit,\r\n  onDelete,\r\n}: {\r\n  onEdit: (institution: InstitutionWithRelations) => void;\r\n  onDelete: (id: string) => void;\r\n}): ColumnDef<InstitutionWithRelations>[] {\r\n  return [\r\n    {\r\n      accessorKey: 'name',\r\n      header: 'Name',\r\n      cell: ({ row }) => (\r\n        <div className=\"whitespace-normal break-words max-w-xs\">{row.getValue('name')}</div>\r\n      ),\r\n    },\r\n    {\r\n      accessorKey: 'institutionType',\r\n      header: 'Type',\r\n      cell: ({ row }) => (\r\n        <span className=\"capitalize\">\r\n          {String(row.getValue('institutionType')).replace(/_/g, ' ')}\r\n        </span>\r\n      ),\r\n    },\r\n    {\r\n      accessorKey: 'email',\r\n      header: 'Email',\r\n    },\r\n    {\r\n      accessorKey: 'phone',\r\n      header: 'Phone',\r\n    },\r\n    {\r\n      accessorKey: 'headName',\r\n      header: 'Head Name',\r\n    },\r\n    {\r\n      accessorKey: 'createdAt',\r\n      header: 'Created At',\r\n      cell: ({ row }) => new Date(row.getValue('createdAt')).toLocaleDateString(),\r\n    },\r\n    {\r\n      accessorKey: 'updatedAt',\r\n      header: 'Updated At',\r\n      cell: ({ row }) => new Date(row.getValue('updatedAt')).toLocaleDateString(),\r\n    },\r\n    {\r\n      id: 'createdBy',\r\n      header: 'Created By',\r\n      cell: ({ row }) => {\r\n        const createdBy = row.original.createdBy;\r\n        if (!createdBy) return '--';\r\n        return `${createdBy.firstName} ${createdBy.lastName}`;\r\n      },\r\n    },\r\n    {\r\n      id: 'locations',\r\n      header: 'Locations',\r\n      cell: ({ row }) => (\r\n        <ul className=\"list-disc pl-4\">\r\n          {row.original.locations && row.original.locations.length > 0 ? (\r\n            row.original.locations.map((loc) => (\r\n              <li key={loc.id}>\r\n                <span className=\"font-medium\">{loc.locationName || 'Unnamed'}</span>\r\n                {loc.latitude !== undefined && loc.latitude !== null && (\r\n                  <span>\r\n                    {' '}\r\n                    - <span className=\"text-xs\">Lat:</span> {loc.latitude}\r\n                  </span>\r\n                )}\r\n                {loc.longitude !== undefined && loc.longitude !== null && (\r\n                  <span>\r\n                    {' '}\r\n                    <span className=\"text-xs\">Lng:</span> {loc.longitude}\r\n                  </span>\r\n                )}\r\n              </li>\r\n            ))\r\n          ) : (\r\n            <li className=\"italic text-muted-foreground\">No locations</li>\r\n          )}\r\n        </ul>\r\n      ),\r\n    },\r\n    {\r\n      id: 'images',\r\n      header: 'Images',\r\n      cell: ({ row }) => (\r\n        <div className=\"flex flex-wrap gap-2\">\r\n          {row.original.institutionImages && row.original.institutionImages.length > 0 ? (\r\n            row.original.institutionImages.map((img, idx) => (\r\n              <img\r\n                key={img + idx}\r\n                src={img}\r\n                alt=\"Institution\"\r\n                className=\"w-12 h-12 object-cover rounded border\"\r\n              />\r\n            ))\r\n          ) : (\r\n            <span className=\"italic text-muted-foreground\">No images</span>\r\n          )}\r\n        </div>\r\n      ),\r\n    },\r\n    {\r\n      id: 'actions',\r\n      header: 'Actions',\r\n      cell: ({ row }) => (\r\n        <Button type=\"button\" size=\"sm\" variant=\"outline\" onClick={() => onEdit(row.original)}>\r\n          Edit\r\n        </Button>\r\n      ),\r\n    },\r\n    {\r\n      id: 'delete',\r\n      header: 'Delete',\r\n      cell: ({ row }) => (\r\n        <Button\r\n          type=\"button\"\r\n          size=\"sm\"\r\n          variant=\"destructive\"\r\n          onClick={() => onDelete(row.original.id)}\r\n        >\r\n          Delete\r\n        </Button>\r\n      ),\r\n    },\r\n  ];\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 10015, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/views/institutionView.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport { Button } from '@/components/ui/button';\r\n\r\ntype LocationType = {\r\n  id?: string | number;\r\n  locationName?: string;\r\n  latitude?: number | null;\r\n  longitude?: number | null;\r\n};\r\ntype InstitutionType = {\r\n  id?: string;\r\n  name?: string;\r\n  email?: string;\r\n  phone?: string;\r\n  logo?: string | null;\r\n  institutionImages?: string[] | null;\r\n  headName?: string | null;\r\n  institutionType?: string | null;\r\n  locations?: LocationType[] | null;\r\n  createdAt?: string | Date | null;\r\n  updatedAt?: string | Date | null;\r\n  createdBy?: { firstName?: string | null; lastName?: string | null } | null;\r\n};\r\n\r\n/**\r\n * InstitutionView - shows details for an institution\r\n */\r\nexport default function InstitutionView({\r\n  data,\r\n  onClose,\r\n}: {\r\n  data: InstitutionType | null | undefined;\r\n  onClose?: () => void;\r\n}) {\r\n  if (!data) return null;\r\n\r\n  const created = data.createdAt ? new Date(data.createdAt).toLocaleString() : '-';\r\n  const updated = data.updatedAt ? new Date(data.updatedAt).toLocaleString() : '-';\r\n\r\n  return (\r\n    <div className=\"w-full max-w-4xl mx-auto p-4 space-y-4\">\r\n      <div className=\"flex items-start justify-between gap-4\">\r\n        <div>\r\n          <h2 className=\"text-xl font-semibold\">{data.name}</h2>\r\n          <div className=\"text-sm text-gray-600 dark:text-gray-300 mt-1\">\r\n            {data.headName ? `Head: ${data.headName}` : null}\r\n            {data.createdBy ? (\r\n              <span className=\"ml-3\">\r\n                · Created by: {data.createdBy.firstName ?? ''} {data.createdBy.lastName ?? ''}\r\n              </span>\r\n            ) : null}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"text-sm text-gray-500 text-right\">\r\n          <div>\r\n            Email: <span className=\"font-medium\">{data.email ?? '-'}</span>\r\n          </div>\r\n          <div>\r\n            Phone: <span className=\"font-medium\">{data.phone ?? '-'}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Logo */}\r\n      {data.logo && (\r\n        <div>\r\n          <div className=\"text-sm text-gray-500\">Logo</div>\r\n          <div className=\"mt-2\">\r\n            <img\r\n              src={data.logo}\r\n              alt={`${data.name} logo`}\r\n              className=\"w-32 h-32 object-cover rounded border\"\r\n            />\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Images */}\r\n      {Array.isArray(data.institutionImages) && data.institutionImages.length > 0 && (\r\n        <div>\r\n          <div className=\"text-sm text-gray-500 mb-2\">Images</div>\r\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\r\n            {data.institutionImages.map((img) => (\r\n              <img\r\n                key={img}\r\n                src={img}\r\n                alt=\"institution\"\r\n                className=\"w-full h-28 object-cover rounded border\"\r\n              />\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Locations */}\r\n      {Array.isArray(data.locations) && data.locations.length > 0 && (\r\n        <div>\r\n          <div className=\"text-sm text-gray-500 mb-2\">Locations</div>\r\n          <ul className=\"list-disc pl-5\">\r\n            {data.locations.map((loc) => (\r\n              <li key={String(loc.id) || `${loc.locationName}`}>\r\n                {loc.locationName ?? '-'}{' '}\r\n                {loc.latitude !== undefined && loc.longitude !== undefined\r\n                  ? `· (${loc.latitude}, ${loc.longitude})`\r\n                  : null}\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"flex justify-between items-center\">\r\n        <div className=\"text-xs text-gray-500\">\r\n          Created: {created} · Updated: {updated}\r\n        </div>\r\n        <div className=\"flex gap-2\">\r\n          {onClose && (\r\n            <Button variant=\"outline\" onClick={onClose}>\r\n              Close\r\n            </Button>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAGA;AAHA;;;AA6Be,SAAS,gBAAgB,EACtC,IAAI,EACJ,OAAO,EAIR;IACC,IAAI,CAAC,MAAM,OAAO;IAElB,MAAM,UAAU,KAAK,SAAS,GAAG,IAAI,KAAK,KAAK,SAAS,EAAE,cAAc,KAAK;IAC7E,MAAM,UAAU,KAAK,SAAS,GAAG,IAAI,KAAK,KAAK,SAAS,EAAE,cAAc,KAAK;IAE7E,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;;0CACC,8OAAC;gCAAG,WAAU;0CAAyB,KAAK,IAAI;;;;;;0CAChD,8OAAC;gCAAI,WAAU;;oCACZ,KAAK,QAAQ,GAAG,CAAC,MAAM,EAAE,KAAK,QAAQ,EAAE,GAAG;oCAC3C,KAAK,SAAS,iBACb,8OAAC;wCAAK,WAAU;;4CAAO;4CACN,KAAK,SAAS,CAAC,SAAS,IAAI;4CAAG;4CAAE,KAAK,SAAS,CAAC,QAAQ,IAAI;;;;;;+CAE3E;;;;;;;;;;;;;kCAIR,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;;oCAAI;kDACI,8OAAC;wCAAK,WAAU;kDAAe,KAAK,KAAK,IAAI;;;;;;;;;;;;0CAEtD,8OAAC;;oCAAI;kDACI,8OAAC;wCAAK,WAAU;kDAAe,KAAK,KAAK,IAAI;;;;;;;;;;;;;;;;;;;;;;;;YAMzD,KAAK,IAAI,kBACR,8OAAC;;kCACC,8OAAC;wBAAI,WAAU;kCAAwB;;;;;;kCACvC,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;4BACC,KAAK,KAAK,IAAI;4BACd,KAAK,GAAG,KAAK,IAAI,CAAC,KAAK,CAAC;4BACxB,WAAU;;;;;;;;;;;;;;;;;YAOjB,MAAM,OAAO,CAAC,KAAK,iBAAiB,KAAK,KAAK,iBAAiB,CAAC,MAAM,GAAG,mBACxE,8OAAC;;kCACC,8OAAC;wBAAI,WAAU;kCAA6B;;;;;;kCAC5C,8OAAC;wBAAI,WAAU;kCACZ,KAAK,iBAAiB,CAAC,GAAG,CAAC,CAAC,oBAC3B,8OAAC;gCAEC,KAAK;gCACL,KAAI;gCACJ,WAAU;+BAHL;;;;;;;;;;;;;;;;YAWd,MAAM,OAAO,CAAC,KAAK,SAAS,KAAK,KAAK,SAAS,CAAC,MAAM,GAAG,mBACxD,8OAAC;;kCACC,8OAAC;wBAAI,WAAU;kCAA6B;;;;;;kCAC5C,8OAAC;wBAAG,WAAU;kCACX,KAAK,SAAS,CAAC,GAAG,CAAC,CAAC,oBACnB,8OAAC;;oCACE,IAAI,YAAY,IAAI;oCAAK;oCACzB,IAAI,QAAQ,KAAK,aAAa,IAAI,SAAS,KAAK,YAC7C,CAAC,GAAG,EAAE,IAAI,QAAQ,CAAC,EAAE,EAAE,IAAI,SAAS,CAAC,CAAC,CAAC,GACvC;;+BAJG,OAAO,IAAI,EAAE,KAAK,GAAG,IAAI,YAAY,EAAE;;;;;;;;;;;;;;;;0BAWxD,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;4BAAwB;4BAC3B;4BAAQ;4BAAa;;;;;;;kCAEjC,8OAAC;wBAAI,WAAU;kCACZ,yBACC,8OAAC,2HAAA,CAAA,SAAM;4BAAC,SAAQ;4BAAU,SAAS;sCAAS;;;;;;;;;;;;;;;;;;;;;;;AAQxD","debugId":null}},
    {"offset": {"line": 10270, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/createInstitutionForm.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Label } from '@/components/ui/label';\r\nimport dynamic from 'next/dynamic';\r\nimport { useSession } from 'next-auth/react';\r\nimport '@/assets/styles/tiptap-editor.css';\r\n\r\nconst institutionTypeOptions = [\r\n  'education',\r\n  'faith_based_organization',\r\n  'local_community',\r\n  'ngo',\r\n  'government',\r\n  'other',\r\n] as const;\r\n\r\ntype InstitutionType = (typeof institutionTypeOptions)[number];\r\n\r\ntype LocationFormType = {\r\n  id?: string;\r\n  locationName: string;\r\n  latitude: string;\r\n  longitude: string;\r\n};\r\n\r\ntype InstitutionFormProps = {\r\n  mode?: 'create' | 'edit';\r\n  initialData?: {\r\n    id?: string;\r\n    name: string;\r\n    email?: string;\r\n    phone?: string;\r\n    logo?: string;\r\n    institutionImages?: string[];\r\n    headName?: string;\r\n    institutionType: InstitutionType;\r\n    locations?: {\r\n      id?: string;\r\n      locationName?: string;\r\n      latitude?: number;\r\n      longitude?: number;\r\n    }[];\r\n  };\r\n  onSuccess?: () => void;\r\n  onCancel?: () => void;\r\n};\r\n\r\nconst EMAIL_LABEL = 'Email: example@example.org or example@example.com, etc';\r\nconst PHONE_LABEL =\r\n  'Phone: Must contain a country code (e.g. +211..., +256..., 00254..., etc) and more than 8 digits';\r\nconst INSTITUTION_LABEL = 'Institution Name: GoGirls ICT Initiative, etc';\r\nconst HEAD_LABEL = 'Head Name: Nyoka Nawani Deng, etc';\r\n\r\nfunction validateEmail(email: string): boolean {\r\n  return /^([a-zA-Z0-9._%+-]+)@([a-zA-Z0-9.-]+\\.[a-zA-Z]{2,})$/.test(email);\r\n}\r\nfunction validatePhone(phone: string): boolean {\r\n  const cleaned = phone.replace(/\\s+/g, '');\r\n  if (\r\n    (cleaned.startsWith('+') || cleaned.startsWith('00')) &&\r\n    cleaned.replace(/\\D/g, '').length >= 9\r\n  ) {\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\nfunction validateName(name: string): boolean {\r\n  return name.trim().length > 2;\r\n}\r\nfunction validateHeadName(head: string): boolean {\r\n  return /^[A-Za-z\\s\\-\\.]{6,}$/.test(head.trim());\r\n}\r\n\r\nexport default function CreateInstitutionForm({\r\n  mode = 'create',\r\n  initialData,\r\n  onSuccess,\r\n  onCancel,\r\n}: InstitutionFormProps) {\r\n  const router = useRouter();\r\n  const { data: session } = useSession();\r\n  const [form, setForm] = useState({\r\n    name: '',\r\n    email: '',\r\n    phone: '',\r\n    logoFile: null as File | null,\r\n    headName: '',\r\n    institutionType: 'education' as InstitutionType,\r\n    files: null as FileList | null,\r\n    institutionImages: [] as string[],\r\n    logo: '',\r\n    locations: [\r\n      {\r\n        id: undefined,\r\n        locationName: '',\r\n        latitude: '',\r\n        longitude: '',\r\n      },\r\n    ] as LocationFormType[],\r\n  });\r\n  const [imagesToRemove, setImagesToRemove] = useState<string[]>([]);\r\n  const [errors, setErrors] = useState<{ [key: string]: string }>({});\r\n  const [loading, setLoading] = useState(false);\r\n  const [deleting, setDeleting] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (initialData) {\r\n      setForm((prev) => ({\r\n        ...prev,\r\n        name: initialData.name || '',\r\n        email: initialData.email || '',\r\n        phone: initialData.phone || '',\r\n        logo: initialData.logo || '',\r\n        logoFile: null,\r\n        headName: initialData.headName || '',\r\n        institutionType: initialData.institutionType || 'education',\r\n        institutionImages: initialData.institutionImages || [],\r\n        locations:\r\n          initialData.locations && initialData.locations.length > 0\r\n            ? initialData.locations.map((loc) => ({\r\n                id: loc.id,\r\n                locationName: loc.locationName || '',\r\n                latitude: loc.latitude?.toString() || '',\r\n                longitude: loc.longitude?.toString() || '',\r\n              }))\r\n            : [\r\n                {\r\n                  id: undefined,\r\n                  locationName: '',\r\n                  latitude: '',\r\n                  longitude: '',\r\n                },\r\n              ],\r\n      }));\r\n    }\r\n  }, [initialData]);\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\r\n    const { name, value, files } = e.target as HTMLInputElement & HTMLSelectElement;\r\n    setErrors((prev) => ({ ...prev, [name]: '' }));\r\n    if (name === 'files' && files) {\r\n      setForm((prev) => ({ ...prev, files }));\r\n    } else if (name === 'logoFile' && files && files[0]) {\r\n      setForm((prev) => ({\r\n        ...prev,\r\n        logoFile: files[0],\r\n        logo: URL.createObjectURL(files[0]),\r\n      }));\r\n    } else {\r\n      setForm((prev) => ({ ...prev, [name]: value }));\r\n    }\r\n  };\r\n\r\n  const handleLocationChange = (idx: number, e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const { name, value } = e.target;\r\n    setForm((prev) => {\r\n      const updated = [...prev.locations];\r\n      updated[idx] = { ...updated[idx], [name]: value };\r\n      return { ...prev, locations: updated };\r\n    });\r\n  };\r\n\r\n  const addLocation = () => {\r\n    setForm((prev) => ({\r\n      ...prev,\r\n      locations: [...prev.locations, { locationName: '', latitude: '', longitude: '' }],\r\n    }));\r\n  };\r\n\r\n  const removeLocation = (idx: number) => {\r\n    setForm((prev) => ({\r\n      ...prev,\r\n      locations: prev.locations.filter((_, i) => i !== idx),\r\n    }));\r\n  };\r\n\r\n  const handleRemoveImage = (url: string) => {\r\n    setImagesToRemove((prev) => [...prev, url]);\r\n    setForm((prev) => ({\r\n      ...prev,\r\n      institutionImages: prev.institutionImages.filter((img) => img !== url),\r\n    }));\r\n  };\r\n\r\n  const validateForm = () => {\r\n    const newErrors: { [key: string]: string } = {};\r\n    if (!validateName(form.name)) newErrors['name'] = 'Please enter a valid institution name.';\r\n    if (!validateEmail(form.email))\r\n      newErrors['email'] = 'Please enter a valid email (e.g., example@example.org).';\r\n    if (!validatePhone(form.phone))\r\n      newErrors['phone'] = 'Phone must include a country code and be at least 9 digits.';\r\n    if (!validateHeadName(form.headName))\r\n      newErrors['headName'] =\r\n        'Please use a valid head name (e.g., Nyoka Nawani Deng, at least 6 chars).';\r\n    setErrors(newErrors);\r\n    return Object.keys(newErrors).length === 0;\r\n  };\r\n\r\n  const handleBlur = (e: React.FocusEvent<HTMLInputElement>) => {\r\n    const { name, value } = e.target;\r\n    let error = '';\r\n    if (name === 'email' && value && !validateEmail(value)) {\r\n      error = 'Please enter a valid email (e.g., example@example.org).';\r\n    }\r\n    if (name === 'phone' && value && !validatePhone(value)) {\r\n      error = 'Phone must include a country code and be at least 9 digits.';\r\n    }\r\n    if (name === 'name' && value && !validateName(value)) {\r\n      error = 'Please enter a valid institution name.';\r\n    }\r\n    if (name === 'headName' && value && !validateHeadName(value)) {\r\n      error = 'Please use a valid head name (at least 6 chars, e.g. Nyoka Nawani Deng).';\r\n    }\r\n    if (error) setErrors((prev) => ({ ...prev, [name]: error }));\r\n    else setErrors((prev) => ({ ...prev, [name]: '' }));\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n    if (!validateForm()) return;\r\n\r\n    setLoading(true);\r\n    if (!session?.user?.id) {\r\n      alert('You must be logged in.');\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    if (mode === 'create' && (!form.files || form.files.length === 0)) {\r\n      setErrors((prev) => ({\r\n        ...prev,\r\n        files: 'Please upload at least one image.',\r\n      }));\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    if (mode === 'create' && !form.logoFile) {\r\n      setErrors((prev) => ({\r\n        ...prev,\r\n        logoFile: 'Please upload a logo image.',\r\n      }));\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    const institutionFormData = new FormData();\r\n    institutionFormData.append('name', form.name.trim());\r\n    institutionFormData.append('email', form.email.trim());\r\n    institutionFormData.append('phone', form.phone.trim());\r\n    institutionFormData.append('headName', form.headName.trim());\r\n    institutionFormData.append('institutionType', form.institutionType);\r\n\r\n    if (form.logoFile) {\r\n      institutionFormData.append('logoFile', form.logoFile);\r\n    }\r\n\r\n    if (mode === 'edit') {\r\n      institutionFormData.append('institutionImages', JSON.stringify(form.institutionImages));\r\n      institutionFormData.append('imagesToRemove', JSON.stringify(imagesToRemove));\r\n    }\r\n\r\n    if (form.files && form.files.length > 0) {\r\n      Array.from(form.files).forEach((file) => {\r\n        institutionFormData.append('files', file);\r\n      });\r\n    }\r\n\r\n    let institutionId: string | null = null;\r\n    try {\r\n      let res;\r\n      if (mode === 'edit' && initialData?.id) {\r\n        res = await fetch(`/api/institutions/${initialData.id}`, {\r\n          method: 'PATCH',\r\n          body: institutionFormData,\r\n        });\r\n      } else {\r\n        institutionFormData.append(\r\n          'locations',\r\n          JSON.stringify(\r\n            form.locations\r\n              .filter((loc) => !loc.id)\r\n              .map((loc) => ({\r\n                locationName: loc.locationName,\r\n                latitude: loc.latitude ? parseFloat(loc.latitude) : null,\r\n                longitude: loc.longitude ? parseFloat(loc.longitude) : null,\r\n              }))\r\n          )\r\n        );\r\n        res = await fetch('/api/institutions', {\r\n          method: 'POST',\r\n          body: institutionFormData,\r\n        });\r\n      }\r\n\r\n      if (!res.ok) {\r\n        const errorData = await res.json().catch(() => null);\r\n        const errorMessage = errorData?.error || `Failed to ${mode} institution`;\r\n        throw new Error(errorMessage);\r\n      }\r\n\r\n      const result = await res.json();\r\n      institutionId = result.id || result.institution?.id;\r\n    } catch (err) {\r\n      alert(\r\n        `There was an error ${\r\n          mode === 'edit' ? 'updating' : 'creating'\r\n        } the institution. Please try again.`\r\n      );\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    if (mode === 'edit' && institutionId) {\r\n      try {\r\n        for (const loc of form.locations) {\r\n          if ((!loc.id || loc.id === '') && (loc.locationName || loc.latitude || loc.longitude)) {\r\n            await fetch('/api/locations', {\r\n              method: 'POST',\r\n              headers: {\r\n                'Content-Type': 'application/json',\r\n              },\r\n              body: JSON.stringify({\r\n                locationName: loc.locationName,\r\n                latitude: loc.latitude ? parseFloat(loc.latitude) : null,\r\n                longitude: loc.longitude ? parseFloat(loc.longitude) : null,\r\n                institutionId,\r\n              }),\r\n            });\r\n          }\r\n        }\r\n      } catch (err) {\r\n        alert('Failed to update locations for the institution.');\r\n        setLoading(false);\r\n        return;\r\n      }\r\n    }\r\n\r\n    if (onSuccess) onSuccess();\r\n    router.refresh();\r\n    router.push('/admin/dashboard');\r\n    setLoading(false);\r\n  };\r\n\r\n  const handleDelete = async () => {\r\n    if (!initialData?.id) return;\r\n    if (\r\n      !window.confirm(\r\n        'Are you sure you want to delete this institution? This action cannot be undone.'\r\n      )\r\n    )\r\n      return;\r\n\r\n    setDeleting(true);\r\n    try {\r\n      const res = await fetch(`/api/institutions/${initialData.id}`, {\r\n        method: 'DELETE',\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const errorData = await res.json().catch(() => null);\r\n        const errorMessage = errorData?.error || 'Failed to delete institution';\r\n        throw new Error(errorMessage);\r\n      }\r\n\r\n      if (onSuccess) onSuccess();\r\n      router.refresh();\r\n      router.push('/admin/dashboard');\r\n    } catch (err) {\r\n      alert('There was an error deleting the institution. Please try again.');\r\n    } finally {\r\n      setDeleting(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <form\r\n      onSubmit={handleSubmit}\r\n      className=\"w-full max-w-4xl mx-auto mt-4 space-y-6 p-6 bg-background rounded-xl shadow\"\r\n      encType=\"multipart/form-data\"\r\n      autoComplete=\"off\"\r\n    >\r\n      <div className=\"text-2xl font-bold mb-4 text-center\">\r\n        {mode === 'edit' ? 'Edit Institution' : 'Create New Institution'}\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"name\">{INSTITUTION_LABEL}</Label>\r\n        <Input\r\n          id=\"name\"\r\n          name=\"name\"\r\n          value={form.name}\r\n          onChange={handleChange}\r\n          onBlur={handleBlur}\r\n          required\r\n          placeholder=\"GoGirls ICT Initiative, etc\"\r\n        />\r\n        {errors.name && <div className=\"text-red-600 text-xs\">{errors.name}</div>}\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"email\">{EMAIL_LABEL}</Label>\r\n        <Input\r\n          id=\"email\"\r\n          name=\"email\"\r\n          type=\"email\"\r\n          value={form.email}\r\n          onChange={handleChange}\r\n          onBlur={handleBlur}\r\n          required\r\n          placeholder=\"example@example.org, example@gmail.com, etc\"\r\n        />\r\n        {errors.email && <div className=\"text-red-600 text-xs\">{errors.email}</div>}\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"phone\">{PHONE_LABEL}</Label>\r\n        <Input\r\n          id=\"phone\"\r\n          name=\"phone\"\r\n          type=\"tel\"\r\n          value={form.phone}\r\n          onChange={handleChange}\r\n          onBlur={handleBlur}\r\n          required\r\n          minLength={9}\r\n          placeholder=\"+211700000000, 00256780000000, etc\"\r\n        />\r\n        {errors.phone && <div className=\"text-red-600 text-xs\">{errors.phone}</div>}\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"logoFile\">\r\n          {mode === 'edit' ? 'Logo (optional, will replace current)' : 'Logo (required)'}\r\n        </Label>\r\n        <Input\r\n          id=\"logoFile\"\r\n          name=\"logoFile\"\r\n          type=\"file\"\r\n          accept=\"image/png,image/jpeg\"\r\n          onChange={handleChange}\r\n          required={mode === 'create'}\r\n        />\r\n        {errors.logoFile && <div className=\"text-red-600 text-xs\">{errors.logoFile}</div>}\r\n        {form.logo && (\r\n          <img\r\n            src={form.logo}\r\n            alt=\"Logo Preview\"\r\n            className=\"w-24 h-24 object-cover rounded border mt-2\"\r\n          />\r\n        )}\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"headName\">{HEAD_LABEL}</Label>\r\n        <Input\r\n          id=\"headName\"\r\n          name=\"headName\"\r\n          value={form.headName}\r\n          onChange={handleChange}\r\n          onBlur={handleBlur}\r\n          required\r\n          placeholder=\"Nyoka Nawani Deng, etc\"\r\n        />\r\n        {errors.headName && <div className=\"text-red-600 text-xs\">{errors.headName}</div>}\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"institutionType\">Institution Type</Label>\r\n        <select\r\n          id=\"institutionType\"\r\n          name=\"institutionType\"\r\n          value={form.institutionType}\r\n          onChange={handleChange}\r\n          className=\"w-full border border-input rounded-md p-2 text-sm bg-background text-foreground\"\r\n        >\r\n          {institutionTypeOptions.map((type) => (\r\n            <option key={type} value={type}>\r\n              {type.replace(/_/g, ' ')}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n      {mode === 'edit' && form.institutionImages && form.institutionImages.length > 0 && (\r\n        <div className=\"space-y-2\">\r\n          <Label>Current Images</Label>\r\n          <div className=\"flex flex-wrap gap-4\">\r\n            {form.institutionImages.map((img) => (\r\n              <div key={img} className=\"relative\">\r\n                <img\r\n                  src={img}\r\n                  alt=\"Institution\"\r\n                  className=\"w-24 h-24 object-cover rounded border\"\r\n                />\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"absolute top-0 right-0 bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center\"\r\n                  onClick={() => handleRemoveImage(img)}\r\n                >\r\n                  &times;\r\n                </button>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"files\">\r\n          {mode === 'edit'\r\n            ? 'Image Upload (optional, will replace/add to current images)'\r\n            : 'Image Upload (required)'}\r\n        </Label>\r\n        <Input\r\n          id=\"files\"\r\n          name=\"files\"\r\n          type=\"file\"\r\n          accept=\"image/png,image/jpeg\"\r\n          multiple\r\n          onChange={handleChange}\r\n          required={mode === 'create'}\r\n        />\r\n        {errors.files && <div className=\"text-red-600 text-xs\">{errors.files}</div>}\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        <Label>Locations</Label>\r\n        {form.locations.map((loc, idx) => (\r\n          <div key={idx} className=\"flex gap-2 items-end mb-2\">\r\n            <div className=\"flex-1\">\r\n              <Input\r\n                placeholder=\"Location Name\"\r\n                name=\"locationName\"\r\n                value={loc.locationName}\r\n                onChange={(e) => handleLocationChange(idx, e)}\r\n              />\r\n            </div>\r\n            <div className=\"flex-1\">\r\n              <Input\r\n                placeholder=\"Latitude\"\r\n                name=\"latitude\"\r\n                type=\"number\"\r\n                value={loc.latitude}\r\n                onChange={(e) => handleLocationChange(idx, e)}\r\n              />\r\n            </div>\r\n            <div className=\"flex-1\">\r\n              <Input\r\n                placeholder=\"Longitude\"\r\n                name=\"longitude\"\r\n                type=\"number\"\r\n                value={loc.longitude}\r\n                onChange={(e) => handleLocationChange(idx, e)}\r\n              />\r\n            </div>\r\n            {form.locations.length > 1 && (\r\n              <Button type=\"button\" className=\"bg-red-500\" onClick={() => removeLocation(idx)}>\r\n                Remove\r\n              </Button>\r\n            )}\r\n          </div>\r\n        ))}\r\n        <Button type=\"button\" onClick={addLocation} className=\"bg-[#9f004d]\">\r\n          Add Location\r\n        </Button>\r\n      </div>\r\n      <div className=\"flex gap-4 w-full\">\r\n        <Button type=\"submit\" disabled={loading} className=\"w-1/2 bg-[#9f004d]\">\r\n          {loading\r\n            ? mode === 'edit'\r\n              ? 'Updating...'\r\n              : 'Creating...'\r\n            : mode === 'edit'\r\n            ? 'Update Institution'\r\n            : 'Create Institution'}\r\n        </Button>\r\n        <Button type=\"button\" onClick={onCancel} disabled={loading} className=\"w-1/2 bg-black\">\r\n          Cancel\r\n        </Button>\r\n      </div>\r\n      {mode === 'edit' && (\r\n        <Button\r\n          type=\"button\"\r\n          onClick={handleDelete}\r\n          disabled={deleting}\r\n          className=\"w-full mt-4 bg-red-700\"\r\n        >\r\n          {deleting ? 'Deleting...' : 'Delete Institution'}\r\n        </Button>\r\n      )}\r\n    </form>\r\n  );\r\n}\r\n// This form allows admins to create or edit institution records, including uploading images and managing locations.\r\n// It validates inputs, handles file uploads, and supports both creation and editing modes."],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 11093, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/sections/InstitutionsSection.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useMemo, useState, useEffect } from 'react';\r\nimport { DataTable } from '@/app/(admin)/admin/dashboard/data-table/data-table/data-table';\r\nimport { institutionColumns } from '@/app/(admin)/admin/dashboard/data-table/columns/institutions';\r\nimport InstitutionView from '@/app/(admin)/admin/dashboard/components/views/institutionView';\r\nimport CreateInstitutionForm from '@/app/(admin)/admin/dashboard/createInstitutionForm';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\n\r\nexport default function InstitutionsSection({\r\n  paginatedData,\r\n  page,\r\n  rowsPerPage,\r\n  handleEdit,\r\n  handleDelete,\r\n  currentUserRole,\r\n  TableActions,\r\n}: {\r\n  paginatedData: any[];\r\n  page: number;\r\n  rowsPerPage: number;\r\n  handleEdit: (record: any) => void;\r\n  handleDelete: (id: string | number) => void;\r\n  currentUserRole: string;\r\n  TableActions: React.FC<any>;\r\n}) {\r\n  const [viewing, setViewing] = useState<any | null>(null);\r\n  const [openCreate, setOpenCreate] = useState(false);\r\n  const [data, setData] = useState<any[]>(paginatedData ?? []);\r\n\r\n  useEffect(() => {\r\n    setData(paginatedData ?? []);\r\n  }, [paginatedData]);\r\n\r\n  const baseCols = useMemo(\r\n    () =>\r\n      institutionColumns({\r\n        onEdit: handleEdit,\r\n        onDelete: (id: number) => handleDelete(id),\r\n      }),\r\n    [handleEdit, handleDelete]\r\n  );\r\n\r\n  const viewColumn = {\r\n    id: 'view',\r\n    header: 'View',\r\n    cell: ({ row }: any) => (\r\n      <Button size=\"sm\" onClick={() => setViewing(row.original)}>\r\n        View\r\n      </Button>\r\n    ),\r\n  };\r\n\r\n  const cols = useMemo(() => {\r\n    return [...baseCols.slice(0, -3), viewColumn, ...baseCols.slice(-3)];\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [baseCols]);\r\n\r\n  return (\r\n    <>\r\n      <div className=\"flex items-center justify-between mb-4\">\r\n        <div />\r\n        <div className=\"flex items-center gap-2\">\r\n          <Button onClick={() => setOpenCreate(true)} className=\"bg-green-600 text-white\">\r\n            Create Institution\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      <DataTable columns={cols} data={data} />\r\n      <TableActions data={data} columns={cols} tableRef={React.createRef()} />\r\n\r\n      {/* View dialog */}\r\n      <Dialog open={!!viewing} onOpenChange={(val) => !val && setViewing(null)}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>Institution details</DialogTitle>\r\n          </DialogHeader>\r\n          {viewing && <InstitutionView data={viewing} onClose={() => setViewing(null)} />}\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Create dialog */}\r\n      <Dialog open={openCreate} onOpenChange={(val) => !val && setOpenCreate(false)}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>Create Institution</DialogTitle>\r\n          </DialogHeader>\r\n          <div className=\"p-4\">\r\n            <CreateInstitutionForm\r\n              mode=\"create\"\r\n              onSuccess={() => setOpenCreate(false)}\r\n              onCancel={() => setOpenCreate(false)}\r\n            />\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;;;;;;;;AAUe,SAAS,oBAAoB,EAC1C,aAAa,EACb,IAAI,EACJ,WAAW,EACX,UAAU,EACV,YAAY,EACZ,eAAe,EACf,YAAY,EASb;IACC,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAc;IACnD,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC7C,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAS,iBAAiB,EAAE;IAE3D,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,QAAQ,iBAAiB,EAAE;IAC7B,GAAG;QAAC;KAAc;IAElB,MAAM,WAAW,CAAA,GAAA,qMAAA,CAAA,UAAO,AAAD,EACrB,IACE,CAAA,GAAA,mLAAA,CAAA,qBAAkB,AAAD,EAAE;YACjB,QAAQ;YACR,UAAU,CAAC,KAAe,aAAa;QACzC,IACF;QAAC;QAAY;KAAa;IAG5B,MAAM,aAAa;QACjB,IAAI;QACJ,QAAQ;QACR,MAAM,CAAC,EAAE,GAAG,EAAO,iBACjB,8OAAC,2HAAA,CAAA,SAAM;gBAAC,MAAK;gBAAK,SAAS,IAAM,WAAW,IAAI,QAAQ;0BAAG;;;;;;IAI/D;IAEA,MAAM,OAAO,CAAA,GAAA,qMAAA,CAAA,UAAO,AAAD,EAAE;QACnB,OAAO;eAAI,SAAS,KAAK,CAAC,GAAG,CAAC;YAAI;eAAe,SAAS,KAAK,CAAC,CAAC;SAAG;IACpE,uDAAuD;IACzD,GAAG;QAAC;KAAS;IAEb,qBACE;;0BACE,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;;;;;kCACD,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC,2HAAA,CAAA,SAAM;4BAAC,SAAS,IAAM,cAAc;4BAAO,WAAU;sCAA0B;;;;;;;;;;;;;;;;;0BAMpF,8OAAC,0LAAA,CAAA,YAAS;gBAAC,SAAS;gBAAM,MAAM;;;;;;0BAChC,8OAAC;gBAAa,MAAM;gBAAM,SAAS;gBAAM,wBAAU,qMAAA,CAAA,UAAK,CAAC,SAAS;;;;;;0BAGlE,8OAAC,2HAAA,CAAA,SAAM;gBAAC,MAAM,CAAC,CAAC;gBAAS,cAAc,CAAC,MAAQ,CAAC,OAAO,WAAW;0BACjE,cAAA,8OAAC,2HAAA,CAAA,gBAAa;;sCACZ,8OAAC,2HAAA,CAAA,eAAY;sCACX,cAAA,8OAAC,2HAAA,CAAA,cAAW;0CAAC;;;;;;;;;;;wBAEd,yBAAW,8OAAC,iLAAA,CAAA,UAAe;4BAAC,MAAM;4BAAS,SAAS,IAAM,WAAW;;;;;;;;;;;;;;;;;0BAK1E,8OAAC,2HAAA,CAAA,SAAM;gBAAC,MAAM;gBAAY,cAAc,CAAC,MAAQ,CAAC,OAAO,cAAc;0BACrE,cAAA,8OAAC,2HAAA,CAAA,gBAAa;;sCACZ,8OAAC,2HAAA,CAAA,eAAY;sCACX,cAAA,8OAAC,2HAAA,CAAA,cAAW;0CAAC;;;;;;;;;;;sCAEf,8OAAC;4BAAI,WAAU;sCACb,cAAA,8OAAC,gKAAA,CAAA,UAAqB;gCACpB,MAAK;gCACL,WAAW,IAAM,cAAc;gCAC/B,UAAU,IAAM,cAAc;;;;;;;;;;;;;;;;;;;;;;;;AAO5C","debugId":null}},
    {"offset": {"line": 11292, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/createBeneficiaryForm.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect, ChangeEvent } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Label } from '@/components/ui/label';\r\n\r\nconst publishOptions = ['draft', 'published'] as const;\r\ntype PublishStatus = (typeof publishOptions)[number];\r\nconst genderOptions = ['male', 'female'] as const;\r\ntype GenderType = (typeof genderOptions)[number];\r\ntype Mode = 'create' | 'edit';\r\n\r\nconst institutionTypeOptions = [\r\n  'education',\r\n  'faith_based_organization',\r\n  'local_community',\r\n  'ngo',\r\n  'government',\r\n  'other',\r\n] as const;\r\ntype InstitutionType = (typeof institutionTypeOptions)[number];\r\n\r\ninterface BeneficiaryData {\r\n  id?: string;\r\n  firstName: string;\r\n  lastName: string;\r\n  image?: string;\r\n  images?: string[];\r\n  gender: GenderType;\r\n  email?: string;\r\n  phone?: string;\r\n  dateOfBirth: string;\r\n  beneficiaryStatus: PublishStatus;\r\n  institutionId?: string;\r\n}\r\n\r\ninterface InstitutionData {\r\n  id?: string;\r\n  name: string;\r\n  email?: string;\r\n  phone?: string;\r\n  headName?: string;\r\n  institutionType: InstitutionType;\r\n  logoFile?: File | null;\r\n}\r\n\r\nexport default function CreateBeneficiaryForm({\r\n  mode,\r\n  initialData,\r\n  onSuccess,\r\n  onCancel,\r\n}: {\r\n  mode: Mode;\r\n  initialData?: BeneficiaryData;\r\n  onSuccess?: () => void;\r\n  onCancel?: () => void;\r\n}) {\r\n  const router = useRouter();\r\n\r\n  const [institutions, setInstitutions] = useState<{ id: string; name: string }[]>([]);\r\n  const [institutionsLoading, setInstitutionsLoading] = useState(false);\r\n\r\n  const [form, setForm] = useState<BeneficiaryData>({\r\n    firstName: initialData?.firstName || '',\r\n    lastName: initialData?.lastName || '',\r\n    image: initialData?.image || undefined,\r\n    images: initialData?.images || [],\r\n    gender: initialData?.gender || 'male',\r\n    email: initialData?.email || '',\r\n    phone: initialData?.phone || '',\r\n    dateOfBirth: initialData?.dateOfBirth\r\n      ? new Date(initialData.dateOfBirth).toISOString().split('T')[0]\r\n      : '',\r\n    beneficiaryStatus: initialData?.beneficiaryStatus || 'draft',\r\n    institutionId: initialData?.institutionId || '',\r\n  });\r\n\r\n  const [imageFiles, setImageFiles] = useState<File[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const [showInstitutionForm, setShowInstitutionForm] = useState(false);\r\n  const [newInstitution, setNewInstitution] = useState<InstitutionData>({\r\n    name: '',\r\n    email: '',\r\n    phone: '',\r\n    headName: '',\r\n    institutionType: 'education',\r\n    logoFile: null,\r\n  });\r\n  const [creatingInstitution, setCreatingInstitution] = useState(false);\r\n  const [institutionError, setInstitutionError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    setInstitutionsLoading(true);\r\n    fetch('/api/institutions')\r\n      .then((res) => res.json())\r\n      .then((data) => {\r\n        setInstitutions(data.map((i: any) => ({ id: i.id, name: i.name })));\r\n        setInstitutionsLoading(false);\r\n      })\r\n      .catch(() => setInstitutionsLoading(false));\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (mode === 'edit' && initialData) {\r\n      setForm({\r\n        ...form,\r\n        ...initialData,\r\n        dateOfBirth: initialData.dateOfBirth\r\n          ? new Date(initialData.dateOfBirth).toISOString().split('T')[0]\r\n          : '',\r\n      });\r\n    }\r\n    // eslint-disable-next-line\r\n  }, [mode, initialData]);\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\r\n    const { name, value } = e.target;\r\n    setForm((prev) => ({ ...prev, [name]: value }));\r\n  };\r\n\r\n  const handleImageChange = (e: ChangeEvent<HTMLInputElement>) => {\r\n    if (e.target.files) {\r\n      setImageFiles(Array.from(e.target.files));\r\n    }\r\n  };\r\n\r\n  // Institution logic unchanged\r\n  const handleInstitutionField = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\r\n    const { name, value } = e.target;\r\n    setNewInstitution((prev) => ({ ...prev, [name]: value }));\r\n  };\r\n  const handleInstitutionLogo = (e: ChangeEvent<HTMLInputElement>) => {\r\n    if (e.target.files && e.target.files[0]) {\r\n      setNewInstitution((prev) => ({\r\n        ...prev,\r\n        logoFile: e.target.files![0],\r\n      }));\r\n    }\r\n  };\r\n\r\n  const validateInstitutionForm = () => {\r\n    if (!newInstitution.name || newInstitution.name.length < 2) {\r\n      setInstitutionError('Institution name is required.');\r\n      return false;\r\n    }\r\n    if (!newInstitution.logoFile) {\r\n      setInstitutionError('Logo file is required.');\r\n      return false;\r\n    }\r\n    if (!newInstitution.institutionType) {\r\n      setInstitutionError('Institution type is required.');\r\n      return false;\r\n    }\r\n    setInstitutionError(null);\r\n    return true;\r\n  };\r\n\r\n  const handleCreateInstitution = async () => {\r\n    if (!validateInstitutionForm()) return;\r\n    setCreatingInstitution(true);\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append('name', newInstitution.name.trim());\r\n      if (newInstitution.email) formData.append('email', newInstitution.email.trim());\r\n      if (newInstitution.phone) formData.append('phone', newInstitution.phone.trim());\r\n      if (newInstitution.headName) formData.append('headName', newInstitution.headName.trim());\r\n      formData.append('institutionType', newInstitution.institutionType);\r\n      if (newInstitution.logoFile) {\r\n        formData.append('logoFile', newInstitution.logoFile);\r\n      }\r\n\r\n      const res = await fetch('/api/institutions', {\r\n        method: 'POST',\r\n        body: formData,\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const error = await res.json().catch(() => ({}));\r\n        throw new Error(error.error || 'Failed to create institution');\r\n      }\r\n\r\n      const institution = await res.json();\r\n      setInstitutions((prev) => [...prev, { id: institution.id, name: institution.name }]);\r\n      setShowInstitutionForm(false);\r\n      setForm((prev) => ({\r\n        ...prev,\r\n        institutionId: institution.id,\r\n      }));\r\n      setNewInstitution({\r\n        name: '',\r\n        email: '',\r\n        phone: '',\r\n        headName: '',\r\n        institutionType: 'education',\r\n        logoFile: null,\r\n      });\r\n      setInstitutionError(null);\r\n    } catch (err: any) {\r\n      setInstitutionError(err.message || 'Failed to create institution');\r\n    } finally {\r\n      setCreatingInstitution(false);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n\r\n    try {\r\n      // Create or update Beneficiary via API\r\n      const formData = new FormData();\r\n      formData.append('firstName', form.firstName.trim());\r\n      formData.append('lastName', form.lastName.trim());\r\n      formData.append('gender', form.gender);\r\n      formData.append('dateOfBirth', form.dateOfBirth);\r\n      if (form.email) formData.append('email', form.email.trim());\r\n      if (form.phone) formData.append('phone', form.phone.trim());\r\n      if (form.institutionId) formData.append('institutionId', form.institutionId);\r\n      formData.append('beneficiaryStatus', form.beneficiaryStatus);\r\n\r\n      // Profile images\r\n      imageFiles.forEach((file) => {\r\n        formData.append('images', file);\r\n      });\r\n\r\n      let res;\r\n      let beneficiary: any;\r\n      if (mode === 'edit' && initialData?.id) {\r\n        res = await fetch(`/api/beneficiaries/${initialData.id}`, {\r\n          method: 'PATCH',\r\n          body: formData,\r\n        });\r\n        beneficiary = await res.json();\r\n      } else {\r\n        res = await fetch('/api/beneficiaries', {\r\n          method: 'POST',\r\n          body: formData,\r\n        });\r\n        if (!res.ok) {\r\n          const errorData = await res.json().catch(() => null);\r\n          throw new Error(\r\n            errorData?.error ||\r\n              (mode === 'edit' ? 'Failed to update beneficiary' : 'Failed to create beneficiary')\r\n          );\r\n        }\r\n        beneficiary = await res.json();\r\n      }\r\n\r\n      if (onSuccess) {\r\n        onSuccess();\r\n      } else {\r\n        router.refresh();\r\n        router.push('/admin');\r\n      }\r\n    } catch (err) {\r\n      console.error('Error saving beneficiary:', err);\r\n      alert(\r\n        `There was an error ${\r\n          mode === 'edit' ? 'updating' : 'creating'\r\n        } the beneficiary. Please try again.`\r\n      );\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <form\r\n      onSubmit={handleSubmit}\r\n      className=\"max-w-2xl mx-auto space-y-6 p-6 bg-background rounded-xl shadow\"\r\n      encType=\"multipart/form-data\"\r\n      autoComplete=\"off\"\r\n    >\r\n      <h2 className=\"font-semibold text-xl mb-4\">\r\n        {mode === 'edit' ? 'Edit Beneficiary' : 'Create New Beneficiary'}\r\n      </h2>\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"firstName\">First Name</Label>\r\n        <Input\r\n          id=\"firstName\"\r\n          name=\"firstName\"\r\n          value={form.firstName}\r\n          onChange={handleChange}\r\n          required\r\n        />\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"lastName\">Last Name</Label>\r\n        <Input\r\n          id=\"lastName\"\r\n          name=\"lastName\"\r\n          value={form.lastName}\r\n          onChange={handleChange}\r\n          required\r\n        />\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"gender\">Gender</Label>\r\n        <select\r\n          id=\"gender\"\r\n          name=\"gender\"\r\n          value={form.gender}\r\n          onChange={handleChange}\r\n          className=\"w-full border border-input rounded-md p-2 text-sm bg-background text-foreground\"\r\n          required\r\n        >\r\n          {genderOptions.map((g) => (\r\n            <option key={g} value={g}>\r\n              {g.charAt(0).toUpperCase() + g.slice(1)}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"dateOfBirth\">Date of Birth</Label>\r\n        <Input\r\n          id=\"dateOfBirth\"\r\n          name=\"dateOfBirth\"\r\n          type=\"date\"\r\n          value={form.dateOfBirth}\r\n          onChange={handleChange}\r\n          required\r\n        />\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"email\">Email</Label>\r\n        <Input id=\"email\" name=\"email\" type=\"email\" value={form.email} onChange={handleChange} />\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"phone\">Phone</Label>\r\n        <Input id=\"phone\" name=\"phone\" type=\"tel\" value={form.phone} onChange={handleChange} />\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"images\">Profile Images (PNG, JPG, JPEG)</Label>\r\n        <Input\r\n          id=\"images\"\r\n          name=\"images\"\r\n          type=\"file\"\r\n          accept=\".png,.jpg,.jpeg\"\r\n          multiple\r\n          onChange={handleImageChange}\r\n        />\r\n        <div className=\"text-xs text-muted-foreground\">\r\n          {imageFiles.map((file) => file.name).join(', ')}\r\n        </div>\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"institutionId\">Institution</Label>\r\n        <div className=\"flex gap-2 items-end\">\r\n          <select\r\n            id=\"institutionId\"\r\n            name=\"institutionId\"\r\n            value={form.institutionId}\r\n            onChange={(e) => {\r\n              setForm((prev) => ({ ...prev, institutionId: e.target.value }));\r\n              setShowInstitutionForm(false);\r\n            }}\r\n            className=\"flex-1 border border-input rounded-md p-2 text-sm bg-background text-foreground\"\r\n            disabled={institutionsLoading}\r\n            required\r\n          >\r\n            <option value=\"\">None</option>\r\n            {institutions.map((inst) => (\r\n              <option key={inst.id} value={inst.id}>\r\n                {inst.name}\r\n              </option>\r\n            ))}\r\n          </select>\r\n          <Button\r\n            type=\"button\"\r\n            variant=\"outline\"\r\n            className=\"ml-2\"\r\n            onClick={() => setShowInstitutionForm((val) => !val)}\r\n          >\r\n            Add new institution\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {showInstitutionForm && (\r\n        <div className=\"border rounded-md p-4 mt-2 bg-muted space-y-2\">\r\n          <Label htmlFor=\"institution_name\">Institution Name*</Label>\r\n          <Input\r\n            id=\"institution_name\"\r\n            name=\"name\"\r\n            value={newInstitution.name}\r\n            onChange={handleInstitutionField}\r\n            required\r\n          />\r\n          <Label htmlFor=\"institution_type\">Type*</Label>\r\n          <select\r\n            id=\"institution_type\"\r\n            name=\"institutionType\"\r\n            value={newInstitution.institutionType}\r\n            onChange={handleInstitutionField}\r\n            required\r\n            className=\"w-full border border-input rounded-md p-2 text-sm bg-background text-foreground\"\r\n          >\r\n            {institutionTypeOptions.map((type) => (\r\n              <option key={type} value={type}>\r\n                {type.replace(/_/g, ' ')}\r\n              </option>\r\n            ))}\r\n          </select>\r\n          <Label htmlFor=\"institution_logo\">Logo*</Label>\r\n          <Input\r\n            id=\"institution_logo\"\r\n            name=\"logoFile\"\r\n            type=\"file\"\r\n            accept=\".png,.jpg,.jpeg\"\r\n            onChange={handleInstitutionLogo}\r\n            required\r\n          />\r\n          <Label htmlFor=\"institution_email\">Email</Label>\r\n          <Input\r\n            id=\"institution_email\"\r\n            name=\"email\"\r\n            value={newInstitution.email}\r\n            onChange={handleInstitutionField}\r\n          />\r\n          <Label htmlFor=\"institution_phone\">Phone</Label>\r\n          <Input\r\n            id=\"institution_phone\"\r\n            name=\"phone\"\r\n            value={newInstitution.phone}\r\n            onChange={handleInstitutionField}\r\n          />\r\n          <Label htmlFor=\"institution_headName\">Head Name</Label>\r\n          <Input\r\n            id=\"institution_headName\"\r\n            name=\"headName\"\r\n            value={newInstitution.headName}\r\n            onChange={handleInstitutionField}\r\n          />\r\n          {institutionError && <div className=\"text-red-600 text-xs\">{institutionError}</div>}\r\n          <div className=\"flex gap-2 mt-2\">\r\n            <Button\r\n              type=\"button\"\r\n              className=\"bg-blue-600 hover:bg-blue-700 text-white\"\r\n              disabled={creatingInstitution}\r\n              onClick={handleCreateInstitution}\r\n            >\r\n              {creatingInstitution ? 'Adding...' : 'Add Institution'}\r\n            </Button>\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"outline\"\r\n              className=\"text-blue-600 border-blue-600 hover:bg-blue-50\"\r\n              onClick={() => setShowInstitutionForm(false)}\r\n              disabled={creatingInstitution}\r\n            >\r\n              Cancel\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"beneficiaryStatus\">Beneficiary Publish Status</Label>\r\n        <select\r\n          id=\"beneficiaryStatus\"\r\n          name=\"beneficiaryStatus\"\r\n          value={form.beneficiaryStatus}\r\n          onChange={handleChange}\r\n          className=\"w-full border border-input rounded-md p-2 text-sm bg-background text-foreground\"\r\n        >\r\n          {publishOptions.map((status) => (\r\n            <option key={status} value={status}>\r\n              {status}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      <div className=\"flex gap-3\">\r\n        <Button\r\n          type=\"submit\"\r\n          disabled={loading}\r\n          className=\"flex-1 bg-[#9f004d] hover:bg-[#7c003c] text-white\"\r\n        >\r\n          {loading\r\n            ? mode === 'edit'\r\n              ? 'Updating...'\r\n              : 'Creating...'\r\n            : mode === 'edit'\r\n            ? 'Update Beneficiary'\r\n            : 'Create Beneficiary'}\r\n        </Button>\r\n        {onCancel && (\r\n          <Button\r\n            type=\"button\"\r\n            variant=\"outline\"\r\n            className=\"flex-1 border-[#9f004d] text-[#9f004d] hover:bg-[#f5e3ec]\"\r\n            onClick={onCancel}\r\n            disabled={loading}\r\n          >\r\n            Cancel\r\n          </Button>\r\n        )}\r\n      </div>\r\n    </form>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 12072, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/createMessageForm.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useSession } from 'next-auth/react';\r\n\r\ntype Props = {\r\n  messageId?: number | string;\r\n  editId?: string | null;\r\n  initialData?: any;\r\n  onSuccess?: () => void;\r\n  onCancel?: () => void;\r\n};\r\n\r\nexport default function CreateResponseForm({\r\n  messageId,\r\n  editId,\r\n  initialData,\r\n  onSuccess,\r\n  onCancel,\r\n}: Props) {\r\n  const { data: session } = useSession();\r\n  const [content, setContent] = useState<string>(() => {\r\n    if (initialData?.content && typeof initialData.content === 'string') return initialData.content;\r\n    // If content might be JSON, stringify for editing\r\n    if (initialData?.content && typeof initialData.content === 'object')\r\n      return JSON.stringify(initialData.content, null, 2);\r\n    return '';\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n  const [messageCreatorId, setMessageCreatorId] = useState<string | null>(() => {\r\n    // If editing an existing response, the initialData may include message.createdById\r\n    return initialData?.message?.createdById ?? initialData?.message?.createdBy?.id ?? null;\r\n  });\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    // If messageId provided, fetch message to determine creator (to show hint that the response will be tagged Author)\r\n    async function fetchMessage() {\r\n      const id = messageId ?? initialData?.message?.id;\r\n      if (!id) return;\r\n      try {\r\n        const res = await fetch(`/api/messages/${id}`);\r\n        if (!res.ok) return;\r\n        const json = await res.json();\r\n        setMessageCreatorId(json.createdById ?? json.createdBy?.id ?? null);\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n    fetchMessage();\r\n    // If initialData changes and contains message creator info, keep it\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [messageId, initialData?.message?.id]);\r\n\r\n  const submit = async (e?: React.FormEvent) => {\r\n    e?.preventDefault();\r\n    setError(null);\r\n\r\n    const targetMessageId = messageId ?? initialData?.message?.id;\r\n    if (!targetMessageId) {\r\n      setError('No message selected to respond to.');\r\n      return;\r\n    }\r\n\r\n    if (!content || !content.trim()) {\r\n      setError('Content cannot be empty.');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      // Try to send JSON if the content looks like JSON, otherwise send as string\r\n      let parsedContent: unknown = content;\r\n      const trimmed = content.trim();\r\n      if (\r\n        (trimmed.startsWith('{') && trimmed.endsWith('}')) ||\r\n        (trimmed.startsWith('[') && trimmed.endsWith(']'))\r\n      ) {\r\n        try {\r\n          parsedContent = JSON.parse(content);\r\n        } catch {\r\n          // keep as string if parsing fails\r\n          parsedContent = content;\r\n        }\r\n      }\r\n\r\n      const payload = {\r\n        messageId: targetMessageId,\r\n        content: parsedContent,\r\n      };\r\n\r\n      let res: Response;\r\n      if (editId || initialData?.id) {\r\n        const id = editId ?? initialData?.id;\r\n        res = await fetch(`/api/responses/${id}`, {\r\n          method: 'PATCH',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({ content: payload.content }),\r\n        });\r\n      } else {\r\n        res = await fetch(`/api/responses`, {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify(payload),\r\n        });\r\n      }\r\n\r\n      if (!res.ok) {\r\n        const body = await res.json().catch(() => ({}));\r\n        setError(body?.error || `Request failed (${res.status})`);\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      if (onSuccess) onSuccess();\r\n    } catch (err: any) {\r\n      setError(err?.message || 'Unexpected error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const isAuthor = !!(\r\n    session?.user?.id &&\r\n    messageCreatorId &&\r\n    session.user.id === messageCreatorId\r\n  );\r\n\r\n  return (\r\n    <form\r\n      onSubmit={submit}\r\n      className=\"w-full max-w-3xl mx-auto p-6 bg-background rounded-xl shadow space-y-4\"\r\n    >\r\n      <h3 className=\"text-lg font-semibold\">\r\n        {editId || initialData ? 'Edit Response' : 'Create Response'}\r\n      </h3>\r\n\r\n      {isAuthor && (\r\n        <div className=\"text-sm text-gray-700 dark:text-gray-300 p-2 rounded bg-yellow-50 dark:bg-yellow-900\">\r\n          You are the author of the original message — your response will be tagged as{' '}\r\n          <strong>Author</strong>.\r\n        </div>\r\n      )}\r\n\r\n      <div>\r\n        <label className=\"block text-sm font-medium mb-1\">Content</label>\r\n        <textarea\r\n          value={content}\r\n          onChange={(e) => setContent(e.target.value)}\r\n          rows={8}\r\n          className=\"w-full border rounded p-2 bg-white dark:bg-gray-800 dark:text-white\"\r\n        />\r\n        <p className=\"text-xs text-gray-500 mt-1\">\r\n          You can paste TipTap JSON or plain text. JSON will be preserved.\r\n        </p>\r\n      </div>\r\n\r\n      {error && <div className=\"text-sm text-red-600\">{error}</div>}\r\n\r\n      <div className=\"flex items-center gap-3\">\r\n        <button\r\n          type=\"submit\"\r\n          disabled={loading}\r\n          className=\"px-4 py-2 bg-pink-700 text-white rounded hover:bg-pink-800 disabled:opacity-60\"\r\n        >\r\n          {loading ? 'Saving...' : editId || initialData ? 'Save' : 'Create'}\r\n        </button>\r\n\r\n        <button\r\n          type=\"button\"\r\n          onClick={onCancel}\r\n          className=\"px-4 py-2 bg-gray-200 dark:bg-gray-800 rounded hover:bg-gray-300 dark:hover:bg-gray-700\"\r\n        >\r\n          Cancel\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;;AAae,SAAS,mBAAmB,EACzC,SAAS,EACT,MAAM,EACN,WAAW,EACX,SAAS,EACT,QAAQ,EACF;IACN,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,CAAA,GAAA,8IAAA,CAAA,aAAU,AAAD;IACnC,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAU;QAC7C,IAAI,aAAa,WAAW,OAAO,YAAY,OAAO,KAAK,UAAU,OAAO,YAAY,OAAO;QAC/F,kDAAkD;QAClD,IAAI,aAAa,WAAW,OAAO,YAAY,OAAO,KAAK,UACzD,OAAO,KAAK,SAAS,CAAC,YAAY,OAAO,EAAE,MAAM;QACnD,OAAO;IACT;IACA,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAiB;QACtE,mFAAmF;QACnF,OAAO,aAAa,SAAS,eAAe,aAAa,SAAS,WAAW,MAAM;IACrF;IACA,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAiB;IAElD,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,mHAAmH;QACnH,eAAe;YACb,MAAM,KAAK,aAAa,aAAa,SAAS;YAC9C,IAAI,CAAC,IAAI;YACT,IAAI;gBACF,MAAM,MAAM,MAAM,MAAM,CAAC,cAAc,EAAE,IAAI;gBAC7C,IAAI,CAAC,IAAI,EAAE,EAAE;gBACb,MAAM,OAAO,MAAM,IAAI,IAAI;gBAC3B,oBAAoB,KAAK,WAAW,IAAI,KAAK,SAAS,EAAE,MAAM;YAChE,EAAE,OAAM;YACN,SAAS;YACX;QACF;QACA;IACA,oEAAoE;IACpE,uDAAuD;IACzD,GAAG;QAAC;QAAW,aAAa,SAAS;KAAG;IAExC,MAAM,SAAS,OAAO;QACpB,GAAG;QACH,SAAS;QAET,MAAM,kBAAkB,aAAa,aAAa,SAAS;QAC3D,IAAI,CAAC,iBAAiB;YACpB,SAAS;YACT;QACF;QAEA,IAAI,CAAC,WAAW,CAAC,QAAQ,IAAI,IAAI;YAC/B,SAAS;YACT;QACF;QAEA,WAAW;QACX,IAAI;YACF,4EAA4E;YAC5E,IAAI,gBAAyB;YAC7B,MAAM,UAAU,QAAQ,IAAI;YAC5B,IACE,AAAC,QAAQ,UAAU,CAAC,QAAQ,QAAQ,QAAQ,CAAC,QAC5C,QAAQ,UAAU,CAAC,QAAQ,QAAQ,QAAQ,CAAC,MAC7C;gBACA,IAAI;oBACF,gBAAgB,KAAK,KAAK,CAAC;gBAC7B,EAAE,OAAM;oBACN,kCAAkC;oBAClC,gBAAgB;gBAClB;YACF;YAEA,MAAM,UAAU;gBACd,WAAW;gBACX,SAAS;YACX;YAEA,IAAI;YACJ,IAAI,UAAU,aAAa,IAAI;gBAC7B,MAAM,KAAK,UAAU,aAAa;gBAClC,MAAM,MAAM,MAAM,CAAC,eAAe,EAAE,IAAI,EAAE;oBACxC,QAAQ;oBACR,SAAS;wBAAE,gBAAgB;oBAAmB;oBAC9C,MAAM,KAAK,SAAS,CAAC;wBAAE,SAAS,QAAQ,OAAO;oBAAC;gBAClD;YACF,OAAO;gBACL,MAAM,MAAM,MAAM,CAAC,cAAc,CAAC,EAAE;oBAClC,QAAQ;oBACR,SAAS;wBAAE,gBAAgB;oBAAmB;oBAC9C,MAAM,KAAK,SAAS,CAAC;gBACvB;YACF;YAEA,IAAI,CAAC,IAAI,EAAE,EAAE;gBACX,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;gBAC7C,SAAS,MAAM,SAAS,CAAC,gBAAgB,EAAE,IAAI,MAAM,CAAC,CAAC,CAAC;gBACxD,WAAW;gBACX;YACF;YAEA,IAAI,WAAW;QACjB,EAAE,OAAO,KAAU;YACjB,SAAS,KAAK,WAAW;QAC3B,SAAU;YACR,WAAW;QACb;IACF;IAEA,MAAM,WAAW,CAAC,CAAC,CACjB,SAAS,MAAM,MACf,oBACA,QAAQ,IAAI,CAAC,EAAE,KAAK,gBACtB;IAEA,qBACE,8OAAC;QACC,UAAU;QACV,WAAU;;0BAEV,8OAAC;gBAAG,WAAU;0BACX,UAAU,cAAc,kBAAkB;;;;;;YAG5C,0BACC,8OAAC;gBAAI,WAAU;;oBAAuF;oBACvB;kCAC7E,8OAAC;kCAAO;;;;;;oBAAe;;;;;;;0BAI3B,8OAAC;;kCACC,8OAAC;wBAAM,WAAU;kCAAiC;;;;;;kCAClD,8OAAC;wBACC,OAAO;wBACP,UAAU,CAAC,IAAM,WAAW,EAAE,MAAM,CAAC,KAAK;wBAC1C,MAAM;wBACN,WAAU;;;;;;kCAEZ,8OAAC;wBAAE,WAAU;kCAA6B;;;;;;;;;;;;YAK3C,uBAAS,8OAAC;gBAAI,WAAU;0BAAwB;;;;;;0BAEjD,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,MAAK;wBACL,UAAU;wBACV,WAAU;kCAET,UAAU,cAAc,UAAU,cAAc,SAAS;;;;;;kCAG5D,8OAAC;wBACC,MAAK;wBACL,SAAS;wBACT,WAAU;kCACX;;;;;;;;;;;;;;;;;;AAMT","debugId":null}},
    {"offset": {"line": 12296, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/createResponseForm.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useSession } from 'next-auth/react';\r\n\r\ntype Props = {\r\n  messageId?: number | string;\r\n  editId?: string | null;\r\n  initialData?: any;\r\n  onSuccess?: () => void;\r\n  onCancel?: () => void;\r\n};\r\n\r\nexport default function CreateResponseForm({\r\n  messageId,\r\n  editId,\r\n  initialData,\r\n  onSuccess,\r\n  onCancel,\r\n}: Props) {\r\n  const { data: session } = useSession();\r\n  const [content, setContent] = useState<string>(() => {\r\n    if (initialData?.content && typeof initialData.content === 'string') return initialData.content;\r\n    // If content might be JSON, stringify for editing\r\n    if (initialData?.content && typeof initialData.content === 'object')\r\n      return JSON.stringify(initialData.content, null, 2);\r\n    return '';\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n  const [messageCreatorId, setMessageCreatorId] = useState<string | null>(() => {\r\n    // If editing an existing response, the initialData may include message.createdById\r\n    return initialData?.message?.createdById ?? initialData?.message?.createdBy?.id ?? null;\r\n  });\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    // If messageId provided, fetch message to determine creator (to show hint that the response will be tagged Author)\r\n    async function fetchMessage() {\r\n      const id = messageId ?? initialData?.message?.id;\r\n      if (!id) return;\r\n      try {\r\n        const res = await fetch(`/api/messages/${id}`);\r\n        if (!res.ok) return;\r\n        const json = await res.json();\r\n        setMessageCreatorId(json.createdById ?? json.createdBy?.id ?? null);\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n    fetchMessage();\r\n    // If initialData changes and contains message creator info, keep it\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [messageId, initialData?.message?.id]);\r\n\r\n  const submit = async (e?: React.FormEvent) => {\r\n    e?.preventDefault();\r\n    setError(null);\r\n\r\n    const targetMessageId = messageId ?? initialData?.message?.id;\r\n    if (!targetMessageId) {\r\n      setError('No message selected to respond to.');\r\n      return;\r\n    }\r\n\r\n    if (!content || !content.trim()) {\r\n      setError('Content cannot be empty.');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      // Try to send JSON if the content looks like JSON, otherwise send as string\r\n      let parsedContent: unknown = content;\r\n      const trimmed = content.trim();\r\n      if (\r\n        (trimmed.startsWith('{') && trimmed.endsWith('}')) ||\r\n        (trimmed.startsWith('[') && trimmed.endsWith(']'))\r\n      ) {\r\n        try {\r\n          parsedContent = JSON.parse(content);\r\n        } catch {\r\n          // keep as string if parsing fails\r\n          parsedContent = content;\r\n        }\r\n      }\r\n\r\n      const payload = {\r\n        messageId: targetMessageId,\r\n        content: parsedContent,\r\n      };\r\n\r\n      let res: Response;\r\n      if (editId || initialData?.id) {\r\n        const id = editId ?? initialData?.id;\r\n        res = await fetch(`/api/responses/${id}`, {\r\n          method: 'PATCH',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({ content: payload.content }),\r\n        });\r\n      } else {\r\n        res = await fetch(`/api/responses`, {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify(payload),\r\n        });\r\n      }\r\n\r\n      if (!res.ok) {\r\n        const body = await res.json().catch(() => ({}));\r\n        setError(body?.error || `Request failed (${res.status})`);\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      if (onSuccess) onSuccess();\r\n    } catch (err: any) {\r\n      setError(err?.message || 'Unexpected error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const isAuthor = !!(\r\n    session?.user?.id &&\r\n    messageCreatorId &&\r\n    session.user.id === messageCreatorId\r\n  );\r\n\r\n  return (\r\n    <form\r\n      onSubmit={submit}\r\n      className=\"w-full max-w-3xl mx-auto p-6 bg-background rounded-xl shadow space-y-4\"\r\n    >\r\n      <h3 className=\"text-lg font-semibold\">\r\n        {editId || initialData ? 'Edit Response' : 'Create Response'}\r\n      </h3>\r\n\r\n      {isAuthor && (\r\n        <div className=\"text-sm text-gray-700 dark:text-gray-300 p-2 rounded bg-yellow-50 dark:bg-yellow-900\">\r\n          You are the author of the original message — your response will be tagged as{' '}\r\n          <strong>Author</strong>.\r\n        </div>\r\n      )}\r\n\r\n      <div>\r\n        <label className=\"block text-sm font-medium mb-1\">Content</label>\r\n        <textarea\r\n          value={content}\r\n          onChange={(e) => setContent(e.target.value)}\r\n          rows={8}\r\n          className=\"w-full border rounded p-2 bg-white dark:bg-gray-800 dark:text-white\"\r\n        />\r\n        <p className=\"text-xs text-gray-500 mt-1\">\r\n          You can paste TipTap JSON or plain text. JSON will be preserved.\r\n        </p>\r\n      </div>\r\n\r\n      {error && <div className=\"text-sm text-red-600\">{error}</div>}\r\n\r\n      <div className=\"flex items-center gap-3\">\r\n        <button\r\n          type=\"submit\"\r\n          disabled={loading}\r\n          className=\"px-4 py-2 bg-pink-700 text-white rounded hover:bg-pink-800 disabled:opacity-60\"\r\n        >\r\n          {loading ? 'Saving...' : editId || initialData ? 'Save' : 'Create'}\r\n        </button>\r\n\r\n        <button\r\n          type=\"button\"\r\n          onClick={onCancel}\r\n          className=\"px-4 py-2 bg-gray-200 dark:bg-gray-800 rounded hover:bg-gray-300 dark:hover:bg-gray-700\"\r\n        >\r\n          Cancel\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 12520, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/views/beneficiaryView.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport dynamic from 'next/dynamic';\r\nimport { useSession } from 'next-auth/react';\r\nimport '@/assets/styles/tiptap-editor.css';\r\n\r\n// Use the viewer for read-only rich text display (if any rich text fields)\r\nconst TiptapJsonViewer = dynamic(() => import('@/components/editor/tiptap-json-viewer'), {\r\n  ssr: false,\r\n});\r\n\r\ntype BeneficiaryLike = {\r\n  id?: string;\r\n  firstName?: string | null;\r\n  lastName?: string | null;\r\n  gender?: string | null;\r\n  email?: string | null;\r\n  phone?: string | null;\r\n  dateOfBirth?: string | null;\r\n  beneficiaryStatus?: string | null;\r\n  images?: string[] | null;\r\n  institution?: { name?: string | null } | null;\r\n  createdAt?: string | null;\r\n  updatedAt?: string | null;\r\n\r\n  // optional server-provided counts\r\n  messageCount?: number | null;\r\n  responseCount?: number | null;\r\n};\r\n\r\nexport default function BeneficiaryView({\r\n  data,\r\n  onClose,\r\n}: {\r\n  data: BeneficiaryLike;\r\n  onClose?: () => void;\r\n}) {\r\n  const { data: session } = useSession();\r\n  const role = (session as any)?.user?.role ?? 'guest';\r\n  const isPrivileged = role === 'super' || role === 'admin' || role === 'moderator';\r\n  const isSelfBeneficiary =\r\n    role === 'beneficiary' &&\r\n    !!data &&\r\n    // infer beneficiary identity from session first/last name match when possible\r\n    (session as any)?.user?.firstName &&\r\n    (session as any)?.user?.lastName &&\r\n    (session as any).user.firstName.trim().toLowerCase() ===\r\n      (data.firstName ?? '').trim().toLowerCase() &&\r\n    (session as any).user.lastName.trim().toLowerCase() ===\r\n      (data.lastName ?? '').trim().toLowerCase();\r\n\r\n  const [messageCount, setMessageCount] = useState<number | null>(\r\n    typeof data?.messageCount === 'number' ? data.messageCount : null\r\n  );\r\n  const [responseCount, setResponseCount] = useState<number | null>(\r\n    typeof data?.responseCount === 'number' ? data.responseCount : null\r\n  );\r\n  const [countsLoading, setCountsLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    // If counts are already provided by the server in `data`, don't fetch.\r\n    if (messageCount !== null && responseCount !== null) return;\r\n\r\n    // Only attempt to fetch counts if this view is for the logged-in beneficiary (self)\r\n    // or the current user is privileged (admin/super/moderator).\r\n    if (!isSelfBeneficiary && !isPrivileged) return;\r\n\r\n    // Try a few strategies to obtain counts:\r\n    // 1) /api/beneficiaries/:id/counts (preferred if you provide it)\r\n    // 2) fallback to fetching messages and responses filtered by beneficiaryId (if supported)\r\n    async function fetchCounts() {\r\n      if (!data?.id) return;\r\n      setCountsLoading(true);\r\n\r\n      try {\r\n        // try dedicated endpoint first\r\n        const countsRes = await fetch(`/api/beneficiaries/${data.id}/counts`);\r\n        if (countsRes.ok) {\r\n          const json = await countsRes.json();\r\n          if (typeof json.messageCount === 'number') setMessageCount(json.messageCount);\r\n          if (typeof json.responseCount === 'number') setResponseCount(json.responseCount);\r\n          setCountsLoading(false);\r\n          return;\r\n        }\r\n      } catch {\r\n        // ignore and fallback\r\n      }\r\n\r\n      try {\r\n        // fallback: fetch messages for beneficiary and count\r\n        const msgsRes = await fetch(\r\n          `/api/messages?beneficiaryId=${encodeURIComponent(data.id as string)}`\r\n        );\r\n        if (msgsRes.ok) {\r\n          const msgs = await msgsRes.json();\r\n          if (Array.isArray(msgs)) setMessageCount(msgs.length);\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n\r\n      try {\r\n        // fallback: fetch responses for beneficiary by relying on responses API to filter by message->beneficiary\r\n        const resRes = await fetch(\r\n          `/api/responses?beneficiaryId=${encodeURIComponent(data.id as string)}`\r\n        );\r\n        if (resRes.ok) {\r\n          const rs = await resRes.json();\r\n          if (Array.isArray(rs)) setResponseCount(rs.length);\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n\r\n      setCountsLoading(false);\r\n    }\r\n\r\n    fetchCounts();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [data?.id, isSelfBeneficiary, isPrivileged]);\r\n\r\n  // Render a compact card for beneficiary (for self) or a full info card (for privileged users)\r\n  return (\r\n    <div className=\"w-full max-w-5xl mx-auto space-y-4 bg-background rounded-xl shadow p-6\">\r\n      <div className=\"flex items-start justify-between\">\r\n        <h2 className=\"font-semibold text-xl\">Beneficiary</h2>\r\n        <div className=\"text-sm text-gray-600\">\r\n          {countsLoading ? (\r\n            'Loading counts…'\r\n          ) : (\r\n            <>\r\n              <div>\r\n                <strong>Messages:</strong> {messageCount !== null ? messageCount : 'N/A'}\r\n              </div>\r\n              <div>\r\n                <strong>Responses:</strong> {responseCount !== null ? responseCount : 'N/A'}\r\n              </div>\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n        <div>\r\n          <div>\r\n            <strong>Name:</strong> {data.firstName ?? '-'} {data.lastName ?? ''}\r\n          </div>\r\n\r\n          {isPrivileged && (\r\n            <>\r\n              <div>\r\n                <strong>Gender:</strong> {data.gender ?? '-'}\r\n              </div>\r\n              <div>\r\n                <strong>Email:</strong> {data.email ?? '-'}\r\n              </div>\r\n              <div>\r\n                <strong>Phone:</strong> {data.phone ?? '-'}\r\n              </div>\r\n              <div>\r\n                <strong>Date of Birth:</strong>{' '}\r\n                {data.dateOfBirth ? new Date(data.dateOfBirth).toLocaleDateString() : '-'}\r\n              </div>\r\n              <div>\r\n                <strong>Status:</strong> {data.beneficiaryStatus ?? '-'}\r\n              </div>\r\n            </>\r\n          )}\r\n\r\n          {!isPrivileged && (\r\n            <>\r\n              {/* For non-privileged beneficiaries (self) show limited contact info */}\r\n              <div>\r\n                <strong>Email:</strong> {data.email ? maskEmail(data.email) : '-'}\r\n              </div>\r\n              <div>\r\n                <strong>Phone:</strong> {data.phone ? maskPhone(data.phone) : '-'}\r\n              </div>\r\n            </>\r\n          )}\r\n        </div>\r\n\r\n        <div>\r\n          {Array.isArray(data.images) && data.images.length > 0 && (\r\n            <div>\r\n              <strong>Images:</strong>\r\n              <div className=\"flex flex-wrap gap-2 mt-2\">\r\n                {data.images.map((img: string, idx: number) =>\r\n                  img ? (\r\n                    <img\r\n                      key={idx}\r\n                      src={img}\r\n                      alt={`Beneficiary image ${idx + 1}`}\r\n                      className=\"max-w-xs max-h-64 rounded shadow border\"\r\n                      style={{ objectFit: 'cover' }}\r\n                    />\r\n                  ) : null\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {isPrivileged && (\r\n            <div className=\"mt-4\">\r\n              <div>\r\n                <strong>Institution:</strong> {data.institution?.name ?? '-'}\r\n              </div>\r\n              <div>\r\n                <strong>Created At:</strong>{' '}\r\n                {data.createdAt ? new Date(data.createdAt).toLocaleString() : '-'}\r\n              </div>\r\n              <div>\r\n                <strong>Updated At:</strong>{' '}\r\n                {data.updatedAt ? new Date(data.updatedAt).toLocaleString() : '-'}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"mt-4\">\r\n        {onClose && (\r\n          <button className=\"px-4 py-2 bg-pink-700 text-white rounded\" onClick={onClose}>\r\n            Close\r\n          </button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// small helpers to avoid showing raw contact details to other beneficiaries\r\nfunction maskEmail(e: string) {\r\n  try {\r\n    const [local, domain] = e.split('@');\r\n    if (!local || !domain) return e;\r\n    if (local.length <= 2) return `*@${domain}`;\r\n    return `${local[0]}${'*'.repeat(Math.max(1, local.length - 2))}${local.slice(-1)}@${domain}`;\r\n  } catch {\r\n    return e;\r\n  }\r\n}\r\n\r\nfunction maskPhone(p: string) {\r\n  const digits = p.replace(/\\D/g, '');\r\n  if (digits.length <= 4) return '****';\r\n  return `${'*'.repeat(Math.max(0, digits.length - 4))}${digits.slice(-4)}`;\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 12982, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/views/messageView.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport dynamic from 'next/dynamic';\r\nimport { useSession } from 'next-auth/react';\r\nimport { Message, Response } from '@/lib/generated/prisma';\r\nimport '@/assets/styles/tiptap-editor.css';\r\n\r\n// TipTap JSON viewer for rich text message\r\nconst TiptapJsonViewer = dynamic(() => import('@/components/editor/tiptap-json-viewer'), {\r\n  ssr: false,\r\n});\r\n\r\ntype MessageWithRelations = Message & {\r\n  beneficiary?: {\r\n    id: string;\r\n    firstName: string;\r\n    lastName: string;\r\n    createdById?: string | null;\r\n  } | null;\r\n  createdBy?: {\r\n    id: string;\r\n    firstName?: string | null;\r\n    lastName?: string | null;\r\n    email?: string | null;\r\n  } | null;\r\n  // include createdById on the message when available (some APIs return it)\r\n  createdById?: string | null;\r\n  responses?: Array<\r\n    Response & {\r\n      responderUser?: {\r\n        id: string;\r\n        firstName: string;\r\n        lastName: string;\r\n        email?: string | null;\r\n      } | null;\r\n      responderBeneficiary?: {\r\n        id: string;\r\n        firstName: string;\r\n        lastName: string;\r\n        createdById?: string | null;\r\n      } | null;\r\n      message?: { id: number; title?: string | null };\r\n      responderRole?: 'USER' | 'BENEFICIARY' | 'AUTHOR' | 'SYSTEM';\r\n    }\r\n  >;\r\n};\r\n\r\nfunction AuthorBadge() {\r\n  return (\r\n    <span className=\"ml-2 inline-flex items-center text-xs font-semibold px-2 py-0.5 rounded bg-yellow-100 text-yellow-800 dark:bg-yellow-800 dark:text-yellow-100\">\r\n      Author\r\n    </span>\r\n  );\r\n}\r\n\r\nexport default function MessageView({\r\n  data,\r\n  onClose,\r\n  onRespond,\r\n}: {\r\n  data: MessageWithRelations;\r\n  onClose?: () => void;\r\n  onRespond?: (messageId: number | string) => void;\r\n}) {\r\n  const { data: session } = useSession();\r\n\r\n  if (!data) return null;\r\n\r\n  const content = data.content;\r\n\r\n  const renderContent = (c: unknown) => {\r\n    if (c === undefined || c === null) return <span>-</span>;\r\n    if (typeof c === 'object') {\r\n      return (\r\n        <div className=\"border rounded bg-white dark:bg-gray-900 mt-2\">\r\n          <TiptapJsonViewer content={c} className=\"tiptap tiptap-view-only\" />\r\n        </div>\r\n      );\r\n    }\r\n    return <span className=\"whitespace-pre-line\">{String(c)}</span>;\r\n  };\r\n\r\n  const ownerLabel = () => {\r\n    if (data.name && `${data.name}`.trim().length > 0) return data.name;\r\n    if (data.beneficiary) return `${data.beneficiary.firstName} ${data.beneficiary.lastName}`;\r\n    if (data.createdBy)\r\n      return `${data.createdBy.firstName ?? ''} ${data.createdBy.lastName ?? ''}`.trim();\r\n    return 'System';\r\n  };\r\n\r\n  const responderLabelText = (r: any) => {\r\n    if (!r) return 'System';\r\n    if (r.responderUser) {\r\n      const u = r.responderUser;\r\n      return `${u.firstName} ${u.lastName}${u.email ? ` (${u.email})` : ''}`;\r\n    }\r\n    if (r.responderBeneficiary) {\r\n      const b = r.responderBeneficiary;\r\n      return `${b.firstName} ${b.lastName}`;\r\n    }\r\n    // fallback to role\r\n    if (r.responderRole === 'AUTHOR') return 'Author';\r\n    return 'System';\r\n  };\r\n\r\n  // Helper: strict identity-based author check\r\n  const isResponseAuthor = (msg: MessageWithRelations, r: any) => {\r\n    // 1) server-declared AUTHOR is authoritative\r\n    if (r?.responderRole === 'AUTHOR') return true;\r\n\r\n    // message-level keys\r\n    const messageAuthorUserId =\r\n      (msg.createdBy && (msg.createdBy as any).id) ?? (msg as any).createdById ?? undefined;\r\n    const messageBeneficiaryId = msg.beneficiary?.id ?? (msg as any).beneficiaryId ?? undefined;\r\n\r\n    // responder-level keys\r\n    const responderUserId = r?.responderUser?.id ?? undefined;\r\n    const responderBeneficiaryId = r?.responderBeneficiary?.id ?? undefined;\r\n    const responderBeneficiaryOwnerId = r?.responderBeneficiary?.createdById ?? undefined;\r\n\r\n    // 2) If message was authored by a user account and responder is that same user\r\n    if (\r\n      messageAuthorUserId &&\r\n      responderUserId &&\r\n      String(messageAuthorUserId) === String(responderUserId)\r\n    )\r\n      return true;\r\n\r\n    // 3) If message is tied to a beneficiary (author is that beneficiary) and responder is that beneficiary\r\n    if (\r\n      messageBeneficiaryId &&\r\n      responderBeneficiaryId &&\r\n      String(messageBeneficiaryId) === String(responderBeneficiaryId)\r\n    )\r\n      return true;\r\n\r\n    // 4) If message was authored by a user account, and responder is a beneficiary whose createdById matches that user\r\n    //    (i.e., the responder beneficiary account is owned by the same user who authored the message)\r\n    if (\r\n      messageAuthorUserId &&\r\n      responderBeneficiaryOwnerId &&\r\n      String(messageAuthorUserId) === String(responderBeneficiaryOwnerId)\r\n    )\r\n      return true;\r\n\r\n    // No strict identity match => not author\r\n    return false;\r\n  };\r\n\r\n  // split responses by responder being the author of the message or not\r\n  const authorResponses = Array.isArray(data.responses)\r\n    ? data.responses.filter((r) => isResponseAuthor(data, r))\r\n    : [];\r\n  const otherResponses = Array.isArray(data.responses)\r\n    ? data.responses.filter((r) => !isResponseAuthor(data, r))\r\n    : [];\r\n\r\n  return (\r\n    <div className=\"w-full max-w-5xl mx-auto space-y-6 p-6 bg-background rounded-xl shadow\">\r\n      <h2 className=\"font-semibold text-xl mb-4\">View Message</h2>\r\n\r\n      <div className=\"space-y-3\">\r\n        {/* First line: owner name, category, createdAt, updatedAt (inline) */}\r\n        <div className=\"flex flex-wrap items-center gap-4 text-sm text-gray-600 dark:text-gray-300\">\r\n          <div className=\"font-medium\">{ownerLabel()}</div>\r\n          <div className=\"px-2 py-1 rounded bg-gray-100 dark:bg-gray-800 text-xs\">\r\n            {(data as any).messageCategory ?? '-'}\r\n          </div>\r\n          <div className=\"text-xs text-gray-500\">\r\n            Created: {data.createdAt ? new Date(data.createdAt).toLocaleString() : '-'}\r\n          </div>\r\n          <div className=\"text-xs text-gray-500\">\r\n            Updated: {data.updatedAt ? new Date(data.updatedAt).toLocaleString() : '-'}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Second line: message content */}\r\n        <div className=\"mt-2\">\r\n          <div className=\"font-medium mb-1\">Content</div>\r\n          <div className=\"ml-0\">{renderContent(content)}</div>\r\n        </div>\r\n\r\n        {/* Author response (distinct) */}\r\n        {authorResponses.length > 0 && (\r\n          <div className=\"mt-6\">\r\n            <h3 className=\"font-semibold text-lg mb-3\">Author's response</h3>\r\n            <div className=\"space-y-4\">\r\n              {authorResponses.map((r) => {\r\n                const isAuthor = isResponseAuthor(data, r);\r\n                return (\r\n                  <div\r\n                    key={r.id}\r\n                    className=\"p-3 border-l-4 border-pink-600 bg-pink-50 dark:bg-pink-900 rounded\"\r\n                  >\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div className=\"flex items-center\">\r\n                        <div className=\"text-sm font-medium\">{responderLabelText(r)}</div>\r\n                        {isAuthor && <AuthorBadge />}\r\n                      </div>\r\n                      <div className=\"text-xs text-gray-500\">\r\n                        {r.createdAt ? new Date(r.createdAt).toLocaleString() : ''}\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"mt-2\">{renderContent((r as any).content)}</div>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Other responses */}\r\n        {otherResponses.length > 0 && (\r\n          <div className=\"mt-6\">\r\n            <h3 className=\"font-semibold text-lg mb-3\">Responses</h3>\r\n            <div className=\"space-y-4\">\r\n              {otherResponses.map((r) => {\r\n                const isAuthor = isResponseAuthor(data, r);\r\n                return (\r\n                  <div key={r.id} className=\"p-3 border rounded bg-white dark:bg-gray-900\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div className=\"flex items-center\">\r\n                        <div className=\"text-sm font-medium\">{responderLabelText(r)}</div>\r\n                        {isAuthor && <AuthorBadge />}\r\n                      </div>\r\n                      <div className=\"text-xs text-gray-500\">\r\n                        {r.createdAt ? new Date(r.createdAt).toLocaleString() : ''}\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"mt-2\">{renderContent((r as any).content)}</div>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      <div className=\"flex gap-3 mt-4\">\r\n        {onClose && (\r\n          <button\r\n            type=\"button\"\r\n            className=\"px-4 py-2 bg-gray-200 dark:bg-gray-800 rounded hover:bg-gray-300 dark:hover:bg-gray-700\"\r\n            onClick={onClose}\r\n          >\r\n            Close\r\n          </button>\r\n        )}\r\n\r\n        {onRespond && data.allowResponses && (\r\n          <button\r\n            type=\"button\"\r\n            className=\"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700\"\r\n            onClick={() => onRespond(data.id)}\r\n          >\r\n            Respond\r\n          </button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 13395, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/components/views/responseView.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport dynamic from 'next/dynamic';\r\nimport { useSession } from 'next-auth/react';\r\nimport { Response } from '@/lib/generated/prisma';\r\nimport '@/assets/styles/tiptap-editor.css';\r\n\r\n// Lazy TipTap JSON viewer for rich text\r\nconst TiptapJsonViewer = dynamic(() => import('@/components/editor/tiptap-json-viewer'), {\r\n  ssr: false,\r\n});\r\n\r\ntype ResponseWithRelations = Response & {\r\n  responderUser?: {\r\n    id?: string;\r\n    firstName?: string | null;\r\n    lastName?: string | null;\r\n    email?: string | null;\r\n  } | null;\r\n  responderBeneficiary?: {\r\n    id?: string | null;\r\n    firstName?: string | null;\r\n    lastName?: string | null;\r\n    // include createdById when available so we can map between user<->beneficiary ownership\r\n    createdById?: string | null;\r\n  } | null;\r\n  message?: {\r\n    id?: number | string;\r\n    title?: string | null;\r\n    // creator user (if the message was authored by a user account)\r\n    createdById?: string | null;\r\n    createdBy?: {\r\n      id?: string | null;\r\n      firstName?: string | null;\r\n      lastName?: string | null;\r\n      email?: string | null;\r\n    } | null;\r\n    // beneficiary the message is tied to (if any)\r\n    beneficiary?: {\r\n      id?: string | null;\r\n      firstName?: string | null;\r\n      lastName?: string | null;\r\n      // include createdById when available\r\n      createdById?: string | null;\r\n    } | null;\r\n    // visitor fields\r\n    name?: string | null;\r\n    senderEmail?: string | null;\r\n  } | null;\r\n  responderRole?: 'USER' | 'BENEFICIARY' | 'AUTHOR' | 'SYSTEM';\r\n};\r\n\r\nfunction RoleBadge({ role }: { role?: string }) {\r\n  if (!role) return null;\r\n  const cls =\r\n    role === 'AUTHOR'\r\n      ? 'bg-yellow-100 text-yellow-800 dark:bg-yellow-800 dark:text-yellow-100'\r\n      : role === 'BENEFICIARY'\r\n      ? 'bg-indigo-100 text-indigo-800 dark:bg-indigo-800 dark:text-indigo-100'\r\n      : role === 'SYSTEM'\r\n      ? 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-100'\r\n      : 'bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100';\r\n  return (\r\n    <span\r\n      className={`ml-2 inline-flex items-center text-xs font-semibold px-2 py-0.5 rounded ${cls}`}\r\n    >\r\n      {role === 'AUTHOR' ? 'Author' : role.charAt(0) + role.slice(1).toLowerCase()}\r\n    </span>\r\n  );\r\n}\r\n\r\n/**\r\n * Response view component\r\n *\r\n * The \"Author\" badge is shown only when the responder is the same entity as the author of the message.\r\n * Checks performed (in order of preference):\r\n * 1) Server-provided responderRole === 'AUTHOR' (definitive)\r\n * 2) If both message.createdById and responderUser.id exist -> compare user ids\r\n * 3) If both message.beneficiary.id and responderBeneficiary.id exist -> compare beneficiary ids\r\n * 4) If message.createdById exists and responderBeneficiary.createdById exists -> compare those user ids\r\n *\r\n * NOTE: For reliable behavior, ensure your API includes:\r\n *  - message.createdById or message.createdBy.id\r\n *  - message.beneficiary.id (if message ties to a beneficiary)\r\n *  - responderUser.id when responder is a user\r\n *  - responderBeneficiary.id and responderBeneficiary.createdById when responder is a beneficiary\r\n */\r\nexport default function ResponseView({\r\n  data,\r\n  onClose,\r\n}: {\r\n  data: ResponseWithRelations | null | undefined;\r\n  onClose?: () => void;\r\n}) {\r\n  const { data: session } = useSession();\r\n\r\n  if (!data) return null;\r\n\r\n  const renderContent = (c: unknown) => {\r\n    if (c === undefined || c === null) return <span>-</span>;\r\n    if (typeof c === 'object') {\r\n      return (\r\n        <TiptapJsonViewer\r\n          content={c}\r\n          className=\"tiptap tiptap-view-only border rounded bg-white dark:bg-gray-900 p-3\"\r\n        />\r\n      );\r\n    }\r\n    return <div className=\"whitespace-pre-line\">{String(c)}</div>;\r\n  };\r\n\r\n  const responderLabelText = () => {\r\n    if (data.responderUser) {\r\n      const u = data.responderUser;\r\n      return `${u.firstName ?? ''} ${u.lastName ?? ''}`.trim() + (u.email ? ` (${u.email})` : '');\r\n    }\r\n    if (data.responderBeneficiary) {\r\n      const b = data.responderBeneficiary;\r\n      return `${b.firstName ?? ''} ${b.lastName ?? ''}`.trim();\r\n    }\r\n    return 'System';\r\n  };\r\n\r\n  // Determine if this response should be tagged \"Author\"\r\n  const isAuthor =\r\n    // 1) Server-declared author\r\n    data.responderRole === 'AUTHOR' ||\r\n    // 2) message.createdById === responderUser.id (user-to-user match)\r\n    (!!data.message?.createdById &&\r\n      !!data.responderUser?.id &&\r\n      String(data.message.createdById) === String(data.responderUser.id)) ||\r\n    // 3) message.beneficiary.id === responderBeneficiary.id (beneficiary-to-beneficiary match)\r\n    (!!data.message?.beneficiary?.id &&\r\n      !!data.responderBeneficiary?.id &&\r\n      String(data.message.beneficiary.id) === String(data.responderBeneficiary.id)) ||\r\n    // 4) message.createdById === responderBeneficiary.createdById (message authored by a user account that also owns the beneficiary account)\r\n    (!!data.message?.createdById &&\r\n      !!data.responderBeneficiary?.createdById &&\r\n      String(data.message.createdById) === String(data.responderBeneficiary.createdById));\r\n\r\n  const badgeRole = isAuthor ? 'AUTHOR' : data.responderRole ?? undefined;\r\n\r\n  return (\r\n    <div className=\"w-full max-w-3xl mx-auto p-6 bg-background rounded-xl shadow space-y-4\">\r\n      <div className=\"flex items-start justify-between gap-4\">\r\n        <div>\r\n          <div className=\"flex items-center\">\r\n            <div className=\"text-lg font-medium\">{responderLabelText()}</div>\r\n            {/* Place the Author tag (or other role badge) directly after the name/email */}\r\n            <RoleBadge role={badgeRole} />\r\n          </div>\r\n          <div className=\"text-xs text-gray-500 mt-1\">\r\n            {data.createdAt ? new Date(data.createdAt).toLocaleString() : ''}\r\n            {data.message?.title ? <span className=\"ml-2\">· in \"{data.message.title}\"</span> : null}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"text-right text-xs text-gray-500\">\r\n          {data.updatedAt ? `Updated ${new Date(data.updatedAt).toLocaleString()}` : ''}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"pt-2 pb-4 border-t\">{renderContent((data as any).content)}</div>\r\n\r\n      <div className=\"flex gap-3\">\r\n        {onClose && (\r\n          <button\r\n            className=\"px-4 py-2 bg-gray-200 dark:bg-gray-800 rounded hover:bg-gray-300 dark:hover:bg-gray-700\"\r\n            onClick={onClose}\r\n          >\r\n            Close\r\n          </button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 13584, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GERALD/Desktop/NEXT/gogirlsict/app/%28admin%29/admin/dashboard/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useSession } from 'next-auth/react';\r\nimport { useRouter, useSearchParams, usePathname } from 'next/navigation';\r\nimport { useEffect, useState, useRef } from 'react';\r\nimport * as XLSX from 'xlsx';\r\nimport DownloadColumnsModal, { ColumnOption } from './components/downloadColumnsModal';\r\nimport { handleDownloadPDF } from './components/handleDownloadPDF';\r\n\r\nimport {\r\n  FaUsers,\r\n  FaUserCog,\r\n  FaEnvelope,\r\n  FaReply,\r\n  FaCogs,\r\n  FaHome,\r\n  FaClipboardList,\r\n  FaCalendarAlt,\r\n  FaFilePdf,\r\n  FaUniversity,\r\n  FaAngleLeft,\r\n  FaAngleRight,\r\n} from 'react-icons/fa';\r\n\r\n// Sections we keep + Charts/Home + Projects/Events/Reports/Institutions\r\nimport BeneficiariesSection from './components/sections/BeneficiariesSection';\r\nimport MessagesSection from './components/sections/MessagesSection';\r\nimport ResponsesSection from './components/sections/ResponsesSection';\r\nimport UsersSection from './components/sections/UsersSection';\r\nimport SettingsSection from './components/sections/SettingsSection';\r\nimport ChartSection from './chartSection'; // Chart / Home section\r\nimport ProjectsSection from './components/sections/ProjectsSection';\r\nimport EventsSection from './components/sections/EventsSection';\r\nimport ReportsSection from './components/sections/ReportsSection';\r\nimport InstitutionsSection from './components/sections/InstitutionsSection';\r\n\r\n// Create/edit forms we keep + new ones\r\nimport CreateBeneficiaryForm from './createBeneficiaryForm';\r\nimport CreateMessageForm from './createMessageForm';\r\nimport CreateResponseForm from './createResponseForm';\r\nimport CreateUserForm from './createUserForm';\r\nimport CreateProjectForm from './createProjectForm';\r\nimport CreateReportForm from './createReportForm';\r\nimport CreateEventForm from './createEventForm';\r\nimport CreateInstitutionForm from './createInstitutionForm';\r\n\r\n// View-only components we keep + new ones\r\nimport BeneficiaryView from './components/views/beneficiaryView';\r\nimport MessageView from './components/views/messageView';\r\nimport ResponseView from './components/views/responseView';\r\nimport UserView from './components/views/userView';\r\nimport ProjectView from './components/views/projectView';\r\nimport ReportView from './components/views/reportView';\r\nimport EventView from './components/views/eventView';\r\nimport InstitutionView from './components/views/institutionView';\r\n\r\n// Table controls component for search/filter/add/export\r\nfunction TableControls({\r\n  search,\r\n  setSearch,\r\n  onAddNew,\r\n  exportExcel,\r\n  downloadPDF,\r\n  activeSection,\r\n  sectionLabels,\r\n  hideSearch,\r\n  addNewLabel,\r\n}: {\r\n  search: string;\r\n  setSearch: (s: string) => void;\r\n  onAddNew: () => void;\r\n  exportExcel: () => void;\r\n  downloadPDF: () => void;\r\n  activeSection: string;\r\n  sectionLabels: Record<string, string>;\r\n  hideSearch?: boolean;\r\n  addNewLabel?: string;\r\n}) {\r\n  return (\r\n    <div className=\"flex flex-wrap items-center justify-between mb-4 gap-2\">\r\n      <div className=\"flex items-center gap-2 flex-1\">\r\n        {!hideSearch && (\r\n          <input\r\n            type=\"text\"\r\n            className=\"border px-3 py-2 rounded w-64 focus:outline-pink-500 dark:bg-gray-800 dark:text-white\"\r\n            placeholder={`Search ${sectionLabels[activeSection] || 'records'}...`}\r\n            value={search}\r\n            onChange={(e) => setSearch(e.target.value)}\r\n          />\r\n        )}\r\n        {!hideSearch && (\r\n          <>\r\n            <button\r\n              className=\"px-2 py-1 border rounded text-sm bg-green-50 hover:bg-green-100 dark:bg-gray-800 dark:hover:bg-green-900\"\r\n              title=\"Export to Excel\"\r\n              onClick={exportExcel}\r\n            >\r\n              Export to Excel\r\n            </button>\r\n            <button\r\n              className=\"px-2 py-1 border rounded text-sm bg-yellow-50 hover:bg-yellow-100 dark:bg-gray-800 dark:hover:bg-yellow-900\"\r\n              title=\"Download as PDF\"\r\n              onClick={downloadPDF}\r\n            >\r\n              Download as PDF\r\n            </button>\r\n          </>\r\n        )}\r\n      </div>\r\n      <div>\r\n        {addNewLabel && (\r\n          <button\r\n            className=\"px-4 py-2 bg-pink-700 text-white rounded hover:bg-pink-900 text-sm font-semibold\"\r\n            onClick={onAddNew}\r\n          >\r\n            {addNewLabel}\r\n          </button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Sections (added 'home', 'projects', 'events', 'reports', 'institutions')\r\nconst sections = [\r\n  'home',\r\n  'projects',\r\n  'events',\r\n  'reports',\r\n  'institutions',\r\n  'beneficiaries',\r\n  'messages',\r\n  'responses', // kept in list so section can still be used programmatically\r\n  'users',\r\n  'settings',\r\n] as const;\r\ntype Section = (typeof sections)[number];\r\n\r\nconst sectionFeatures: Record<Section, { apiRoute?: string }> = {\r\n  home: {},\r\n  projects: { apiRoute: '/api/projects' },\r\n  events: { apiRoute: '/api/events' },\r\n  reports: { apiRoute: '/api/reports' },\r\n  institutions: { apiRoute: '/api/institutions' },\r\n  beneficiaries: { apiRoute: '/api/beneficiaries' },\r\n  messages: { apiRoute: '/api/messages' },\r\n  responses: { apiRoute: '/api/responses' },\r\n  users: { apiRoute: '/api/users' },\r\n  settings: {},\r\n};\r\n\r\nconst sectionIcons: Record<Section, React.ReactNode> = {\r\n  home: <FaHome className=\"text-pink-600 dark:text-pink-400\" />,\r\n  projects: <FaClipboardList className=\"text-yellow-600 dark:text-yellow-400\" />,\r\n  events: <FaCalendarAlt className=\"text-green-600 dark:text-green-400\" />,\r\n  reports: <FaFilePdf className=\"text-red-600 dark:text-red-400\" />,\r\n  institutions: <FaUniversity className=\"text-blue-600 dark:text-blue-400\" />,\r\n  beneficiaries: <FaUsers className=\"text-indigo-600 dark:text-indigo-400\" />,\r\n  messages: <FaEnvelope className=\"text-orange-500 dark:text-orange-400\" />,\r\n  responses: <FaReply className=\"text-purple-600 dark:text-purple-400\" />,\r\n  users: <FaUserCog className=\"text-gray-700 dark:text-gray-300\" />,\r\n  settings: <FaCogs className=\"text-gray-700 dark:text-gray-300\" />,\r\n};\r\n\r\nconst sectionLabels: Record<Section, string> = {\r\n  home: 'Home',\r\n  projects: 'Projects',\r\n  events: 'Events',\r\n  reports: 'Reports',\r\n  institutions: 'Institutions',\r\n  beneficiaries: 'Beneficiaries',\r\n  messages: 'Messages',\r\n  responses: 'Responses',\r\n  users: 'Users',\r\n  settings: 'Settings',\r\n};\r\n\r\nexport default function AdminDashboardPage() {\r\n  const { data: session } = useSession();\r\n  const router = useRouter();\r\n  const [activeSection, setActiveSection] = useState<Section>('beneficiaries');\r\n  const [sidebarCollapsed, setSidebarCollapsed] = useState(false);\r\n  const [data, setData] = useState<any[]>([]);\r\n  const [editRecord, setEditRecord] = useState<any | null>(null);\r\n  const [viewRecord, setViewRecord] = useState<any | null>(null);\r\n  const [deleteId, setDeleteId] = useState<string | number | null>(null);\r\n  const [deleteLoading, setDeleteLoading] = useState(false);\r\n  const [sortBy, setSortBy] = useState('createdAt');\r\n  const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('desc');\r\n  const [rowsPerPage, setRowsPerPage] = useState<number>(10);\r\n  const [page, setPage] = useState<number>(1);\r\n  const [search, setSearch] = useState('');\r\n  const sectionRef = useRef<Section>('beneficiaries');\r\n\r\n  const searchParams = useSearchParams();\r\n  const pathname = usePathname();\r\n\r\n  const [downloadModalOpen, setDownloadModalOpen] = useState(false);\r\n  const [downloadColumns, setDownloadColumns] = useState<ColumnOption[]>([]);\r\n  const [pendingDownloadData, setPendingDownloadData] = useState<any[]>([]);\r\n\r\n  // Hide controls when viewing/editing/adding\r\n  const [hideControls, setHideControls] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const searchType = (searchParams.get('type') as Section) ?? null;\r\n    const sectionToLoad: Section =\r\n      searchType && sections.includes(searchType) ? searchType : 'beneficiaries';\r\n    handleMenuClick(sectionToLoad);\r\n    // eslint-disable-next-line\r\n  }, []);\r\n\r\n  async function handleMenuClick(section: Section) {\r\n    const newUrl = `${pathname}?type=${section}`;\r\n    router.replace(newUrl);\r\n    setActiveSection(section);\r\n    sectionRef.current = section;\r\n    setEditRecord(null);\r\n    setViewRecord(null);\r\n    setDeleteId(null);\r\n    setPage(1);\r\n    setHideControls(false);\r\n\r\n    const feat = sectionFeatures[section];\r\n    if (feat?.apiRoute) {\r\n      try {\r\n        const res = await fetch(feat.apiRoute);\r\n        if (!res.ok) {\r\n          setData([]);\r\n          return;\r\n        }\r\n        const rawData = await res.json();\r\n        if (Array.isArray(rawData)) {\r\n          setData(rawData);\r\n        } else if (rawData == null) {\r\n          setData([]);\r\n        } else {\r\n          setData([rawData]);\r\n        }\r\n      } catch {\r\n        setData([]);\r\n      }\r\n    } else {\r\n      setData([]);\r\n    }\r\n  }\r\n\r\n  function getSortedData(\r\n    data: any[],\r\n    sortBy: string,\r\n    sortOrder: 'asc' | 'desc',\r\n    activeSection: Section\r\n  ) {\r\n    if (!Array.isArray(data)) return [];\r\n    let sorted = [...data];\r\n    sorted.sort((a, b) => {\r\n      let valA = a[sortBy];\r\n      let valB = b[sortBy];\r\n      if (sortBy === 'createdAt' || sortBy === 'updatedAt') {\r\n        valA = new Date(valA).getTime();\r\n        valB = new Date(valB).getTime();\r\n      }\r\n      if (valA < valB) return sortOrder === 'asc' ? -1 : 1;\r\n      if (valA > valB) return sortOrder === 'asc' ? 1 : -1;\r\n      return 0;\r\n    });\r\n    return sorted;\r\n  }\r\n\r\n  function getFilteredData(sortedData: any[], search: string) {\r\n    if (!Array.isArray(sortedData)) return [];\r\n    if (!search.trim()) return sortedData;\r\n    const lower = search.toLowerCase();\r\n    return sortedData.filter((item) =>\r\n      Object.keys(item).some(\r\n        (key) => typeof item[key] === 'string' && item[key].toLowerCase().includes(lower)\r\n      )\r\n    );\r\n  }\r\n\r\n  function getPaginatedData(filteredData: any[], page: number, rowsPerPage: number) {\r\n    if (!Array.isArray(filteredData)) return [];\r\n    return (filteredData ?? []).slice((page - 1) * rowsPerPage, page * rowsPerPage);\r\n  }\r\n\r\n  const sortedData = getSortedData(data, sortBy, sortOrder, activeSection);\r\n  const filteredData = getFilteredData(sortedData, search);\r\n  const pageCount = Math.max(1, Math.ceil((filteredData?.length ?? 0) / rowsPerPage));\r\n  const paginatedData = getPaginatedData(filteredData, page, rowsPerPage);\r\n\r\n  // Edit/View handlers\r\n  function handleEdit(record: any) {\r\n    setHideControls(true);\r\n    setEditRecord(record);\r\n  }\r\n  function handleCancelEdit() {\r\n    setHideControls(false);\r\n    setEditRecord(null);\r\n  }\r\n  async function handleSaveEdit() {\r\n    setHideControls(false);\r\n    setEditRecord(null);\r\n    await handleMenuClick(activeSection);\r\n  }\r\n\r\n  function handleRespondToMessage(messageId: number | string) {\r\n    setHideControls(true);\r\n    setActiveSection('responses');\r\n    setEditRecord({ messageId });\r\n    setViewRecord(null);\r\n  }\r\n\r\n  // Unified view handler used by sections.\r\n\r\n  async function handleView(record: any, source?: Section) {\r\n    setHideControls(true);\r\n\r\n    if (!record) {\r\n      setViewRecord(null);\r\n      return;\r\n    }\r\n\r\n    // If the request came from the messages list, show the MessageView (with responses)\r\n    if (source === 'messages' || sectionRef.current === 'messages') {\r\n      try {\r\n        const id = record?.id ?? record;\r\n        const msgRes = await fetch(`/api/messages/${id}`);\r\n        const msgData = msgRes.ok ? await msgRes.json() : record;\r\n\r\n        const respRes = await fetch(`/api/responses`);\r\n        const respData = respRes.ok ? await respRes.json() : [];\r\n\r\n        const parentId = typeof msgData.id === 'number' ? msgData.id : Number(msgData.id);\r\n        const linkedResponses = Array.isArray(respData)\r\n          ? respData.filter(\r\n              (r: any) =>\r\n                (r.message && (r.message.id === parentId || Number(r.message.id) === parentId)) ||\r\n                (r.messageId && Number(r.messageId) === parentId)\r\n            )\r\n          : [];\r\n\r\n        setViewRecord({ ...msgData, responses: linkedResponses });\r\n        setActiveSection('messages');\r\n        return;\r\n      } catch {\r\n        // fallback to showing raw record\r\n      }\r\n    }\r\n\r\n    // If the request came from responses, show ResponseView\r\n    if (source === 'responses' || sectionRef.current === 'responses') {\r\n      try {\r\n        const id = record?.id ?? record;\r\n        const res = await fetch(`/api/responses/${id}`);\r\n        if (res.ok) {\r\n          const fullRecord = await res.json();\r\n          setViewRecord(fullRecord);\r\n          setActiveSection('responses');\r\n          return;\r\n        }\r\n      } catch {\r\n        // fallback\r\n      }\r\n    }\r\n\r\n    // NEW: If the request came from users, fetch full user details before showing UserView\r\n    // This handles cases where UsersSection only passes an id (or a partial record).\r\n    if (source === 'users' || sectionRef.current === 'users') {\r\n      try {\r\n        const id = record?.id ?? record;\r\n        // Attempt to fetch the full user record from the API\r\n        const res = await fetch(`/api/users/${id}`);\r\n        if (res.ok) {\r\n          const fullRecord = await res.json();\r\n          setViewRecord(fullRecord);\r\n          setActiveSection('users');\r\n          return;\r\n        }\r\n        // If fetch fails (403/404), fall back to using the passed record (if it's an object)\r\n      } catch {\r\n        // ignore and fallback below\r\n      }\r\n    }\r\n\r\n    // For beneficiaries, projects, events, reports, institutions or fallback, set viewRecord directly\r\n    setViewRecord(record);\r\n  }\r\n\r\n  function handleCloseView() {\r\n    setHideControls(false);\r\n    setViewRecord(null);\r\n  }\r\n\r\n  async function handleDelete(id: string | number) {\r\n    setDeleteId(id);\r\n    setDeleteLoading(true);\r\n    try {\r\n      let apiRoute = sectionFeatures[activeSection]?.apiRoute;\r\n      if (!apiRoute) throw new Error('Delete API route not defined');\r\n      if (apiRoute.endsWith('/')) apiRoute = apiRoute.slice(0, -1);\r\n      const url = `${apiRoute}/${id}`;\r\n      const res = await fetch(url, { method: 'DELETE' });\r\n      const text = await res.text();\r\n      if (!res.ok) {\r\n        alert(`Failed to delete record: ${res.status}\\n${text}`);\r\n      } else {\r\n        await handleMenuClick(activeSection);\r\n      }\r\n    } catch (err) {\r\n      alert('Error deleting record: ' + err);\r\n    } finally {\r\n      setDeleteLoading(false);\r\n      setDeleteId(null);\r\n    }\r\n  }\r\n\r\n  function getCurrentColumns(): any[] {\r\n    return [];\r\n  }\r\n  const handleExportExcel = () => {\r\n    const columns = getCurrentColumns();\r\n    const headers = columns\r\n      .filter((col) => col.header && col.header !== 'Actions' && col.header !== 'Delete')\r\n      .map((col) => (typeof col.header === 'function' ? col.header({}) : col.header));\r\n    const exportableCols = columns.filter(\r\n      (col) => col.header && col.header !== 'Actions' && col.header !== 'Delete'\r\n    );\r\n    const rows = paginatedData.map((row, idx) =>\r\n      exportableCols.map((col) => {\r\n        if (col.id === 'number') return idx + 1;\r\n        return row[col.id || col.accessorKey] ?? '';\r\n      })\r\n    );\r\n    const ws = XLSX.utils.aoa_to_sheet([headers, ...rows]);\r\n    const wb = XLSX.utils.book_new();\r\n    XLSX.utils.book_append_sheet(wb, ws, 'Sheet1');\r\n    XLSX.writeFile(wb, 'table.xlsx');\r\n  };\r\n  const handleDownloadPDFButton = () => {\r\n    const columns = getCurrentColumns();\r\n    const columnOptions: ColumnOption[] = columns\r\n      .filter((col) => col.header && col.header !== 'Actions' && col.header !== 'Delete')\r\n      .map((col) => ({\r\n        id: col.id || col.accessorKey,\r\n        label: typeof col.header === 'function' ? col.header({}) : col.header,\r\n      }));\r\n    setDownloadColumns(columnOptions);\r\n    setPendingDownloadData(paginatedData);\r\n    setDownloadModalOpen(true);\r\n  };\r\n\r\n  function handleAddNew() {\r\n    setHideControls(true);\r\n    setEditRecord({});\r\n    setViewRecord(null);\r\n  }\r\n\r\n  function renderSection() {\r\n    if (viewRecord) {\r\n      switch (activeSection) {\r\n        case 'messages':\r\n          return (\r\n            <MessageView\r\n              data={viewRecord}\r\n              onClose={handleCloseView}\r\n              onRespond={handleRespondToMessage}\r\n            />\r\n          );\r\n        case 'responses':\r\n          return <ResponseView data={viewRecord} onClose={handleCloseView} />;\r\n        case 'beneficiaries':\r\n          return <BeneficiaryView data={viewRecord} onClose={handleCloseView} />;\r\n        case 'projects':\r\n          return <ProjectView data={viewRecord} onClose={handleCloseView} />;\r\n        case 'events':\r\n          return <EventView data={viewRecord} onClose={handleCloseView} />;\r\n        case 'reports':\r\n          return <ReportView data={viewRecord} onClose={handleCloseView} />;\r\n        case 'institutions':\r\n          return <InstitutionView data={viewRecord} onClose={handleCloseView} />;\r\n        case 'home':\r\n          return <ChartSection />;\r\n        case 'settings':\r\n          // Settings section manages its own modal / edit UI internally\r\n          return <SettingsSection currentUserId={(session?.user as any)?.id} />;\r\n        default:\r\n          return null;\r\n      }\r\n    }\r\n\r\n    if (editRecord) {\r\n      switch (activeSection) {\r\n        case 'projects':\r\n          return (\r\n            <CreateProjectForm\r\n              initialValues={editRecord}\r\n              onSuccess={handleSaveEdit}\r\n              onCancel={handleCancelEdit}\r\n            />\r\n          );\r\n        case 'reports':\r\n          return (\r\n            <CreateReportForm\r\n              initialValues={editRecord}\r\n              onSuccess={handleSaveEdit}\r\n              onCancel={handleCancelEdit}\r\n            />\r\n          );\r\n        case 'events':\r\n          return (\r\n            <CreateEventForm\r\n              initialValues={editRecord}\r\n              onSuccess={handleSaveEdit}\r\n              onCancel={handleCancelEdit}\r\n            />\r\n          );\r\n        case 'institutions':\r\n          return (\r\n            <CreateInstitutionForm\r\n              initialValues={editRecord}\r\n              onSuccess={handleSaveEdit}\r\n              onCancel={handleCancelEdit}\r\n            />\r\n          );\r\n        case 'beneficiaries':\r\n          return (\r\n            <CreateBeneficiaryForm\r\n              initialData={editRecord}\r\n              onSuccess={handleSaveEdit}\r\n              onCancel={handleCancelEdit}\r\n              mode={editRecord?.id ? 'edit' : 'create'}\r\n            />\r\n          );\r\n        case 'messages':\r\n          return (\r\n            <CreateMessageForm\r\n              initialValues={editRecord}\r\n              onSuccess={handleSaveEdit}\r\n              onCancel={handleCancelEdit}\r\n            />\r\n          );\r\n        case 'responses':\r\n          return (\r\n            <CreateResponseForm\r\n              messageId={editRecord?.messageId}\r\n              editId={editRecord?.id}\r\n              initialData={editRecord?.id ? editRecord : undefined}\r\n              onSuccess={handleSaveEdit}\r\n              onCancel={handleCancelEdit}\r\n            />\r\n          );\r\n        case 'users':\r\n          // Render the existing create/edit user form in edit mode.\r\n          return (\r\n            <CreateUserForm\r\n              mode=\"edit\"\r\n              userId={String(editRecord?.id ?? editRecord?.userId ?? '')}\r\n              initialData={editRecord?.initialData ?? undefined}\r\n              onSuccess={handleSaveEdit}\r\n              onCancel={handleCancelEdit}\r\n            />\r\n          );\r\n        default:\r\n          return null;\r\n      }\r\n    }\r\n\r\n    switch (activeSection) {\r\n      case 'home':\r\n        return <ChartSection />;\r\n      case 'projects':\r\n        return (\r\n          <ProjectsSection\r\n            paginatedData={paginatedData}\r\n            page={page}\r\n            rowsPerPage={rowsPerPage}\r\n            handleEdit={handleEdit}\r\n            handleView={(r: any) => handleView(r, 'projects')}\r\n            handleDelete={handleDelete}\r\n            TableActions={() => null}\r\n            deleteId={deleteId}\r\n            deleteLoading={deleteLoading}\r\n          />\r\n        );\r\n      case 'events':\r\n        return (\r\n          <EventsSection\r\n            paginatedData={paginatedData}\r\n            page={page}\r\n            rowsPerPage={rowsPerPage}\r\n            handleEdit={handleEdit}\r\n            handleView={(r: any) => handleView(r, 'events')}\r\n            handleDelete={handleDelete}\r\n            TableActions={() => null}\r\n            deleteId={deleteId}\r\n            deleteLoading={deleteLoading}\r\n          />\r\n        );\r\n      case 'reports':\r\n        return (\r\n          <ReportsSection\r\n            paginatedData={paginatedData}\r\n            page={page}\r\n            rowsPerPage={rowsPerPage}\r\n            handleEdit={handleEdit}\r\n            handleView={(r: any) => handleView(r, 'reports')}\r\n            handleDelete={handleDelete}\r\n            TableActions={() => null}\r\n            deleteId={deleteId}\r\n            deleteLoading={deleteLoading}\r\n          />\r\n        );\r\n      case 'institutions':\r\n        return (\r\n          <InstitutionsSection\r\n            paginatedData={paginatedData}\r\n            page={page}\r\n            rowsPerPage={rowsPerPage}\r\n            handleEdit={handleEdit}\r\n            handleView={(r: any) => handleView(r, 'institutions')}\r\n            handleDelete={handleDelete}\r\n            TableActions={() => null}\r\n            deleteId={deleteId}\r\n            deleteLoading={deleteLoading}\r\n          />\r\n        );\r\n      case 'beneficiaries':\r\n        return (\r\n          <BeneficiariesSection\r\n            paginatedData={paginatedData}\r\n            page={page}\r\n            rowsPerPage={rowsPerPage}\r\n            handleEdit={handleEdit}\r\n            handleView={(r: any) => handleView(r, 'beneficiaries')}\r\n            handleDelete={handleDelete}\r\n            messagesCountMap={{}}\r\n            requestsCountMap={{}}\r\n            currentUserRole={(session?.user as any)?.role ?? ''}\r\n            TableActions={() => null}\r\n            onAddMessage={(id: string) => {\r\n              // open create message modal bound to beneficiary\r\n              setHideControls(true);\r\n              setEditRecord({ beneficiaryId: id });\r\n            }}\r\n            onAddRequest={() => {}}\r\n            deleteId={deleteId}\r\n            deleteLoading={deleteLoading}\r\n          />\r\n        );\r\n      case 'messages':\r\n        return (\r\n          <MessagesSection\r\n            paginatedData={paginatedData}\r\n            page={page}\r\n            rowsPerPage={rowsPerPage}\r\n            handleEdit={handleEdit}\r\n            handleView={(r: any) => handleView(r, 'messages')}\r\n            handleDelete={handleDelete}\r\n            onRespond={handleRespondToMessage}\r\n            currentUserRole={(session?.user as any)?.role ?? ''}\r\n            TableActions={() => null}\r\n            deleteId={deleteId}\r\n            deleteLoading={deleteLoading}\r\n          />\r\n        );\r\n      case 'responses':\r\n        return (\r\n          <ResponsesSection\r\n            paginatedData={paginatedData}\r\n            page={page}\r\n            rowsPerPage={rowsPerPage}\r\n            handleEdit={handleEdit}\r\n            handleView={(r: any) => handleView(r, 'responses')}\r\n            handleDelete={handleDelete}\r\n            TableActions={() => null}\r\n            deleteId={deleteId}\r\n            deleteLoading={deleteLoading}\r\n          />\r\n        );\r\n      case 'users':\r\n        return (\r\n          <UsersSection\r\n            paginatedData={paginatedData}\r\n            page={page}\r\n            rowsPerPage={rowsPerPage}\r\n            handleEdit={handleEdit}\r\n            handleView={(r: any) => handleView(r, 'users')}\r\n            handleDelete={handleDelete}\r\n            TableActions={() => null}\r\n            deleteId={deleteId}\r\n            deleteLoading={deleteLoading}\r\n          />\r\n        );\r\n      case 'settings':\r\n        // SettingsSection is rendered above when viewRecord is not set; here we also render it when selected as activeSection\r\n        return <SettingsSection currentUserId={(session?.user as any)?.id} />;\r\n      default:\r\n        return null;\r\n    }\r\n  }\r\n\r\n  const isSettingsSection = activeSection === 'settings';\r\n\r\n  return (\r\n    <div className=\"flex h-screen bg-gray-50 dark:bg-gray-900 transition-colors\">\r\n      {/* Sidebar */}\r\n      <aside\r\n        className={`transition-all duration-300 bg-white dark:bg-gray-950 border-r dark:border-gray-800 shadow-sm h-full ${\r\n          sidebarCollapsed ? 'w-16' : 'w-60'\r\n        } flex flex-col`}\r\n      >\r\n        <div className=\"flex items-center justify-between px-2 py-4 border-b dark:border-gray-800\">\r\n          <span className=\"text-xl font-bold text-pink-600 dark:text-pink-400 hidden sm:block\">\r\n            {!sidebarCollapsed && 'Dashboard'}\r\n          </span>\r\n          <button\r\n            className=\"ml-auto p-2 text-gray-700 dark:text-gray-300 hover:text-pink-600 dark:hover:text-pink-400\"\r\n            onClick={() => setSidebarCollapsed((c) => !c)}\r\n            aria-label={sidebarCollapsed ? 'Expand sidebar' : 'Collapse sidebar'}\r\n          >\r\n            {sidebarCollapsed ? <FaAngleRight size={18} /> : <FaAngleLeft size={18} />}\r\n          </button>\r\n        </div>\r\n        <nav className=\"mt-2 flex-1 overflow-y-auto\">\r\n          {sections.map((section) => {\r\n            // Comment out the Responses tab from the sidebar by skipping rendering for it.\r\n            // We keep 'responses' in the sections array so the section can still be used programmatically.\r\n            if (section === 'responses') {\r\n              return null;\r\n            }\r\n            const isActive = activeSection === section;\r\n            return (\r\n              <button\r\n                key={section}\r\n                onClick={() => handleMenuClick(section)}\r\n                className={`w-full flex items-center gap-3 pl-4 pr-2 py-2 rounded transition-all font-medium\r\n                  ${\r\n                    isActive\r\n                      ? 'bg-pink-100 dark:bg-pink-950 text-pink-600 dark:text-pink-400'\r\n                      : 'text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-900 hover:text-pink-700 dark:hover:text-pink-400'\r\n                  }\r\n                `}\r\n                style={{ minWidth: 0 }}\r\n              >\r\n                <span className={`transition-all ${isActive ? 'text-2xl' : 'text-xl'}`}>\r\n                  {sectionIcons[section]}\r\n                </span>\r\n                {!sidebarCollapsed && (\r\n                  <span\r\n                    className={`truncate transition-all ${\r\n                      isActive ? 'text-lg font-semibold' : 'text-sm'\r\n                    }`}\r\n                  >\r\n                    {sectionLabels[section]}\r\n                  </span>\r\n                )}\r\n              </button>\r\n            );\r\n          })}\r\n        </nav>\r\n      </aside>\r\n\r\n      {/* Main Content */}\r\n      <main className=\"flex-1 min-w-0 overflow-y-auto p-4 bg-white dark:bg-gray-900 transition-colors\">\r\n        {/* Top bar */}\r\n        <div className=\"flex items-center gap-2 mb-8\">\r\n          <span className=\"text-2xl\">{sectionIcons[activeSection]}</span>\r\n          <span className=\"text-xl font-bold text-gray-700 dark:text-gray-100\">\r\n            {sectionLabels[activeSection]}\r\n          </span>\r\n        </div>\r\n\r\n        {/* Controls */}\r\n        {!hideControls && (\r\n          <TableControls\r\n            search={search}\r\n            setSearch={setSearch}\r\n            onAddNew={handleAddNew}\r\n            exportExcel={handleExportExcel}\r\n            downloadPDF={handleDownloadPDFButton}\r\n            activeSection={activeSection}\r\n            sectionLabels={sectionLabels}\r\n            hideSearch={false}\r\n            addNewLabel={isSettingsSection ? undefined : `Add New ${sectionLabels[activeSection]}`}\r\n          />\r\n        )}\r\n\r\n        {/* Section Content */}\r\n        <div className=\"w-full flex flex-col\">\r\n          {activeSection && <div className=\"mt-2 w-full\">{renderSection()}</div>}\r\n        </div>\r\n\r\n        {/* Pagination */}\r\n        {pageCount > 1 && !hideControls && (\r\n          <div className=\"flex gap-2 mt-4 justify-end items-center\">\r\n            <button\r\n              className=\"px-2 py-1 rounded border dark:border-gray-700 dark:bg-gray-950 dark:text-gray-100\"\r\n              disabled={page === 1}\r\n              onClick={() => setPage(page - 1)}\r\n            >\r\n              Prev\r\n            </button>\r\n            <span className=\"dark:text-gray-100\">\r\n              Page {page} of {pageCount}\r\n            </span>\r\n            <button\r\n              className=\"px-2 py-1 rounded border dark:border-gray-700 dark:bg-gray-950 dark:text-gray-100\"\r\n              disabled={page === pageCount}\r\n              onClick={() => setPage(page + 1)}\r\n            >\r\n              Next\r\n            </button>\r\n          </div>\r\n        )}\r\n\r\n        {/* Download Modal */}\r\n        <DownloadColumnsModal\r\n          isOpen={downloadModalOpen}\r\n          onClose={() => setDownloadModalOpen(false)}\r\n          columns={downloadColumns}\r\n          onDownload={(selectedColumns) => {\r\n            handleDownloadPDF(\r\n              pendingDownloadData,\r\n              selectedColumns,\r\n              activeSection\r\n                ? activeSection.charAt(0).toUpperCase() + activeSection.slice(1)\r\n                : 'Data'\r\n            );\r\n          }}\r\n        />\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}